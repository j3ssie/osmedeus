{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/bytedance/Desktop/external/osmedeus-dashboard/components/workflow-editor/canvas-settings.tsx"],"sourcesContent":["\"use client\";\n\nimport * as React from \"react\";\n\ntype CanvasSettings = {\n  wrapLongText: boolean;\n  showDetails: boolean;\n};\n\nconst CanvasSettingsContext = React.createContext<CanvasSettings | null>(null);\n\nexport function CanvasSettingsProvider({\n  wrapLongText,\n  showDetails,\n  children,\n}: {\n  wrapLongText: boolean;\n  showDetails: boolean;\n  children: React.ReactNode;\n}) {\n  return (\n    <CanvasSettingsContext.Provider value={{ wrapLongText, showDetails }}>\n      {children}\n    </CanvasSettingsContext.Provider>\n  );\n}\n\nexport function useCanvasSettings(): CanvasSettings {\n  return React.useContext(CanvasSettingsContext) ?? { wrapLongText: false, showDetails: true };\n}\n"],"names":[],"mappings":";;;;;;;AAEA;;;AAFA;;AASA,MAAM,sCAAwB,8KAAmB,CAAwB;AAElE,SAAS,uBAAuB,EACrC,YAAY,EACZ,WAAW,EACX,QAAQ,EAKT;IACC,qBACE,6LAAC,sBAAsB,QAAQ;QAAC,OAAO;YAAE;YAAc;QAAY;kBAChE;;;;;;AAGP;KAdgB;AAgBT,SAAS;;IACd,OAAO,2KAAgB,CAAC,0BAA0B;QAAE,cAAc;QAAO,aAAa;IAAK;AAC7F;GAFgB"}},
    {"offset": {"line": 48, "column": 0}, "map": {"version":3,"sources":["file:///Users/bytedance/Desktop/external/osmedeus-dashboard/components/workflow-editor/nodes/base-node.tsx"],"sourcesContent":["\"use client\";\n\nimport * as React from \"react\";\nimport { Handle, Position } from \"@xyflow/react\";\nimport { cn } from \"@/lib/utils\";\nimport type { WorkflowNodeData } from \"@/lib/types/workflow\";\nimport { useCanvasSettings } from \"../canvas-settings\";\n\nfunction truncateText(input: string, maxLen: number): string {\n  const text = input.trim();\n  if (text.length <= maxLen) return text;\n  return `${text.slice(0, Math.max(0, maxLen - 1)).trimEnd()}â€¦`;\n}\n\nfunction normalizeInlineText(input: string): string {\n  return input.replace(/\\s+/g, \" \").trim();\n}\n\nfunction isSensitiveKey(key: string): boolean {\n  const k = key.toLowerCase();\n  return (\n    k.includes(\"password\") ||\n    k.includes(\"passwd\") ||\n    k.includes(\"secret\") ||\n    k.includes(\"token\") ||\n    k.includes(\"apikey\") ||\n    k.includes(\"api_key\") ||\n    k.includes(\"authorization\")\n  );\n}\n\nfunction stringifyInlineValue(value: unknown): string {\n  if (value == null) return \"null\";\n  if (typeof value === \"string\") return normalizeInlineText(value);\n  if (typeof value === \"number\" || typeof value === \"boolean\" || typeof value === \"bigint\") {\n    return String(value);\n  }\n  try {\n    return normalizeInlineText(JSON.stringify(value));\n  } catch {\n    return \"\";\n  }\n}\n\nfunction extractMessageContentText(content: unknown): string {\n  if (typeof content === \"string\") return content;\n  if (Array.isArray(content)) {\n    const parts: string[] = [];\n    for (const item of content) {\n      if (typeof item === \"string\") {\n        parts.push(item);\n        continue;\n      }\n      if (!item || typeof item !== \"object\") continue;\n      const anyItem = item as Record<string, unknown>;\n      if (anyItem.type === \"text\" && typeof anyItem.text === \"string\") {\n        parts.push(anyItem.text);\n        continue;\n      }\n      if (typeof anyItem.content === \"string\") {\n        parts.push(anyItem.content);\n        continue;\n      }\n      if (typeof anyItem.input === \"string\") {\n        parts.push(anyItem.input);\n        continue;\n      }\n    }\n\n    if (parts.length > 0) return parts.join(\" \");\n    try {\n      return JSON.stringify(content);\n    } catch {\n      return \"\";\n    }\n  }\n\n  if (content && typeof content === \"object\") {\n    const anyObj = content as Record<string, unknown>;\n    if (typeof anyObj.text === \"string\") return anyObj.text;\n    if (typeof anyObj.content === \"string\") return anyObj.content;\n    try {\n      return JSON.stringify(content);\n    } catch {\n      return \"\";\n    }\n  }\n\n  return content == null ? \"\" : String(content);\n}\n\nfunction buildLlmMessagesSummary(step: WorkflowNodeData[\"step\"]): string[] {\n  if (!step) return [];\n\n  if (step.is_embedding) {\n    const input = Array.isArray(step.embedding_input) ? step.embedding_input : [];\n    if (input.length === 0) return [];\n    const first = normalizeInlineText(String(input[0] ?? \"\"));\n    const suffix = input.length > 1 ? ` (+${input.length - 1})` : \"\";\n    return [truncateText(`input: ${first}${suffix}`, 140)];\n  }\n\n  const messages = Array.isArray(step.messages) ? step.messages : [];\n  if (messages.length === 0) return [];\n\n  const maxLines = 3;\n  const lines: string[] = [];\n\n  for (const msg of messages.slice(0, maxLines)) {\n    if (!msg || typeof msg !== \"object\") continue;\n    const anyMsg = msg as Record<string, unknown>;\n    const role = typeof anyMsg.role === \"string\" ? anyMsg.role : \"message\";\n    const name = typeof anyMsg.name === \"string\" ? anyMsg.name : \"\";\n    const content = normalizeInlineText(extractMessageContentText(anyMsg.content));\n    const roleLabel = name ? `${role}[${name}]` : role;\n    const value = content ? truncateText(content, 140) : \"\";\n    lines.push(value ? `${roleLabel}: ${value}` : `${roleLabel}`);\n  }\n\n  const remaining = messages.length - maxLines;\n  if (remaining > 0) lines.push(`+${remaining} more`);\n  return lines;\n}\n\nfunction buildFunctionMessagesSummary(step: WorkflowNodeData[\"step\"]): string[] {\n  if (!step) return [];\n  if (step.type !== \"function\") return [];\n\n  const items: string[] = [];\n\n  if (typeof step.function === \"string\" && step.function.trim()) {\n    items.push(`fn: ${normalizeInlineText(step.function)}`);\n  }\n\n  const functions = Array.isArray(step.functions) ? step.functions : [];\n  for (const fn of functions) {\n    if (typeof fn !== \"string\") continue;\n    const text = fn.trim();\n    if (!text) continue;\n    items.push(`fn: ${normalizeInlineText(text)}`);\n  }\n\n  const parallelFunctions = Array.isArray(step.parallel_functions)\n    ? step.parallel_functions\n    : [];\n  for (const fn of parallelFunctions) {\n    if (typeof fn !== \"string\") continue;\n    const text = fn.trim();\n    if (!text) continue;\n    items.push(`pfn: ${normalizeInlineText(text)}`);\n  }\n\n  if (items.length === 0) return [];\n\n  const maxLines = 3;\n  const lines = items.slice(0, maxLines).map((v) => truncateText(v, 140));\n  const remaining = items.length - maxLines;\n  if (remaining > 0) lines.push(`+${remaining} more`);\n  return lines;\n}\n\nfunction buildHttpSummary(step: WorkflowNodeData[\"step\"]): string[] {\n  if (!step) return [];\n  if (step.type !== \"http\") return [];\n\n  const lines: string[] = [];\n\n  const url = typeof step.url === \"string\" ? step.url.trim() : \"\";\n  const method = typeof step.method === \"string\" ? step.method.trim() : \"\";\n  if (url) {\n    const methodLabel = method ? method.toUpperCase() : \"HTTP\";\n    lines.push(truncateText(`${methodLabel} ${normalizeInlineText(url)}`, 140));\n  }\n\n  if (step.headers && typeof step.headers === \"object\" && !Array.isArray(step.headers)) {\n    const keys = Object.keys(step.headers as Record<string, string>).filter(Boolean);\n    if (keys.length > 0) {\n      const shown = keys.slice(0, 3).join(\", \");\n      const suffix = keys.length > 3 ? ` (+${keys.length - 3})` : \"\";\n      lines.push(truncateText(`headers: ${shown}${suffix}`, 140));\n    }\n  }\n\n  const body = typeof step.request_body === \"string\" ? step.request_body.trim() : \"\";\n  if (body) {\n    lines.push(truncateText(`body: ${normalizeInlineText(body)}`, 140));\n  }\n\n  return lines.slice(0, 3);\n}\n\nfunction buildModuleSummary(module: WorkflowNodeData[\"module\"]): string[] {\n  if (!module) return [];\n  const lines: string[] = [];\n\n  const path = typeof module.path === \"string\" ? module.path.trim() : \"\";\n  if (path) lines.push(truncateText(`path: ${normalizeInlineText(path)}`, 140));\n\n  const dependsOn = Array.isArray(module.depends_on) ? module.depends_on : [];\n  if (dependsOn.length > 0) {\n    const shown = dependsOn.slice(0, 3).join(\", \");\n    const suffix = dependsOn.length > 3 ? ` (+${dependsOn.length - 3})` : \"\";\n    lines.push(truncateText(`depends: ${normalizeInlineText(shown)}${suffix}`, 140));\n  }\n\n  const params = module.params && typeof module.params === \"object\" && !Array.isArray(module.params)\n    ? (module.params as Record<string, unknown>)\n    : null;\n  if (params) {\n    const entries = Object.entries(params).filter(([k]) => Boolean(k));\n    if (entries.length > 0) {\n      const shown = entries.slice(0, 3).map(([k, v]) => {\n        if (isSensitiveKey(k)) return `${k}=***`;\n        const valueText = stringifyInlineValue(v);\n        return valueText ? `${k}=${valueText}` : k;\n      });\n      const suffix = entries.length > 3 ? ` (+${entries.length - 3})` : \"\";\n      lines.push(truncateText(`params: ${shown.join(\", \")}${suffix}`, 140));\n    }\n  }\n\n  return lines.slice(0, 3);\n}\n\nfunction buildCommandSummary(step: WorkflowNodeData[\"step\"]): string {\n  if (!step) return \"\";\n\n  const hasStructuredArgs =\n    step.speed_args !== undefined ||\n    step.config_args !== undefined ||\n    step.input_args !== undefined ||\n    step.output_args !== undefined;\n\n  if (typeof step.command === \"string\" && step.command.trim()) {\n    if (hasStructuredArgs) {\n      const parts = [\n        step.command,\n        step.speed_args,\n        step.config_args,\n        step.input_args,\n        step.output_args,\n      ]\n        .map((p) => (typeof p === \"string\" ? p.trim() : \"\"))\n        .filter(Boolean);\n      return parts.join(\" \");\n    }\n    return step.command.trim();\n  }\n\n  if (Array.isArray(step.commands) && step.commands.length > 0) {\n    const first = String(step.commands[0] || \"\").trim();\n    if (!first) return \"\";\n    if (step.commands.length === 1) return first;\n    return `${first} (+${step.commands.length - 1})`;\n  }\n\n  if (Array.isArray(step.parallel_commands) && step.parallel_commands.length > 0) {\n    const first = String(step.parallel_commands[0] || \"\").trim();\n    if (!first) return \"\";\n    if (step.parallel_commands.length === 1) return first;\n    return `${first} (+${step.parallel_commands.length - 1})`;\n  }\n\n  return \"\";\n}\n\nfunction hasStructuredArgs(step: WorkflowNodeData[\"step\"]): boolean {\n  if (!step) return false;\n  return (\n    step.speed_args !== undefined ||\n    step.config_args !== undefined ||\n    step.input_args !== undefined ||\n    step.output_args !== undefined\n  );\n}\n\ninterface BaseNodeProps {\n  data: WorkflowNodeData;\n  selected?: boolean;\n  icon: React.ReactNode;\n  color: string;\n  showHandles?: boolean;\n}\n\nexport function BaseNode({\n  data,\n  selected,\n  icon,\n  color,\n  showHandles = true,\n}: BaseNodeProps) {\n  const { wrapLongText, showDetails } = useCanvasSettings();\n  const commandSummary = React.useMemo(() => buildCommandSummary(data.step), [data.step]);\n  const structured = React.useMemo(() => hasStructuredArgs(data.step), [data.step]);\n  const functionMessageSummary = React.useMemo(\n    () => buildFunctionMessagesSummary(data.step),\n    [data.step]\n  );\n  const httpSummary = React.useMemo(() => buildHttpSummary(data.step), [data.step]);\n  const moduleSummary = React.useMemo(() => buildModuleSummary(data.module), [data.module]);\n  const llmMessageSummary = React.useMemo(() => {\n    if (data.step?.type !== \"llm\") return [] as string[];\n    return buildLlmMessagesSummary(data.step);\n  }, [data.step]);\n\n  return (\n    <>\n      {showHandles && (\n        <Handle\n          type=\"target\"\n          position={Position.Top}\n          className=\"!bg-border !border-2 !border-background !size-3\"\n        />\n      )}\n\n      <div\n        className={cn(\n          \"flex items-center gap-3 rounded-lg border bg-card px-4 py-3 shadow-sm transition-all min-w-[200px]\",\n          selected && \"ring-2 ring-ring ring-offset-2 ring-offset-background\"\n        )}\n      >\n        <div\n          className={cn(\n            \"flex size-8 items-center justify-center rounded-md\",\n            color\n          )}\n        >\n          {icon}\n        </div>\n        <div className=\"flex-1 min-w-0\">\n          <p className=\"text-sm font-medium truncate\">{data.label}</p>\n          {data.step?.type ? (\n            <div className=\"flex items-center gap-2\">\n              <p className=\"text-xs text-muted-foreground capitalize\">\n                {data.step.type}\n              </p>\n              {showDetails && structured && (\n                <span className=\"rounded border px-1.5 py-0.5 text-[10px] text-muted-foreground\">\n                  args\n                </span>\n              )}\n            </div>\n          ) : data.module ? (\n            <p className=\"text-xs text-muted-foreground\">module</p>\n          ) : null}\n          {showDetails && commandSummary && (\n            <p\n              className={cn(\n                \"mt-1 text-[11px] text-muted-foreground font-mono\",\n                wrapLongText ? \"whitespace-pre-wrap break-words\" : \"truncate\"\n              )}\n            >\n              {commandSummary}\n            </p>\n          )}\n\n          {showDetails && data.step?.type === \"function\" && functionMessageSummary.length > 0 && (\n            <div\n              className={cn(\n                \"mt-1 space-y-0.5 text-[11px] text-muted-foreground font-mono\",\n                wrapLongText ? \"whitespace-pre-wrap break-words\" : \"\"\n              )}\n            >\n              {functionMessageSummary.map((line, idx) => (\n                <div key={`${data.label}-fn-msg-${idx}`} className={wrapLongText ? \"\" : \"truncate\"}>\n                  {line}\n                </div>\n              ))}\n            </div>\n          )}\n\n          {showDetails && data.step?.type === \"http\" && httpSummary.length > 0 && (\n            <div\n              className={cn(\n                \"mt-1 space-y-0.5 text-[11px] text-muted-foreground font-mono\",\n                wrapLongText ? \"whitespace-pre-wrap break-words\" : \"\"\n              )}\n            >\n              {httpSummary.map((line, idx) => (\n                <div key={`${data.label}-http-${idx}`} className={wrapLongText ? \"\" : \"truncate\"}>\n                  {line}\n                </div>\n              ))}\n            </div>\n          )}\n\n          {showDetails && data.module && moduleSummary.length > 0 && (\n            <div\n              className={cn(\n                \"mt-1 space-y-0.5 text-[11px] text-muted-foreground font-mono\",\n                wrapLongText ? \"whitespace-pre-wrap break-words\" : \"\"\n              )}\n            >\n              {moduleSummary.map((line, idx) => (\n                <div key={`${data.label}-module-${idx}`} className={wrapLongText ? \"\" : \"truncate\"}>\n                  {line}\n                </div>\n              ))}\n            </div>\n          )}\n\n          {showDetails && data.step?.type === \"llm\" && llmMessageSummary.length > 0 && (\n            <div\n              className={cn(\n                \"mt-1 space-y-0.5 text-[11px] text-muted-foreground font-mono\",\n                wrapLongText ? \"whitespace-pre-wrap break-words\" : \"\"\n              )}\n            >\n              {llmMessageSummary.map((line, idx) => (\n                <div key={`${data.label}-llm-msg-${idx}`} className={wrapLongText ? \"\" : \"truncate\"}>\n                  {line}\n                </div>\n              ))}\n            </div>\n          )}\n        </div>\n      </div>\n\n      {showHandles && (\n        <Handle\n          type=\"source\"\n          position={Position.Bottom}\n          className=\"!bg-border !border-2 !border-background !size-3\"\n        />\n      )}\n    </>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 481, "column": 0}, "map": {"version":3,"sources":["file:///Users/bytedance/Desktop/external/osmedeus-dashboard/components/workflow-editor/nodes/index.tsx"],"sourcesContent":["\"use client\";\n\nimport * as React from \"react\";\nimport { Handle, Position } from \"@xyflow/react\";\nimport { BaseNode } from \"./base-node\";\nimport type { WorkflowNodeData } from \"@/lib/types/workflow\";\nimport {\n  TerminalIcon,\n  LayersIcon,\n  FunctionSquareIcon,\n  RepeatIcon,\n  PlayIcon,\n  FlagIcon,\n  GlobeIcon,\n  BrainIcon,\n  BoxIcon,\n} from \"lucide-react\";\n\ninterface CustomNodeProps {\n  data: WorkflowNodeData;\n  selected?: boolean;\n}\n\n// Start Node\nexport function StartNode({ selected }: CustomNodeProps) {\n  return (\n    <div className=\"flex flex-col items-center\">\n      <div\n        className={`flex size-12 items-center justify-center rounded-full bg-green-500/20 border-2 border-green-500 ${\n          selected ? \"ring-2 ring-ring ring-offset-2\" : \"\"\n        }`}\n      >\n        <PlayIcon className=\"size-5 text-green-600 dark:text-green-400\" />\n      </div>\n      <p className=\"mt-2 text-xs font-medium text-muted-foreground\">Start</p>\n      <Handle\n        type=\"source\"\n        position={Position.Bottom}\n        className=\"!bg-green-500 !border-2 !border-background !size-3\"\n      />\n    </div>\n  );\n}\n\n// End Node\nexport function EndNode({ selected }: CustomNodeProps) {\n  return (\n    <div className=\"flex flex-col items-center\">\n      <Handle\n        type=\"target\"\n        position={Position.Top}\n        className=\"!bg-red-500 !border-2 !border-background !size-3\"\n      />\n      <div\n        className={`flex size-12 items-center justify-center rounded-full bg-red-500/20 border-2 border-red-500 ${\n          selected ? \"ring-2 ring-ring ring-offset-2\" : \"\"\n        }`}\n      >\n        <FlagIcon className=\"size-5 text-red-600 dark:text-red-400\" />\n      </div>\n      <p className=\"mt-2 text-xs font-medium text-muted-foreground\">End</p>\n    </div>\n  );\n}\n\n// Bash Node\nexport function BashNode({ data, selected }: CustomNodeProps) {\n  return (\n    <BaseNode\n      data={data}\n      selected={selected}\n      icon={<TerminalIcon className=\"size-4 text-blue-600 dark:text-blue-400\" />}\n      color=\"bg-blue-500/20\"\n    />\n  );\n}\n\n// Parallel Node\nexport function ParallelNode({ data, selected }: CustomNodeProps) {\n  return (\n    <BaseNode\n      data={data}\n      selected={selected}\n      icon={<LayersIcon className=\"size-4 text-purple-600 dark:text-purple-400\" />}\n      color=\"bg-purple-500/20\"\n    />\n  );\n}\n\n// Function Node\nexport function FunctionNode({ data, selected }: CustomNodeProps) {\n  return (\n    <BaseNode\n      data={data}\n      selected={selected}\n      icon={<FunctionSquareIcon className=\"size-4 text-green-600 dark:text-green-400\" />}\n      color=\"bg-green-500/20\"\n    />\n  );\n}\n\n// Foreach Node\nexport function ForeachNode({ data, selected }: CustomNodeProps) {\n  return (\n    <BaseNode\n      data={data}\n      selected={selected}\n      icon={<RepeatIcon className=\"size-4 text-orange-600 dark:text-orange-400\" />}\n      color=\"bg-orange-500/20\"\n    />\n  );\n}\n\nexport function HttpNode({ data, selected }: CustomNodeProps) {\n  return (\n    <BaseNode\n      data={data}\n      selected={selected}\n      icon={<GlobeIcon className=\"size-4 text-cyan-600 dark:text-cyan-400\" />}\n      color=\"bg-cyan-500/20\"\n    />\n  );\n}\n\nexport function LlmNode({ data, selected }: CustomNodeProps) {\n  return (\n    <BaseNode\n      data={data}\n      selected={selected}\n      icon={<BrainIcon className=\"size-4 text-pink-600 dark:text-pink-400\" />}\n      color=\"bg-pink-500/20\"\n    />\n  );\n}\n\nexport function ContainerNode({ data, selected }: CustomNodeProps) {\n  return (\n    <BaseNode\n      data={data}\n      selected={selected}\n      icon={<BoxIcon className=\"size-4 text-slate-600 dark:text-slate-400\" />}\n      color=\"bg-slate-500/20\"\n    />\n  );\n}\n\n// Export node types for React Flow\nexport const nodeTypes = {\n  start: StartNode,\n  end: EndNode,\n  bash: BashNode,\n  parallel: ParallelNode,\n  \"parallel-steps\": ParallelNode,\n  function: FunctionNode,\n  foreach: ForeachNode,\n  http: HttpNode,\n  llm: LlmNode,\n  container: ContainerNode,\n  \"remote-bash\": ContainerNode,\n  module: ContainerNode,\n};\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAGA;AAAA;AACA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AANA;;;;;AAwBO,SAAS,UAAU,EAAE,QAAQ,EAAmB;IACrD,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBACC,WAAW,CAAC,gGAAgG,EAC1G,WAAW,mCAAmC,IAC9C;0BAEF,cAAA,6LAAC,qNAAQ;oBAAC,WAAU;;;;;;;;;;;0BAEtB,6LAAC;gBAAE,WAAU;0BAAiD;;;;;;0BAC9D,6LAAC,sLAAM;gBACL,MAAK;gBACL,UAAU,yKAAQ,CAAC,MAAM;gBACzB,WAAU;;;;;;;;;;;;AAIlB;KAlBgB;AAqBT,SAAS,QAAQ,EAAE,QAAQ,EAAmB;IACnD,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC,sLAAM;gBACL,MAAK;gBACL,UAAU,yKAAQ,CAAC,GAAG;gBACtB,WAAU;;;;;;0BAEZ,6LAAC;gBACC,WAAW,CAAC,4FAA4F,EACtG,WAAW,mCAAmC,IAC9C;0BAEF,cAAA,6LAAC,qNAAQ;oBAAC,WAAU;;;;;;;;;;;0BAEtB,6LAAC;gBAAE,WAAU;0BAAiD;;;;;;;;;;;;AAGpE;MAlBgB;AAqBT,SAAS,SAAS,EAAE,IAAI,EAAE,QAAQ,EAAmB;IAC1D,qBACE,6LAAC,yKAAQ;QACP,MAAM;QACN,UAAU;QACV,oBAAM,6LAAC,iOAAY;YAAC,WAAU;;;;;;QAC9B,OAAM;;;;;;AAGZ;MATgB;AAYT,SAAS,aAAa,EAAE,IAAI,EAAE,QAAQ,EAAmB;IAC9D,qBACE,6LAAC,yKAAQ;QACP,MAAM;QACN,UAAU;QACV,oBAAM,6LAAC,2NAAU;YAAC,WAAU;;;;;;QAC5B,OAAM;;;;;;AAGZ;MATgB;AAYT,SAAS,aAAa,EAAE,IAAI,EAAE,QAAQ,EAAmB;IAC9D,qBACE,6LAAC,yKAAQ;QACP,MAAM;QACN,UAAU;QACV,oBAAM,6LAAC,uPAAkB;YAAC,WAAU;;;;;;QACpC,OAAM;;;;;;AAGZ;MATgB;AAYT,SAAS,YAAY,EAAE,IAAI,EAAE,QAAQ,EAAmB;IAC7D,qBACE,6LAAC,yKAAQ;QACP,MAAM;QACN,UAAU;QACV,oBAAM,6LAAC,2NAAU;YAAC,WAAU;;;;;;QAC5B,OAAM;;;;;;AAGZ;MATgB;AAWT,SAAS,SAAS,EAAE,IAAI,EAAE,QAAQ,EAAmB;IAC1D,qBACE,6LAAC,yKAAQ;QACP,MAAM;QACN,UAAU;QACV,oBAAM,6LAAC,wNAAS;YAAC,WAAU;;;;;;QAC3B,OAAM;;;;;;AAGZ;MATgB;AAWT,SAAS,QAAQ,EAAE,IAAI,EAAE,QAAQ,EAAmB;IACzD,qBACE,6LAAC,yKAAQ;QACP,MAAM;QACN,UAAU;QACV,oBAAM,6LAAC,wNAAS;YAAC,WAAU;;;;;;QAC3B,OAAM;;;;;;AAGZ;MATgB;AAWT,SAAS,cAAc,EAAE,IAAI,EAAE,QAAQ,EAAmB;IAC/D,qBACE,6LAAC,yKAAQ;QACP,MAAM;QACN,UAAU;QACV,oBAAM,6LAAC,kNAAO;YAAC,WAAU;;;;;;QACzB,OAAM;;;;;;AAGZ;MATgB;AAYT,MAAM,YAAY;IACvB,OAAO;IACP,KAAK;IACL,MAAM;IACN,UAAU;IACV,kBAAkB;IAClB,UAAU;IACV,SAAS;IACT,MAAM;IACN,KAAK;IACL,WAAW;IACX,eAAe;IACf,QAAQ;AACV"}},
    {"offset": {"line": 771, "column": 0}, "map": {"version":3,"sources":["file:///Users/bytedance/Desktop/external/osmedeus-dashboard/components/workflow-editor/utils/layout-engine.ts"],"sourcesContent":["import dagre from \"dagre\";\nimport type { Node, Edge } from \"@xyflow/react\";\n\nconst NODE_WIDTH = 220;\nconst NODE_HEIGHT = 80;\n\nexport function layoutWorkflow(\n  nodes: Node[],\n  edges: Edge[],\n  orientation: \"TB\" | \"LR\" = \"TB\"\n): Node[] {\n  const g = new dagre.graphlib.Graph();\n\n  const dashedEdges = edges.filter((e) => typeof (e.style as any)?.strokeDasharray === \"string\");\n  const labeledEdges = edges.filter((e) => typeof e.label === \"string\" && e.label.trim().length > 0);\n  const branchingEdges = dashedEdges.length > 0 ? dashedEdges : labeledEdges;\n\n  const decisionOutDegree = new Map<string, number>();\n  for (const e of branchingEdges) {\n    decisionOutDegree.set(e.source, (decisionOutDegree.get(e.source) ?? 0) + 1);\n  }\n  const maxDecisionOut = Math.max(0, ...Array.from(decisionOutDegree.values()));\n\n  const hasDecisions = dashedEdges.length > 0 || labeledEdges.length > 0;\n  const ranksep = hasDecisions ? 170 : 80;\n  const nodesep = hasDecisions ? 120 + Math.max(0, maxDecisionOut - 1) * 40 : 50;\n  const edgesep = hasDecisions ? 40 : 10;\n\n  g.setGraph({\n    rankdir: orientation,\n    ranksep,\n    nodesep,\n    edgesep,\n    marginx: hasDecisions ? 60 : 20,\n    marginy: hasDecisions ? 60 : 20,\n  });\n\n  g.setDefaultEdgeLabel(() => ({}));\n\n  // Add nodes to dagre\n  nodes.forEach((node) => {\n    g.setNode(node.id, {\n      width: NODE_WIDTH,\n      height: NODE_HEIGHT,\n    });\n  });\n\n  // Add edges to dagre\n  edges.forEach((edge) => {\n    g.setEdge(edge.source, edge.target);\n  });\n\n  // Run layout\n  dagre.layout(g);\n\n  // Apply positions back to nodes\n  return nodes.map((node) => {\n    const nodeWithPosition = g.node(node.id);\n    if (nodeWithPosition) {\n      return {\n        ...node,\n        position: {\n          x: nodeWithPosition.x - NODE_WIDTH / 2,\n          y: nodeWithPosition.y - NODE_HEIGHT / 2,\n        },\n      };\n    }\n    return node;\n  });\n}\n"],"names":[],"mappings":";;;;AAAA;;AAGA,MAAM,aAAa;AACnB,MAAM,cAAc;AAEb,SAAS,eACd,KAAa,EACb,KAAa,EACb,cAA2B,IAAI;IAE/B,MAAM,IAAI,IAAI,4IAAK,CAAC,QAAQ,CAAC,KAAK;IAElC,MAAM,cAAc,MAAM,MAAM,CAAC,CAAC,IAAM,OAAQ,EAAE,KAAK,EAAU,oBAAoB;IACrF,MAAM,eAAe,MAAM,MAAM,CAAC,CAAC,IAAM,OAAO,EAAE,KAAK,KAAK,YAAY,EAAE,KAAK,CAAC,IAAI,GAAG,MAAM,GAAG;IAChG,MAAM,iBAAiB,YAAY,MAAM,GAAG,IAAI,cAAc;IAE9D,MAAM,oBAAoB,IAAI;IAC9B,KAAK,MAAM,KAAK,eAAgB;QAC9B,kBAAkB,GAAG,CAAC,EAAE,MAAM,EAAE,CAAC,kBAAkB,GAAG,CAAC,EAAE,MAAM,KAAK,CAAC,IAAI;IAC3E;IACA,MAAM,iBAAiB,KAAK,GAAG,CAAC,MAAM,MAAM,IAAI,CAAC,kBAAkB,MAAM;IAEzE,MAAM,eAAe,YAAY,MAAM,GAAG,KAAK,aAAa,MAAM,GAAG;IACrE,MAAM,UAAU,eAAe,MAAM;IACrC,MAAM,UAAU,eAAe,MAAM,KAAK,GAAG,CAAC,GAAG,iBAAiB,KAAK,KAAK;IAC5E,MAAM,UAAU,eAAe,KAAK;IAEpC,EAAE,QAAQ,CAAC;QACT,SAAS;QACT;QACA;QACA;QACA,SAAS,eAAe,KAAK;QAC7B,SAAS,eAAe,KAAK;IAC/B;IAEA,EAAE,mBAAmB,CAAC,IAAM,CAAC,CAAC,CAAC;IAE/B,qBAAqB;IACrB,MAAM,OAAO,CAAC,CAAC;QACb,EAAE,OAAO,CAAC,KAAK,EAAE,EAAE;YACjB,OAAO;YACP,QAAQ;QACV;IACF;IAEA,qBAAqB;IACrB,MAAM,OAAO,CAAC,CAAC;QACb,EAAE,OAAO,CAAC,KAAK,MAAM,EAAE,KAAK,MAAM;IACpC;IAEA,aAAa;IACb,4IAAK,CAAC,MAAM,CAAC;IAEb,gCAAgC;IAChC,OAAO,MAAM,GAAG,CAAC,CAAC;QAChB,MAAM,mBAAmB,EAAE,IAAI,CAAC,KAAK,EAAE;QACvC,IAAI,kBAAkB;YACpB,OAAO;gBACL,GAAG,IAAI;gBACP,UAAU;oBACR,GAAG,iBAAiB,CAAC,GAAG,aAAa;oBACrC,GAAG,iBAAiB,CAAC,GAAG,cAAc;gBACxC;YACF;QACF;QACA,OAAO;IACT;AACF"}},
    {"offset": {"line": 837, "column": 0}, "map": {"version":3,"sources":["file:///Users/bytedance/Desktop/external/osmedeus-dashboard/components/workflow-editor/workflow-canvas.tsx"],"sourcesContent":["\"use client\";\n\nimport * as React from \"react\";\nimport {\n  ReactFlow,\n  Background,\n  Controls,\n  ControlButton,\n  MiniMap,\n  useNodesState,\n  useEdgesState,\n  type Node,\n  type Edge,\n  type OnNodesChange,\n  type OnEdgesChange,\n  BackgroundVariant,\n} from \"@xyflow/react\";\nimport \"@xyflow/react/dist/style.css\";\n\nimport { Maximize2Icon, Minimize2Icon } from \"lucide-react\";\n\nimport { nodeTypes } from \"./nodes\";\nimport { layoutWorkflow } from \"./utils/layout-engine\";\nimport type { WorkflowNodeData } from \"@/lib/types/workflow\";\nimport { CanvasSettingsProvider } from \"./canvas-settings\";\n\ninterface WorkflowCanvasProps {\n  initialNodes: Node<WorkflowNodeData>[];\n  initialEdges: Edge[];\n  onNodeSelect?: (nodeId: string | null) => void;\n  orientation?: \"TB\" | \"LR\";\n  wrapLongText?: boolean;\n  showDetails?: boolean;\n  hideMiniMap?: boolean;\n  selectedNodeId?: string | null;\n  onCanvasReady?: (api: { focusNode: (nodeId: string) => void }) => void;\n}\n\nexport function WorkflowCanvas({\n  initialNodes,\n  initialEdges,\n  onNodeSelect,\n  orientation = \"TB\",\n  wrapLongText = false,\n  showDetails = true,\n  hideMiniMap = false,\n  selectedNodeId = null,\n  onCanvasReady,\n}: WorkflowCanvasProps) {\n  const wrapperRef = React.useRef<HTMLDivElement | null>(null);\n  const [isFullscreen, setIsFullscreen] = React.useState(false);\n  const instanceRef = React.useRef<any>(null);\n\n  // Apply layout to initial nodes\n  const layoutedNodes = React.useMemo(\n    () => layoutWorkflow(initialNodes, initialEdges, orientation),\n    [initialNodes, initialEdges, orientation]\n  );\n\n  const [nodes, setNodes, onNodesChange] = useNodesState(layoutedNodes);\n  const [edges, setEdges, onEdgesChange] = useEdgesState(initialEdges);\n\n  // Update nodes when initial data changes\n  React.useEffect(() => {\n    const newLayoutedNodes = layoutWorkflow(initialNodes, initialEdges, orientation);\n    setNodes(newLayoutedNodes.map((n) => ({ ...n, selected: selectedNodeId ? n.id === selectedNodeId : false })));\n    setEdges(initialEdges);\n  }, [initialNodes, initialEdges, orientation, setNodes, setEdges, selectedNodeId]);\n\n  React.useEffect(() => {\n    if (selectedNodeId === null) {\n      setNodes((prev) => prev.map((n) => (n.selected ? { ...n, selected: false } : n)));\n      return;\n    }\n    setNodes((prev) => prev.map((n) => ({ ...n, selected: n.id === selectedNodeId })));\n  }, [selectedNodeId, setNodes]);\n\n  const focusNode = React.useCallback((nodeId: string) => {\n    const instance = instanceRef.current;\n    if (!instance) return;\n    const node = typeof instance.getNode === \"function\" ? instance.getNode(nodeId) : null;\n    if (!node) return;\n\n    const width = (node.measured?.width ?? node.width ?? 0) as number;\n    const height = (node.measured?.height ?? node.height ?? 0) as number;\n    const x = (node.positionAbsolute?.x ?? node.position?.x ?? 0) + width / 2;\n    const y = (node.positionAbsolute?.y ?? node.position?.y ?? 0) + height / 2;\n    if (typeof instance.setCenter === \"function\") {\n      const currentZoom = typeof instance.getZoom === \"function\" ? instance.getZoom() : 1;\n      const targetZoom = Math.max(currentZoom ?? 1, 1.09);\n      instance.setCenter(x, y, { zoom: targetZoom, duration: 500 });\n    }\n  }, []);\n\n  const handleNodesChange: OnNodesChange = React.useCallback(\n    (changes) => {\n      onNodesChange(changes);\n\n      // Check for selection changes\n      const selectedChange = changes.find(\n        (change) => change.type === \"select\" && change.selected\n      );\n      if (selectedChange && selectedChange.type === \"select\") {\n        onNodeSelect?.(selectedChange.id);\n        return;\n      }\n\n      // Also check if all nodes are deselected\n      const hasSelection = changes.some(\n        (change) => change.type === \"select\" && change.selected\n      );\n      if (!hasSelection && changes.some((c) => c.type === \"select\")) {\n        // Check if any node is still selected\n        const stillSelected = nodes.some(\n          (n) =>\n            n.selected &&\n            !changes.find(\n              (c) => c.type === \"select\" && c.id === n.id && !c.selected\n            )\n        );\n        if (!stillSelected) {\n          onNodeSelect?.(null);\n        }\n      }\n    },\n    [onNodesChange, onNodeSelect, nodes]\n  );\n\n  const handleEdgesChange: OnEdgesChange = React.useCallback(\n    (changes) => {\n      onEdgesChange(changes);\n    },\n    [onEdgesChange]\n  );\n\n  React.useEffect(() => {\n    const handler = () => {\n      setIsFullscreen(Boolean(document.fullscreenElement));\n    };\n    document.addEventListener(\"fullscreenchange\", handler);\n    document.addEventListener(\"webkitfullscreenchange\", handler as any);\n    handler();\n    return () => {\n      document.removeEventListener(\"fullscreenchange\", handler);\n      document.removeEventListener(\"webkitfullscreenchange\", handler as any);\n    };\n  }, []);\n\n  const toggleFullscreen = React.useCallback(async () => {\n    try {\n      if (document.fullscreenElement) {\n        await document.exitFullscreen();\n        return;\n      }\n      const el = wrapperRef.current as any;\n      if (!el) return;\n      if (typeof el.requestFullscreen === \"function\") {\n        await el.requestFullscreen();\n        return;\n      }\n      if (typeof el.webkitRequestFullscreen === \"function\") {\n        el.webkitRequestFullscreen();\n      }\n    } catch {\n    }\n  }, []);\n\n  return (\n    <div ref={wrapperRef} className=\"h-full w-full\">\n      <CanvasSettingsProvider wrapLongText={wrapLongText} showDetails={showDetails}>\n        <ReactFlow\n          nodes={nodes}\n          edges={edges}\n          onNodesChange={handleNodesChange}\n          onEdgesChange={handleEdgesChange}\n          nodeTypes={nodeTypes}\n          onInit={(instance) => {\n            instanceRef.current = instance;\n            onCanvasReady?.({ focusNode });\n          }}\n          fitView\n          fitViewOptions={{\n            padding: 0.2,\n          }}\n          minZoom={0.1}\n          maxZoom={2}\n          defaultEdgeOptions={{\n            type: \"smoothstep\",\n          }}\n          proOptions={{ hideAttribution: true }}\n        >\n          <Background\n            variant={BackgroundVariant.Dots}\n            gap={16}\n            size={1}\n            className=\"bg-muted/30\"\n          />\n          <Controls\n            className=\"rounded-lg border bg-card shadow-sm [&>button]:border-border [&>button]:bg-card [&>button:hover]:bg-muted\"\n            showInteractive={false}\n          >\n            <ControlButton onClick={toggleFullscreen} title={isFullscreen ? \"Exit fullscreen\" : \"Fullscreen\"}>\n              {isFullscreen ? <Minimize2Icon className=\"size-4\" /> : <Maximize2Icon className=\"size-4\" />}\n            </ControlButton>\n          </Controls>\n          {!hideMiniMap && (\n            <MiniMap\n              className=\"rounded-lg border bg-card shadow-sm\"\n              nodeStrokeWidth={3}\n              pannable\n              zoomable\n            />\n          )}\n        </ReactFlow>\n      </CanvasSettingsProvider>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1131, "column": 0}, "map": {"version":3,"sources":["file:///Users/bytedance/Desktop/external/osmedeus-dashboard/components/ui/scroll-area.tsx"],"sourcesContent":["\"use client\";\n\nimport * as React from \"react\";\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\";\nimport { cn } from \"@/lib/utils\";\n\nfunction ScrollArea({\n  className,\n  children,\n  ...props\n}: React.ComponentProps<typeof ScrollAreaPrimitive.Root>) {\n  return (\n    <ScrollAreaPrimitive.Root\n      data-slot=\"scroll-area\"\n      className={cn(\"relative overflow-hidden\", className)}\n      {...props}\n    >\n      <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n        {children}\n      </ScrollAreaPrimitive.Viewport>\n      <ScrollBar />\n      <ScrollAreaPrimitive.Corner />\n    </ScrollAreaPrimitive.Root>\n  );\n}\n\nfunction ScrollBar({\n  className,\n  orientation = \"vertical\",\n  ...props\n}: React.ComponentProps<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>) {\n  return (\n    <ScrollAreaPrimitive.ScrollAreaScrollbar\n      data-slot=\"scroll-bar\"\n      orientation={orientation}\n      className={cn(\n        \"flex touch-none select-none transition-colors\",\n        orientation === \"vertical\" &&\n          \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n        orientation === \"horizontal\" &&\n          \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n        className\n      )}\n      {...props}\n    >\n      <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n    </ScrollAreaPrimitive.ScrollAreaScrollbar>\n  );\n}\n\nexport { ScrollArea, ScrollBar };\n"],"names":[],"mappings":";;;;;;;AAGA;AACA;AAJA;;;;AAMA,SAAS,WAAW,EAClB,SAAS,EACT,QAAQ,EACR,GAAG,OACmD;IACtD,qBACE,6LAAC,qLAAwB;QACvB,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,4BAA4B;QACzC,GAAG,KAAK;;0BAET,6LAAC,yLAA4B;gBAAC,WAAU;0BACrC;;;;;;0BAEH,6LAAC;;;;;0BACD,6LAAC,uLAA0B;;;;;;;;;;;AAGjC;KAlBS;AAoBT,SAAS,UAAU,EACjB,SAAS,EACT,cAAc,UAAU,EACxB,GAAG,OACkE;IACrE,qBACE,6LAAC,oMAAuC;QACtC,aAAU;QACV,aAAa;QACb,WAAW,IAAA,qHAAE,EACX,iDACA,gBAAgB,cACd,sDACF,gBAAgB,gBACd,wDACF;QAED,GAAG,KAAK;kBAET,cAAA,6LAAC,gMAAmC;YAAC,WAAU;;;;;;;;;;;AAGrD;MAtBS"}},
    {"offset": {"line": 1207, "column": 0}, "map": {"version":3,"sources":["file:///Users/bytedance/Desktop/external/osmedeus-dashboard/components/ui/label.tsx"],"sourcesContent":["\"use client\";\n\nimport * as React from \"react\";\nimport * as LabelPrimitive from \"@radix-ui/react-label\";\nimport { cn } from \"@/lib/utils\";\n\nfunction Label({\n  className,\n  ...props\n}: React.ComponentProps<typeof LabelPrimitive.Root>) {\n  return (\n    <LabelPrimitive.Root\n      data-slot=\"label\"\n      className={cn(\n        \"flex items-center gap-2 text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\",\n        className\n      )}\n      {...props}\n    />\n  );\n}\n\nexport { Label };\n"],"names":[],"mappings":";;;;;AAGA;AACA;AAJA;;;;AAMA,SAAS,MAAM,EACb,SAAS,EACT,GAAG,OAC8C;IACjD,qBACE,6LAAC,4KAAmB;QAClB,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,sHACA;QAED,GAAG,KAAK;;;;;;AAGf;KAdS"}},
    {"offset": {"line": 1240, "column": 0}, "map": {"version":3,"sources":["file:///Users/bytedance/Desktop/external/osmedeus-dashboard/components/ui/tabs.tsx"],"sourcesContent":["\"use client\";\n\nimport * as React from \"react\";\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\";\nimport { cn } from \"@/lib/utils\";\n\nfunction Tabs({ className, ...props }: React.ComponentProps<typeof TabsPrimitive.Root>) {\n  return (\n    <TabsPrimitive.Root\n      data-slot=\"tabs\"\n      className={cn(\"flex flex-col gap-2\", className)}\n      {...props}\n    />\n  );\n}\n\nfunction TabsList({\n  className,\n  ...props\n}: React.ComponentProps<typeof TabsPrimitive.List>) {\n  return (\n    <TabsPrimitive.List\n      data-slot=\"tabs-list\"\n      className={cn(\n        \"inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  );\n}\n\nfunction TabsTrigger({\n  className,\n  ...props\n}: React.ComponentProps<typeof TabsPrimitive.Trigger>) {\n  return (\n    <TabsPrimitive.Trigger\n      data-slot=\"tabs-trigger\"\n      className={cn(\n        \"inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-xs\",\n        className\n      )}\n      {...props}\n    />\n  );\n}\n\nfunction TabsContent({\n  className,\n  ...props\n}: React.ComponentProps<typeof TabsPrimitive.Content>) {\n  return (\n    <TabsPrimitive.Content\n      data-slot=\"tabs-content\"\n      className={cn(\n        \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n        className\n      )}\n      {...props}\n    />\n  );\n}\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent };\n"],"names":[],"mappings":";;;;;;;;;;;AAGA;AACA;AAJA;;;;AAMA,SAAS,KAAK,EAAE,SAAS,EAAE,GAAG,OAAwD;IACpF,qBACE,6LAAC,2KAAkB;QACjB,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,uBAAuB;QACpC,GAAG,KAAK;;;;;;AAGf;KARS;AAUT,SAAS,SAAS,EAChB,SAAS,EACT,GAAG,OAC6C;IAChD,qBACE,6LAAC,2KAAkB;QACjB,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,6FACA;QAED,GAAG,KAAK;;;;;;AAGf;MAdS;AAgBT,SAAS,YAAY,EACnB,SAAS,EACT,GAAG,OACgD;IACnD,qBACE,6LAAC,8KAAqB;QACpB,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,qYACA;QAED,GAAG,KAAK;;;;;;AAGf;MAdS;AAgBT,SAAS,YAAY,EACnB,SAAS,EACT,GAAG,OACgD;IACnD,qBACE,6LAAC,8KAAqB;QACpB,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,mIACA;QAED,GAAG,KAAK;;;;;;AAGf;MAdS"}},
    {"offset": {"line": 1318, "column": 0}, "map": {"version":3,"sources":["file:///Users/bytedance/Desktop/external/osmedeus-dashboard/components/workflow-editor/workflow-sidebar.tsx"],"sourcesContent":["\"use client\";\n\nimport * as React from \"react\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Button } from \"@/components/ui/button\";\nimport type { WorkflowStep, WorkflowFlowModule } from \"@/lib/types/workflow\";\nimport {\n  TerminalIcon,\n  LayersIcon,\n  FunctionSquareIcon,\n  RepeatIcon,\n  ClockIcon,\n  ClipboardIcon,\n  GlobeIcon,\n  BrainIcon,\n  BoxIcon,\n} from \"lucide-react\";\nimport { Light as SyntaxHighlighter } from \"react-syntax-highlighter\";\nimport yamlLang from \"react-syntax-highlighter/dist/esm/languages/hljs/yaml\";\nimport bashLang from \"react-syntax-highlighter/dist/esm/languages/hljs/bash\";\nimport javascriptLang from \"react-syntax-highlighter/dist/esm/languages/hljs/javascript\";\nimport github from \"react-syntax-highlighter/dist/esm/styles/hljs/github\";\nimport atomOneDark from \"react-syntax-highlighter/dist/esm/styles/hljs/atom-one-dark\";\nimport { useTheme } from \"next-themes\";\nimport { toast } from \"sonner\";\nimport jsyaml from \"js-yaml\";\n\ninterface WorkflowSidebarProps {\n  selectedStep: WorkflowStep | null;\n  selectedModule?: WorkflowFlowModule | null;\n  yamlPreview: string;\n  wrapLongText?: boolean;\n  onStepUpdate?: (stepName: string, updates: Partial<WorkflowStep>) => void;\n  workflowKind?: \"module\" | \"flow\" | null;\n  allSteps?: WorkflowStep[];\n  allModules?: WorkflowFlowModule[];\n  onNavigateToNode?: (nodeId: string) => void;\n}\n\nexport function WorkflowSidebar({\n  selectedStep,\n  selectedModule = null,\n  yamlPreview,\n  wrapLongText = false,\n  onStepUpdate,\n  workflowKind = null,\n  allSteps = [],\n  allModules = [],\n  onNavigateToNode,\n}: WorkflowSidebarProps) {\n  SyntaxHighlighter.registerLanguage(\"yaml\", yamlLang);\n  SyntaxHighlighter.registerLanguage(\"bash\", bashLang);\n  SyntaxHighlighter.registerLanguage(\"javascript\", javascriptLang);\n  const { theme } = useTheme();\n  const stepTypeIcons: Record<string, React.ReactNode> = {\n    bash: <TerminalIcon className=\"size-4\" />,\n    parallel: <LayersIcon className=\"size-4\" />,\n    \"parallel-steps\": <LayersIcon className=\"size-4\" />,\n    function: <FunctionSquareIcon className=\"size-4\" />,\n    foreach: <RepeatIcon className=\"size-4\" />,\n    http: <GlobeIcon className=\"size-4\" />,\n    llm: <BrainIcon className=\"size-4\" />,\n    container: <BoxIcon className=\"size-4\" />,\n    \"remote-bash\": <BoxIcon className=\"size-4\" />,\n    module: <BoxIcon className=\"size-4\" />,\n  };\n  const CodeHighlighter = SyntaxHighlighter as unknown as React.ComponentType<any>;\n  const selectionType = selectedStep?.type ?? (selectedModule ? \"module\" : \"\");\n  const selectionName = selectedStep?.name ?? (selectedModule?.name ?? \"\");\n  const [activeTab, setActiveTab] = React.useState(\"properties\");\n\n  const badgeVariantForStepType = React.useCallback(\n    (\n      type: string\n    ):\n      | \"default\"\n      | \"secondary\"\n      | \"destructive\"\n      | \"outline\"\n      | \"success\"\n      | \"warning\"\n      | \"info\"\n      | \"purple\"\n      | \"pink\"\n      | \"cyan\"\n      | \"orange\" => {\n      switch (type) {\n        case \"bash\":\n          return \"info\";\n        case \"remote-bash\":\n          return \"info\";\n        case \"container\":\n          return \"warning\";\n        case \"parallel\":\n          return \"cyan\";\n        case \"parallel-steps\":\n          return \"cyan\";\n        case \"function\":\n          return \"purple\";\n        case \"foreach\":\n          return \"orange\";\n        case \"http\":\n          return \"success\";\n        case \"llm\":\n          return \"pink\";\n        default:\n          return \"secondary\";\n      }\n    },\n    []\n  );\n\n  const bashResolvedCommand = React.useMemo(() => {\n    if (!selectedStep) return \"\";\n    const hasStructuredArgs =\n      selectedStep.speed_args !== undefined ||\n      selectedStep.config_args !== undefined ||\n      selectedStep.input_args !== undefined ||\n      selectedStep.output_args !== undefined;\n    if (!hasStructuredArgs) return \"\";\n\n    const parts = [\n      selectedStep.command,\n      selectedStep.speed_args,\n      selectedStep.config_args,\n      selectedStep.input_args,\n      selectedStep.output_args,\n    ]\n      .map((p) => (typeof p === \"string\" ? p.trim() : \"\"))\n      .filter(Boolean);\n\n    return parts.join(\" \");\n  }, [selectedStep]);\n\n  const foreachStepYaml = React.useMemo(() => {\n    if (!selectedStep || selectedStep.type !== \"foreach\") return \"\";\n    if (!selectedStep.step) return \"\";\n    try {\n      return jsyaml.dump(selectedStep.step, {\n        indent: 2,\n        lineWidth: -1,\n        noRefs: true,\n        quotingType: '\"',\n      });\n    } catch {\n      return \"\";\n    }\n  }, [selectedStep]);\n\n  const renderStringList = React.useCallback(\n    (\n      label: string,\n      items: string[],\n      opts?: {\n        language?: \"bash\" | \"javascript\" | \"json\";\n        copyAllText?: string;\n      }\n    ) => {\n      const language = opts?.language;\n      const copyAllText = opts?.copyAllText;\n\n      return (\n        <div className=\"space-y-2\">\n          <div className=\"flex items-center justify-between gap-2\">\n            <Label>\n              {label} ({items.length})\n            </Label>\n            {copyAllText !== undefined && (\n              <Button\n                className=\"rounded-md\"\n                variant=\"outline\"\n                size=\"icon\"\n                onClick={async () => {\n                  try {\n                    await navigator.clipboard.writeText(copyAllText);\n                    toast.success(\"Copied to clipboard\");\n                  } catch {\n                    toast.error(\"Failed to copy\");\n                  }\n                }}\n              >\n                <ClipboardIcon className=\"size-4\" />\n                <span className=\"sr-only\">Copy all</span>\n              </Button>\n            )}\n          </div>\n\n          <div className=\"space-y-2\">\n            {items.map((item, idx) => (\n              <div key={`${idx}-${item}`} className=\"rounded-md border bg-muted/30 p-2\">\n                <div className=\"mb-2 flex items-center justify-between gap-2\">\n                  <Badge variant=\"secondary\" className=\"text-[10px]\">\n                    {idx + 1}\n                  </Badge>\n                </div>\n                {language ? (\n                  <CodeHighlighter\n                    language={language}\n                    style={theme === \"dark\" ? atomOneDark : github}\n                    customStyle={{\n                      margin: 0,\n                      background: \"transparent\",\n                      fontSize: \"0.75rem\",\n                      whiteSpace: \"pre-wrap\",\n                      wordBreak: \"break-word\",\n                    }}\n                    codeTagProps={{\n                      style: {\n                        whiteSpace: \"pre-wrap\",\n                        wordBreak: \"break-word\",\n                      },\n                    }}\n                  >\n                    {item}\n                  </CodeHighlighter>\n                ) : (\n                  <div className=\"font-mono text-xs whitespace-pre-wrap break-words\">{item}</div>\n                )}\n              </div>\n            ))}\n          </div>\n        </div>\n      );\n    },\n    [CodeHighlighter, theme]\n  );\n\n  const renderDecisionBlock = React.useCallback((decision: any) => {\n    if (!decision) return null;\n\n    if (Array.isArray(decision) && decision.length > 0) {\n      return (\n        <div className=\"space-y-2\">\n          <Label>Decision Rules</Label>\n          <div className=\"space-y-2\">\n            {decision.map((rule, i) => (\n              <div key={i} className=\"rounded-md border p-2 text-xs font-mono overflow-hidden\">\n                <div className=\"text-muted-foreground whitespace-pre-wrap break-words\">if {rule?.condition}</div>\n                <div className=\"text-primary whitespace-pre-wrap break-words\">â†’ {rule?.next}</div>\n              </div>\n            ))}\n          </div>\n        </div>\n      );\n    }\n\n    if (typeof decision === \"object\" && decision && typeof (decision as any).switch === \"string\" && (decision as any).cases && typeof (decision as any).cases === \"object\") {\n      const cases = (decision as any).cases as Record<string, any>;\n      const entries = Object.entries(cases).filter(([k]) => typeof k === \"string\" && k.trim().length > 0);\n      const hasDefault = (decision as any).default && (typeof (decision as any).default.goto === \"string\" || typeof (decision as any).default.next === \"string\");\n      const defaultGoto = typeof (decision as any).default?.goto === \"string\" ? (decision as any).default.goto : (typeof (decision as any).default?.next === \"string\" ? (decision as any).default.next : \"\");\n\n      return (\n        <div className=\"space-y-2\">\n          <Label>Decision (switch)</Label>\n          <div className=\"rounded-md border bg-muted/30 p-2 font-mono text-xs whitespace-pre-wrap break-words\">\n            switch {(decision as any).switch}\n          </div>\n          <div className=\"space-y-2\">\n            {entries.map(([key, value]) => {\n              const goto = typeof value?.goto === \"string\" ? value.goto : (typeof value?.next === \"string\" ? value.next : \"\");\n              return (\n                <div key={key} className=\"rounded-md border p-2 text-xs font-mono overflow-hidden\">\n                  <div className=\"text-muted-foreground whitespace-pre-wrap break-words\">case {key}</div>\n                  <div className=\"text-primary whitespace-pre-wrap break-words\">â†’ {goto}</div>\n                </div>\n              );\n            })}\n            {hasDefault && (\n              <div className=\"rounded-md border p-2 text-xs font-mono overflow-hidden\">\n                <div className=\"text-muted-foreground whitespace-pre-wrap break-words\">default</div>\n                <div className=\"text-primary whitespace-pre-wrap break-words\">â†’ {defaultGoto}</div>\n              </div>\n            )}\n          </div>\n        </div>\n      );\n    }\n\n    return null;\n  }, []);\n\n  return (\n    <div className=\"flex h-full flex-col border-l bg-card\">\n      <Tabs value={activeTab} onValueChange={setActiveTab} className=\"flex h-full flex-col\">\n        <div className=\"border-b px-4 py-2\">\n          <TabsList className=\"w-full\">\n            <TabsTrigger value=\"properties\" className=\"flex-1\">\n              Properties\n            </TabsTrigger>\n            <TabsTrigger value=\"items\" className=\"flex-1\">\n              {workflowKind === \"flow\" ? \"Modules\" : \"Steps\"}\n            </TabsTrigger>\n            <TabsTrigger value=\"yaml\" className=\"flex-1\">\n              YAML\n            </TabsTrigger>\n          </TabsList>\n        </div>\n\n        <TabsContent value=\"properties\" className=\"flex-1 m-0 min-h-0\">\n          <ScrollArea className=\"h-full\">\n            {selectedStep || selectedModule ? (\n              <div className=\"p-4 space-y-6\">\n                {/* Step Header */}\n                <div className=\"space-y-2\">\n                  <div className=\"flex items-center gap-2\">\n                    {stepTypeIcons[selectionType]}\n                    <Badge variant=\"secondary\" className=\"capitalize\">\n                      {selectionType}\n                    </Badge>\n                  </div>\n                  <h3 className=\"text-lg font-semibold\">{selectionName}</h3>\n                </div>\n\n                <Separator />\n\n                {/* Basic Properties */}\n                <div className=\"space-y-4\">\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"stepName\">Name</Label>\n                    <Input\n                      id=\"stepName\"\n                      value={selectionName}\n                      onChange={(e) =>\n                        selectedStep ? onStepUpdate?.(selectedStep.name, { name: e.target.value }) : undefined\n                      }\n                      disabled={!selectedStep}\n                    />\n                  </div>\n\n                  {selectedModule && (\n                    <div className=\"space-y-4\">\n                      {selectedModule.path && (\n                        <div className=\"space-y-2\">\n                          <Label>Path</Label>\n                          <div className=\"rounded-md border bg-muted/30 p-2 font-mono text-xs whitespace-pre-wrap break-words\">\n                            {selectedModule.path}\n                          </div>\n                        </div>\n                      )}\n\n                      {Array.isArray(selectedModule.depends_on) && selectedModule.depends_on.length > 0 &&\n                        renderStringList(\n                          \"Depends On\",\n                          selectedModule.depends_on.map((d) => String(d)),\n                          { copyAllText: selectedModule.depends_on.join(\"\\n\") }\n                        )}\n\n                      {selectedModule.condition && (\n                        <div className=\"space-y-2\">\n                          <Label>Condition</Label>\n                          <div className=\"rounded-md border bg-muted/30 p-2 font-mono text-xs whitespace-pre-wrap break-words\">\n                            {selectedModule.condition}\n                          </div>\n                        </div>\n                      )}\n\n                      {selectedModule.params && Object.keys(selectedModule.params).length > 0 && (\n                        <div className=\"space-y-2\">\n                          <Label>Params</Label>\n                          <div className=\"rounded-md border bg-muted/30 p-2\">\n                            <CodeHighlighter\n                              language=\"json\"\n                              style={theme === \"dark\" ? atomOneDark : github}\n                              customStyle={{\n                                margin: 0,\n                                background: \"transparent\",\n                                fontSize: \"0.75rem\",\n                                whiteSpace: \"pre-wrap\",\n                                wordBreak: \"break-word\",\n                              }}\n                              codeTagProps={{\n                                style: {\n                                  whiteSpace: \"pre-wrap\",\n                                  wordBreak: \"break-word\",\n                                },\n                              }}\n                            >\n                              {JSON.stringify(selectedModule.params, null, 2)}\n                            </CodeHighlighter>\n                          </div>\n                        </div>\n                      )}\n\n                      {selectedModule?.decision && renderDecisionBlock(selectedModule.decision)}\n\n                      {Array.isArray(selectedModule.on_success) && selectedModule.on_success.length > 0 && (\n                        <div className=\"space-y-2\">\n                          <Label>On Success</Label>\n                          <div className=\"rounded-md border bg-muted/30 p-2\">\n                            <CodeHighlighter\n                              language=\"json\"\n                              style={theme === \"dark\" ? atomOneDark : github}\n                              customStyle={{\n                                margin: 0,\n                                background: \"transparent\",\n                                fontSize: \"0.75rem\",\n                                whiteSpace: \"pre-wrap\",\n                                wordBreak: \"break-word\",\n                              }}\n                              codeTagProps={{\n                                style: {\n                                  whiteSpace: \"pre-wrap\",\n                                  wordBreak: \"break-word\",\n                                },\n                              }}\n                            >\n                              {JSON.stringify(selectedModule.on_success, null, 2)}\n                            </CodeHighlighter>\n                          </div>\n                        </div>\n                      )}\n\n                      {Array.isArray(selectedModule.on_error) && selectedModule.on_error.length > 0 && (\n                        <div className=\"space-y-2\">\n                          <Label>On Error</Label>\n                          <div className=\"rounded-md border bg-muted/30 p-2\">\n                            <CodeHighlighter\n                              language=\"json\"\n                              style={theme === \"dark\" ? atomOneDark : github}\n                              customStyle={{\n                                margin: 0,\n                                background: \"transparent\",\n                                fontSize: \"0.75rem\",\n                                whiteSpace: \"pre-wrap\",\n                                wordBreak: \"break-word\",\n                              }}\n                              codeTagProps={{\n                                style: {\n                                  whiteSpace: \"pre-wrap\",\n                                  wordBreak: \"break-word\",\n                                },\n                              }}\n                            >\n                              {JSON.stringify(selectedModule.on_error, null, 2)}\n                            </CodeHighlighter>\n                          </div>\n                        </div>\n                      )}\n                    </div>\n                  )}\n\n                  {selectedStep && (selectedStep.type === \"bash\" || selectedStep.type === \"remote-bash\" || selectedStep.type === \"container\") && selectedStep.command && (\n                    <div className=\"space-y-2\">\n                      <div className=\"flex items-center justify-between gap-2\">\n                        <Label htmlFor=\"command\">Command</Label>\n                        <Button\n                          className=\"rounded-md\"\n                          variant=\"outline\"\n                          size=\"icon\"\n                          onClick={async () => {\n                            try {\n                              await navigator.clipboard.writeText(selectedStep.command || \"\");\n                              toast.success(\"Copied to clipboard\");\n                            } catch {\n                              toast.error(\"Failed to copy\");\n                            }\n                          }}\n                        >\n                          <ClipboardIcon className=\"size-4\" />\n                          <span className=\"sr-only\">Copy command</span>\n                        </Button>\n                      </div>\n                      <div className=\"rounded-md border bg-muted/30 p-2\">\n                        <CodeHighlighter\n                          language=\"bash\"\n                          style={theme === \"dark\" ? atomOneDark : github}\n                          customStyle={{\n                            margin: 0,\n                            background: \"transparent\",\n                            fontSize: \"0.75rem\",\n                            whiteSpace: \"pre-wrap\",\n                            wordBreak: \"break-word\",\n                          }}\n                          codeTagProps={{\n                            style: {\n                              whiteSpace: \"pre-wrap\",\n                              wordBreak: \"break-word\",\n                            },\n                          }}\n                        >\n                          {selectedStep.command}\n                        </CodeHighlighter>\n                      </div>\n                    </div>\n                  )}\n\n                  {selectedStep && (selectedStep.type === \"bash\" || selectedStep.type === \"remote-bash\" || selectedStep.type === \"container\") && (\n                    selectedStep.speed_args !== undefined ||\n                    selectedStep.config_args !== undefined ||\n                    selectedStep.input_args !== undefined ||\n                    selectedStep.output_args !== undefined\n                  ) && (\n                    <div className=\"space-y-2\">\n                      <Label>Structured Args</Label>\n                      <div className=\"space-y-2\">\n                        <div className=\"rounded-md border p-2 text-xs font-mono overflow-hidden\">\n                          <div className=\"text-muted-foreground whitespace-pre-wrap break-words\">speed_args</div>\n                          <div className=\"whitespace-pre-wrap break-words\">{selectedStep.speed_args ?? \"\"}</div>\n                        </div>\n                        <div className=\"rounded-md border p-2 text-xs font-mono overflow-hidden\">\n                          <div className=\"text-muted-foreground whitespace-pre-wrap break-words\">config_args</div>\n                          <div className=\"whitespace-pre-wrap break-words\">{selectedStep.config_args ?? \"\"}</div>\n                        </div>\n                        <div className=\"rounded-md border p-2 text-xs font-mono overflow-hidden\">\n                          <div className=\"text-muted-foreground whitespace-pre-wrap break-words\">input_args</div>\n                          <div className=\"whitespace-pre-wrap break-words\">{selectedStep.input_args ?? \"\"}</div>\n                        </div>\n                        <div className=\"rounded-md border p-2 text-xs font-mono overflow-hidden\">\n                          <div className=\"text-muted-foreground whitespace-pre-wrap break-words\">output_args</div>\n                          <div className=\"whitespace-pre-wrap break-words\">{selectedStep.output_args ?? \"\"}</div>\n                        </div>\n                      </div>\n\n                      {bashResolvedCommand && (\n                        <div className=\"space-y-2\">\n                          <Label>Resolved Command</Label>\n                          <div className=\"rounded-md border bg-muted/30 p-2\">\n                            <CodeHighlighter\n                              language=\"bash\"\n                              style={theme === \"dark\" ? atomOneDark : github}\n                              customStyle={{\n                                margin: 0,\n                                background: \"transparent\",\n                                fontSize: \"0.75rem\",\n                                whiteSpace: \"pre-wrap\",\n                                wordBreak: \"break-word\",\n                              }}\n                              codeTagProps={{\n                                style: {\n                                  whiteSpace: \"pre-wrap\",\n                                  wordBreak: \"break-word\",\n                                },\n                              }}\n                            >\n                              {bashResolvedCommand}\n                            </CodeHighlighter>\n                          </div>\n                        </div>\n                      )}\n                    </div>\n                  )}\n\n                  {selectedStep && (selectedStep.type === \"bash\" || selectedStep.type === \"remote-bash\" || selectedStep.type === \"container\") &&\n                    Array.isArray(selectedStep.commands) && selectedStep.commands.length > 0 &&\n                    renderStringList(\"Commands\", selectedStep.commands, {\n                      language: \"bash\",\n                      copyAllText: selectedStep.commands.join(\"\\n\"),\n                    })}\n\n                  {selectedStep && (selectedStep.type === \"bash\" || selectedStep.type === \"remote-bash\" || selectedStep.type === \"container\") &&\n                    Array.isArray(selectedStep.parallel_commands) && selectedStep.parallel_commands.length > 0 &&\n                    renderStringList(\"Parallel Commands\", selectedStep.parallel_commands, {\n                      language: \"bash\",\n                      copyAllText: selectedStep.parallel_commands.join(\"\\n\"),\n                    })}\n\n                  {selectedStep && selectedStep.type === \"function\" && selectedStep.function && (\n                    <div className=\"space-y-2\">\n                      <Label>Function</Label>\n                      <div className=\"rounded-md border bg-muted/30 p-2\">\n                        <CodeHighlighter\n                          language=\"javascript\"\n                          style={theme === \"dark\" ? atomOneDark : github}\n                          customStyle={{\n                            margin: 0,\n                            background: \"transparent\",\n                            fontSize: \"0.75rem\",\n                            whiteSpace: \"pre-wrap\",\n                            wordBreak: \"break-word\",\n                          }}\n                          wrapLongLines\n                          codeTagProps={{\n                            style: {\n                              whiteSpace: \"pre-wrap\",\n                              wordBreak: \"break-word\",\n                            },\n                          }}\n                        >\n                          {selectedStep.function}\n                        </CodeHighlighter>\n                      </div>\n                    </div>\n                  )}\n\n                  {selectedStep && selectedStep.type === \"function\" &&\n                    Array.isArray(selectedStep.functions) && selectedStep.functions.length > 0 &&\n                    renderStringList(\"Functions\", selectedStep.functions, {\n                      language: \"javascript\",\n                      copyAllText: selectedStep.functions.join(\"\\n\"),\n                    })}\n\n                  {selectedStep && selectedStep.type === \"function\" &&\n                    Array.isArray(selectedStep.parallel_functions) && selectedStep.parallel_functions.length > 0 &&\n                    renderStringList(\"Parallel Functions\", selectedStep.parallel_functions, {\n                      language: \"javascript\",\n                      copyAllText: selectedStep.parallel_functions.join(\"\\n\"),\n                    })}\n\n                  {selectedStep && selectedStep.type === \"http\" && (\n                    <div className=\"space-y-4\">\n                      {selectedStep.url && (\n                        <div className=\"space-y-2\">\n                          <Label>URL</Label>\n                          <div className=\"rounded-md border bg-muted/30 p-2 font-mono text-xs whitespace-pre-wrap break-words\">\n                            {selectedStep.url}\n                          </div>\n                        </div>\n                      )}\n\n                      {selectedStep.method && (\n                        <div className=\"space-y-2\">\n                          <Label>Method</Label>\n                          <div className=\"rounded-md border bg-muted/30 p-2 font-mono text-xs whitespace-pre-wrap break-words\">\n                            {selectedStep.method}\n                          </div>\n                        </div>\n                      )}\n\n                      {selectedStep.headers && Object.keys(selectedStep.headers).length > 0 && (\n                        <div className=\"space-y-2\">\n                          <Label>Headers</Label>\n                          <div className=\"rounded-md border bg-muted/30 p-2\">\n                            <CodeHighlighter\n                              language=\"json\"\n                              style={theme === \"dark\" ? atomOneDark : github}\n                              customStyle={{\n                                margin: 0,\n                                background: \"transparent\",\n                                fontSize: \"0.75rem\",\n                                whiteSpace: \"pre-wrap\",\n                                wordBreak: \"break-word\",\n                              }}\n                              codeTagProps={{\n                                style: {\n                                  whiteSpace: \"pre-wrap\",\n                                  wordBreak: \"break-word\",\n                                },\n                              }}\n                            >\n                              {JSON.stringify(selectedStep.headers, null, 2)}\n                            </CodeHighlighter>\n                          </div>\n                        </div>\n                      )}\n\n                      {selectedStep.request_body && (\n                        <div className=\"space-y-2\">\n                          <Label>Request Body</Label>\n                          <div className=\"rounded-md border bg-muted/30 p-2\">\n                            <CodeHighlighter\n                              language=\"json\"\n                              style={theme === \"dark\" ? atomOneDark : github}\n                              customStyle={{\n                                margin: 0,\n                                background: \"transparent\",\n                                fontSize: \"0.75rem\",\n                                whiteSpace: \"pre-wrap\",\n                                wordBreak: \"break-word\",\n                              }}\n                              codeTagProps={{\n                                style: {\n                                  whiteSpace: \"pre-wrap\",\n                                  wordBreak: \"break-word\",\n                                },\n                              }}\n                            >\n                              {String(selectedStep.request_body)}\n                            </CodeHighlighter>\n                          </div>\n                        </div>\n                      )}\n                    </div>\n                  )}\n\n                  {selectedStep && selectedStep.type === \"llm\" && (\n                    <div className=\"space-y-4\">\n                      {typeof selectedStep.is_embedding === \"boolean\" && (\n                        <div className=\"space-y-2\">\n                          <Label>Embedding</Label>\n                          <div className=\"rounded-md border bg-muted/30 p-2 font-mono text-xs\">\n                            {String(selectedStep.is_embedding)}\n                          </div>\n                        </div>\n                      )}\n\n                      {Array.isArray(selectedStep.embedding_input) && selectedStep.embedding_input.length > 0 &&\n                        renderStringList(\n                          \"Embedding Input\",\n                          selectedStep.embedding_input.map((v) => String(v)),\n                          { copyAllText: selectedStep.embedding_input.join(\"\\n\") }\n                        )}\n\n                      {Array.isArray(selectedStep.messages) && selectedStep.messages.length > 0 &&\n                        renderStringList(\n                          \"Messages\",\n                          selectedStep.messages.map((m) => JSON.stringify(m, null, 2)),\n                          { language: \"json\", copyAllText: JSON.stringify(selectedStep.messages, null, 2) }\n                        )}\n\n                      {Array.isArray(selectedStep.tools) && selectedStep.tools.length > 0 &&\n                        renderStringList(\n                          \"Tools\",\n                          selectedStep.tools.map((t) => JSON.stringify(t, null, 2)),\n                          { language: \"json\", copyAllText: JSON.stringify(selectedStep.tools, null, 2) }\n                        )}\n\n                      {selectedStep.tool_choice !== undefined && (\n                        <div className=\"space-y-2\">\n                          <Label>Tool Choice</Label>\n                          <div className=\"rounded-md border bg-muted/30 p-2\">\n                            <CodeHighlighter\n                              language=\"json\"\n                              style={theme === \"dark\" ? atomOneDark : github}\n                              customStyle={{\n                                margin: 0,\n                                background: \"transparent\",\n                                fontSize: \"0.75rem\",\n                                whiteSpace: \"pre-wrap\",\n                                wordBreak: \"break-word\",\n                              }}\n                              codeTagProps={{\n                                style: {\n                                  whiteSpace: \"pre-wrap\",\n                                  wordBreak: \"break-word\",\n                                },\n                              }}\n                            >\n                              {JSON.stringify(selectedStep.tool_choice, null, 2)}\n                            </CodeHighlighter>\n                          </div>\n                        </div>\n                      )}\n\n                      {selectedStep.llm_config && Object.keys(selectedStep.llm_config).length > 0 && (\n                        <div className=\"space-y-2\">\n                          <Label>LLM Config</Label>\n                          <div className=\"rounded-md border bg-muted/30 p-2\">\n                            <CodeHighlighter\n                              language=\"json\"\n                              style={theme === \"dark\" ? atomOneDark : github}\n                              customStyle={{\n                                margin: 0,\n                                background: \"transparent\",\n                                fontSize: \"0.75rem\",\n                                whiteSpace: \"pre-wrap\",\n                                wordBreak: \"break-word\",\n                              }}\n                              codeTagProps={{\n                                style: {\n                                  whiteSpace: \"pre-wrap\",\n                                  wordBreak: \"break-word\",\n                                },\n                              }}\n                            >\n                              {JSON.stringify(selectedStep.llm_config, null, 2)}\n                            </CodeHighlighter>\n                          </div>\n                        </div>\n                      )}\n\n                      {selectedStep.extra_llm_parameters && Object.keys(selectedStep.extra_llm_parameters).length > 0 && (\n                        <div className=\"space-y-2\">\n                          <Label>Extra LLM Parameters</Label>\n                          <div className=\"rounded-md border bg-muted/30 p-2\">\n                            <CodeHighlighter\n                              language=\"json\"\n                              style={theme === \"dark\" ? atomOneDark : github}\n                              customStyle={{\n                                margin: 0,\n                                background: \"transparent\",\n                                fontSize: \"0.75rem\",\n                                whiteSpace: \"pre-wrap\",\n                                wordBreak: \"break-word\",\n                              }}\n                              codeTagProps={{\n                                style: {\n                                  whiteSpace: \"pre-wrap\",\n                                  wordBreak: \"break-word\",\n                                },\n                              }}\n                            >\n                              {JSON.stringify(selectedStep.extra_llm_parameters, null, 2)}\n                            </CodeHighlighter>\n                          </div>\n                        </div>\n                      )}\n                    </div>\n                  )}\n\n                  {selectedStep && (selectedStep.step_runner || selectedStep.step_runner_config) && (\n                    <div className=\"space-y-4\">\n                      {selectedStep.step_runner && (\n                        <div className=\"space-y-2\">\n                          <Label>Runner</Label>\n                          <div className=\"rounded-md border bg-muted/30 p-2 font-mono text-xs whitespace-pre-wrap break-words\">\n                            {selectedStep.step_runner}\n                          </div>\n                        </div>\n                      )}\n                      {selectedStep.step_runner_config && (\n                        <div className=\"space-y-2\">\n                          <Label>Runner Config</Label>\n                          <div className=\"rounded-md border bg-muted/30 p-2\">\n                            <CodeHighlighter\n                              language=\"json\"\n                              style={theme === \"dark\" ? atomOneDark : github}\n                              customStyle={{\n                                margin: 0,\n                                background: \"transparent\",\n                                fontSize: \"0.75rem\",\n                                whiteSpace: \"pre-wrap\",\n                                wordBreak: \"break-word\",\n                              }}\n                              codeTagProps={{\n                                style: {\n                                  whiteSpace: \"pre-wrap\",\n                                  wordBreak: \"break-word\",\n                                },\n                              }}\n                            >\n                              {JSON.stringify(selectedStep.step_runner_config, null, 2)}\n                            </CodeHighlighter>\n                          </div>\n                        </div>\n                      )}\n                    </div>\n                  )}\n\n                  {selectedStep && (selectedStep.type === \"parallel\" || selectedStep.type === \"parallel-steps\") && Array.isArray(selectedStep.parallel_steps) && (\n                    <div className=\"space-y-2\">\n                      <Label>Parallel Steps ({selectedStep.parallel_steps.length})</Label>\n                      <div className=\"space-y-2\">\n                        {selectedStep.parallel_steps.map((ps) => {\n                          let psYaml = \"\";\n                          try {\n                            psYaml = jsyaml.dump(ps, {\n                              indent: 2,\n                              lineWidth: -1,\n                              noRefs: true,\n                              quotingType: '\"',\n                            });\n                          } catch {\n                            psYaml = \"\";\n                          }\n\n                          return (\n                            <div key={ps.name} className=\"rounded-md border p-3 space-y-2\">\n                              <div className=\"flex items-center gap-2\">\n                                {stepTypeIcons[ps.type]}\n                                <span className=\"font-medium text-sm\">{ps.name}</span>\n                                <Badge variant=\"secondary\" className=\"capitalize\">\n                                  {ps.type}\n                                </Badge>\n                              </div>\n\n                              {psYaml && (\n                                <div className=\"rounded-md border bg-muted/30 p-2\">\n                                  <CodeHighlighter\n                                    language=\"yaml\"\n                                    style={theme === \"dark\" ? atomOneDark : github}\n                                    customStyle={{\n                                      margin: 0,\n                                      background: \"transparent\",\n                                      fontSize: \"0.75rem\",\n                                      whiteSpace: \"pre-wrap\",\n                                      wordBreak: \"break-word\",\n                                    }}\n                                    codeTagProps={{\n                                      style: {\n                                        whiteSpace: \"pre-wrap\",\n                                        wordBreak: \"break-word\",\n                                      },\n                                    }}\n                                    showLineNumbers\n                                  >\n                                    {psYaml.trim()}\n                                  </CodeHighlighter>\n                                </div>\n                              )}\n                            </div>\n                          );\n                        })}\n                      </div>\n                    </div>\n                  )}\n\n                  {selectedStep && selectedStep.type === \"foreach\" && (\n                    <>\n                      <div className=\"space-y-2\">\n                        <Label>Input File</Label>\n                        <div className=\"rounded-md bg-muted p-3 font-mono text-xs\">\n                          {selectedStep.input}\n                        </div>\n                      </div>\n                      <div className=\"space-y-2\">\n                        <Label>Variable Name</Label>\n                        <div className=\"rounded-md bg-muted p-3 font-mono text-xs\">\n                          {selectedStep.variable}\n                        </div>\n                      </div>\n                      {typeof selectedStep.threads === \"number\" && (\n                        <div className=\"space-y-2\">\n                          <Label>Threads</Label>\n                          <div className=\"rounded-md bg-muted p-3 font-mono text-xs\">\n                            {selectedStep.threads}\n                          </div>\n                        </div>\n                      )}\n\n                      {selectedStep.step && (\n                        <div className=\"space-y-2\">\n                          <div className=\"flex items-center justify-between gap-2\">\n                            <Label>Foreach Step</Label>\n                            {foreachStepYaml && (\n                              <Button\n                                className=\"rounded-md\"\n                                variant=\"outline\"\n                                size=\"icon\"\n                                onClick={async () => {\n                                  try {\n                                    await navigator.clipboard.writeText(foreachStepYaml);\n                                    toast.success(\"Copied to clipboard\");\n                                  } catch {\n                                    toast.error(\"Failed to copy\");\n                                  }\n                                }}\n                              >\n                                <ClipboardIcon className=\"size-4\" />\n                                <span className=\"sr-only\">Copy foreach step YAML</span>\n                              </Button>\n                            )}\n                          </div>\n\n                          <div className=\"rounded-md border p-2 text-sm\">\n                            <div className=\"flex items-center gap-2\">\n                              {stepTypeIcons[selectedStep.step.type]}\n                              <span className=\"font-medium\">{selectedStep.step.name}</span>\n                              <Badge variant=\"secondary\" className=\"capitalize\">\n                                {selectedStep.step.type}\n                              </Badge>\n                            </div>\n                          </div>\n\n                          {foreachStepYaml && (\n                            <div className=\"rounded-md border bg-muted/30 p-2\">\n                              <CodeHighlighter\n                                language=\"yaml\"\n                                style={theme === \"dark\" ? atomOneDark : github}\n                                customStyle={{\n                                  margin: 0,\n                                  background: \"transparent\",\n                                  fontSize: \"0.75rem\",\n                                  whiteSpace: \"pre-wrap\",\n                                  wordBreak: \"break-word\",\n                                }}\n                                codeTagProps={{\n                                  style: {\n                                    whiteSpace: \"pre-wrap\",\n                                    wordBreak: \"break-word\",\n                                  },\n                                }}\n                                showLineNumbers\n                              >\n                                {foreachStepYaml.trim()}\n                              </CodeHighlighter>\n                            </div>\n                          )}\n                        </div>\n                      )}\n                    </>\n                  )}\n                </div>\n\n                {/* Timeout */}\n                {selectedStep && selectedStep.timeout && (\n                  <>\n                    <Separator />\n                    <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                      <ClockIcon className=\"size-4\" />\n                      <span>Timeout: {selectedStep.timeout}s</span>\n                    </div>\n                  </>\n                )}\n\n                {/* Pre-condition */}\n                {selectedStep && selectedStep.pre_condition && (\n                  <>\n                    <Separator />\n                    <div className=\"space-y-2\">\n                      <Label className=\"text-muted-foreground\">Pre-condition</Label>\n                      <div className=\"rounded-md bg-muted p-3 font-mono text-xs\">\n                        {selectedStep.pre_condition}\n                      </div>\n                    </div>\n                  </>\n                )}\n\n                {/* Exports */}\n                {selectedStep && selectedStep.exports && Object.keys(selectedStep.exports).length > 0 && (\n                  <>\n                    <Separator />\n                    <div className=\"space-y-2\">\n                      <Label>Exports</Label>\n                      <div className=\"space-y-1\">\n                        {Object.entries(selectedStep.exports).map(([key, value]) => (\n                          <div\n                            key={key}\n                            className=\"flex items-center gap-2 text-xs font-mono\"\n                          >\n                            <Badge variant=\"outline\" className=\"font-mono\">\n                              {key}\n                            </Badge>\n                            <span className=\"text-muted-foreground truncate\">\n                              = {value}\n                            </span>\n                          </div>\n                        ))}\n                      </div>\n                    </div>\n                  </>\n                )}\n\n                {/* Decision Rules */}\n                {selectedStep?.decision && (\n                  <>\n                    <Separator />\n                    {renderDecisionBlock(selectedStep.decision)}\n                  </>\n                )}\n\n                {selectedStep && selectedStep.log && (\n                  <>\n                    <Separator />\n                    <div className=\"space-y-2\">\n                      <Label>Log</Label>\n                      <div className=\"rounded-md border bg-muted/30 p-2 font-mono text-xs whitespace-pre-wrap break-words\">\n                        {selectedStep.log}\n                      </div>\n                    </div>\n                  </>\n                )}\n              </div>\n            ) : (\n              <div className=\"flex h-full items-center justify-center p-4\">\n                <p className=\"text-sm text-muted-foreground text-center\">\n                  Select a node to view its properties\n                </p>\n              </div>\n            )}\n          </ScrollArea>\n        </TabsContent>\n\n        <TabsContent value=\"items\" className=\"flex-1 m-0 min-h-0\">\n          <ScrollArea className=\"h-full\">\n            <div className=\"p-3 space-y-2\">\n              {workflowKind === \"flow\" ? (\n                <>\n                  {allModules.length === 0 ? (\n                    <div className=\"p-4 text-sm text-muted-foreground text-center\">\n                      No modules\n                    </div>\n                  ) : (\n                    <div className=\"space-y-1\">\n                      {allModules.map((m) => {\n                        const isSelected = selectionName === m.name;\n                        return (\n                          <Button\n                            key={m.name}\n                            type=\"button\"\n                            variant={isSelected ? \"secondary\" : \"ghost\"}\n                            className=\"w-full justify-start\"\n                            onClick={() => {\n                              onNavigateToNode?.(m.name);\n                            }}\n                          >\n                            <div className=\"flex w-full items-center justify-between gap-3\">\n                              <span className=\"truncate font-mono text-xs\">{m.name}</span>\n                              <Badge variant=\"secondary\" className=\"capitalize\">\n                                module\n                              </Badge>\n                            </div>\n                          </Button>\n                        );\n                      })}\n                    </div>\n                  )}\n                </>\n              ) : (\n                <>\n                  {allSteps.length === 0 ? (\n                    <div className=\"p-4 text-sm text-muted-foreground text-center\">\n                      No steps\n                    </div>\n                  ) : (\n                    <div className=\"space-y-1\">\n                      {allSteps.map((s) => {\n                        const isSelected = selectionName === s.name;\n                        return (\n                          <Button\n                            key={s.name}\n                            type=\"button\"\n                            variant={isSelected ? \"secondary\" : \"ghost\"}\n                            className=\"w-full justify-start\"\n                            onClick={() => {\n                              onNavigateToNode?.(s.name);\n                            }}\n                          >\n                            <div className=\"flex w-full items-center justify-between gap-3\">\n                              <span className=\"truncate font-mono text-xs\">{s.name}</span>\n                              <Badge variant={badgeVariantForStepType(s.type)} className=\"capitalize\">\n                                {s.type}\n                              </Badge>\n                            </div>\n                          </Button>\n                        );\n                      })}\n                    </div>\n                  )}\n                </>\n              )}\n            </div>\n          </ScrollArea>\n        </TabsContent>\n\n        <TabsContent value=\"yaml\" className=\"flex-1 m-0 min-h-0\">\n          <div className=\"h-full min-h-0 overflow-y-auto p-3\">\n            <CodeHighlighter\n              language=\"yaml\"\n              style={theme === \"dark\" ? atomOneDark : github}\n              customStyle={{\n                margin: 0,\n                background: \"transparent\",\n                fontSize: \"0.75rem\",\n                maxHeight: \"100%\",\n                overflowY: \"auto\",\n                whiteSpace: wrapLongText ? \"pre-wrap\" : \"pre\",\n                wordBreak: wrapLongText ? \"break-word\" : \"normal\",\n              }}\n              codeTagProps={{\n                style: {\n                  whiteSpace: wrapLongText ? \"pre-wrap\" : \"pre\",\n                  wordBreak: wrapLongText ? \"break-word\" : \"normal\",\n                },\n              }}\n              showLineNumbers\n            >\n              {yamlPreview}\n            </CodeHighlighter>\n          </div>\n        </TabsContent>\n      </Tabs>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3594, "column": 0}, "map": {"version":3,"sources":["file:///Users/bytedance/Desktop/external/osmedeus-dashboard/components/workflow-editor/utils/yaml-parser.ts"],"sourcesContent":["import yaml from \"js-yaml\";\nimport type { Node, Edge } from \"@xyflow/react\";\nimport type {\n  WorkflowYaml,\n  WorkflowStep,\n  WorkflowNodeData,\n  ModuleWorkflowYaml,\n  FlowWorkflowYaml,\n  WorkflowFlowModule,\n  WorkflowDecision,\n} from \"@/lib/types/workflow\";\n\n// Use a compatible node type that works with React Flow's typing constraints\ntype WorkflowNode = Node & { data: WorkflowNodeData };\n\nexport interface ParsedWorkflow {\n  nodes: WorkflowNode[];\n  edges: Edge[];\n  metadata: {\n    name: string;\n    description: string;\n    kind: string;\n  };\n  raw: WorkflowYaml;\n}\n\ntype DecisionEdge = {\n  label: string;\n  next: string;\n  kind: \"rule\" | \"case\" | \"default\";\n};\n\nfunction isSwitchDecision(decision: unknown): decision is Extract<WorkflowDecision, { switch: string }> {\n  if (!decision || typeof decision !== \"object\") return false;\n  const d = decision as any;\n  return typeof d.switch === \"string\" && d.cases && typeof d.cases === \"object\" && !Array.isArray(d.cases);\n}\n\nfunction normalizeDecisionEdges(decision: unknown): DecisionEdge[] {\n  if (Array.isArray(decision)) {\n    return decision\n      .map((r) => ({\n        condition: typeof (r as any)?.condition === \"string\" ? (r as any).condition : \"\",\n        next: typeof (r as any)?.next === \"string\" ? (r as any).next : \"\",\n      }))\n      .filter((r) => r.next.trim().length > 0)\n      .map((r) => ({ label: r.condition, next: r.next, kind: \"rule\" as const }));\n  }\n\n  if (isSwitchDecision(decision)) {\n    const d = decision as any;\n    const cases: Record<string, any> = d.cases ?? {};\n    const edges: DecisionEdge[] = Object.entries(cases)\n      .filter(([key]) => typeof key === \"string\" && key.trim().length > 0)\n      .map(([key, value]) => {\n        const goto = typeof value?.goto === \"string\" ? value.goto : (typeof value?.next === \"string\" ? value.next : \"\");\n        return { label: key, next: goto, kind: \"case\" as const };\n      })\n      .filter((e) => e.next.trim().length > 0);\n\n    const defGoto = typeof d.default?.goto === \"string\" ? d.default.goto : (typeof d.default?.next === \"string\" ? d.default.next : \"\");\n    if (typeof defGoto === \"string\" && defGoto.trim().length > 0) {\n      edges.push({ label: \"default\", next: defGoto, kind: \"default\" });\n    }\n\n    return edges;\n  }\n\n  return [];\n}\n\nfunction truncateLabel(label: string, maxLen = 30): string {\n  const trimmed = label.trim();\n  if (trimmed.length <= maxLen) return trimmed;\n  return trimmed.substring(0, maxLen) + \"...\";\n}\n\nexport function parseWorkflowYaml(yamlText: string): ParsedWorkflow {\n  const workflowAny = (yaml.load(yamlText) as any) ?? {};\n  const kind: \"module\" | \"flow\" = workflowAny?.kind === \"flow\" ? \"flow\" : \"module\";\n  const workflow = workflowAny as WorkflowYaml;\n  const nodes: WorkflowNode[] = [];\n  const edges: Edge[] = [];\n\n  // Add start node\n  nodes.push({\n    id: \"_start\",\n    type: \"start\",\n    position: { x: 0, y: 0 },\n    data: { label: \"Start\", step: null, module: null },\n  });\n\n  if (kind === \"module\") {\n    const wf = workflow as ModuleWorkflowYaml;\n    const steps = Array.isArray((wf as any)?.steps) ? (wf as any).steps : [];\n    const stepIds = new Set<string>(steps.map((s: any) => (typeof s?.name === \"string\" ? s.name : \"\")).filter(Boolean));\n    const missingNodeIds = new Set<string>();\n\n    steps.forEach((step: WorkflowStep, index: number) => {\n      const nodeId = step.name;\n\n      nodes.push({\n        id: nodeId,\n        type: step.type,\n        position: { x: 0, y: 0 },\n        data: {\n          label: step.name,\n          step,\n          module: null,\n        },\n      });\n\n      const prevNodeId = index === 0 ? \"_start\" : steps[index - 1].name;\n      const prevStep = index > 0 ? steps[index - 1] : null;\n      const prevHasSwitch = isSwitchDecision((prevStep as any)?.decision);\n      const prevDecisionEdges = prevStep ? normalizeDecisionEdges((prevStep as any).decision) : [];\n      const hasDecisionToThis = prevDecisionEdges.some((d) => d.next === nodeId);\n\n      if (!prevHasSwitch && !hasDecisionToThis) {\n        edges.push({\n          id: `${prevNodeId}->${nodeId}`,\n          source: prevNodeId,\n          target: nodeId,\n          type: \"smoothstep\",\n          animated: step.type === \"parallel\" || step.type === \"parallel-steps\",\n        });\n      }\n\n      const decisionEdges = normalizeDecisionEdges((step as any).decision);\n      if (decisionEdges.length > 0) {\n        decisionEdges.forEach((rule) => {\n          const next = rule.next;\n          if (next !== \"_end\" && !stepIds.has(next)) missingNodeIds.add(next);\n          edges.push({\n            id: `${nodeId}->${next}:${rule.kind}:${rule.label}`,\n            source: nodeId,\n            target: next,\n            type: \"smoothstep\",\n            label: truncateLabel(rule.label),\n            style: { strokeDasharray: \"5 5\" },\n          });\n        });\n      }\n    });\n\n    for (const missingId of missingNodeIds) {\n      if (stepIds.has(missingId)) continue;\n      nodes.push({\n        id: missingId,\n        position: { x: 0, y: 0 },\n        data: {\n          label: `Missing: ${missingId}`,\n          step: null,\n          module: null,\n        },\n      });\n    }\n\n    if (steps.length > 0) {\n      const lastStep = steps[steps.length - 1];\n      const lastHasSwitch = isSwitchDecision((lastStep as any)?.decision);\n      const hasAnyEndEdge = edges.some((e) => e.source === lastStep.name && e.target === \"_end\");\n      if (!lastHasSwitch && !hasAnyEndEdge) {\n        edges.push({\n          id: `${lastStep.name}->_end`,\n          source: lastStep.name,\n          target: \"_end\",\n          type: \"smoothstep\",\n        });\n      }\n    }\n  } else {\n    const wf = workflow as FlowWorkflowYaml;\n    const modules = Array.isArray((wf as any)?.modules) ? ((wf as any).modules as WorkflowFlowModule[]) : [];\n\n    modules.forEach((m) => {\n      nodes.push({\n        id: m.name,\n        type: \"module\",\n        position: { x: 0, y: 0 },\n        data: {\n          label: m.name,\n          step: null,\n          module: m,\n        },\n      });\n    });\n\n    const nodeIds = new Set(modules.map((m) => m.name));\n    const missingNodeIds = new Set<string>();\n    const outDegree = new Map<string, number>();\n\n    modules.forEach((m) => {\n      const deps = Array.isArray(m.depends_on) ? m.depends_on.filter((d) => typeof d === \"string\") : [];\n      if (deps.length > 0) {\n        deps.forEach((d) => {\n          if (!nodeIds.has(d)) return;\n          edges.push({\n            id: `${d}->${m.name}`,\n            source: d,\n            target: m.name,\n            type: \"smoothstep\",\n          });\n          outDegree.set(d, (outDegree.get(d) || 0) + 1);\n        });\n      } else {\n        edges.push({\n          id: `_start->${m.name}`,\n          source: \"_start\",\n          target: m.name,\n          type: \"smoothstep\",\n        });\n      }\n\n      const decisionEdges = normalizeDecisionEdges((m as any).decision);\n      if (decisionEdges.length > 0) {\n        decisionEdges.forEach((rule) => {\n          const next = rule.next;\n          if (next !== \"_end\" && !nodeIds.has(next)) missingNodeIds.add(next);\n          edges.push({\n            id: `${m.name}->${next}:${rule.kind}:${rule.label}`,\n            source: m.name,\n            target: next,\n            type: \"smoothstep\",\n            label: truncateLabel(rule.label),\n            style: { strokeDasharray: \"5 5\" },\n          });\n          outDegree.set(m.name, (outDegree.get(m.name) || 0) + 1);\n        });\n      }\n    });\n\n    for (const missingId of missingNodeIds) {\n      if (nodeIds.has(missingId)) continue;\n      nodes.push({\n        id: missingId,\n        position: { x: 0, y: 0 },\n        data: {\n          label: `Missing: ${missingId}`,\n          step: null,\n          module: null,\n        },\n      });\n    }\n\n    if (modules.length === 0) {\n      edges.push({\n        id: `_start->_end`,\n        source: \"_start\",\n        target: \"_end\",\n        type: \"smoothstep\",\n      });\n    } else {\n      modules.forEach((m) => {\n        const od = outDegree.get(m.name) || 0;\n        if (od === 0) {\n          edges.push({\n            id: `${m.name}->_end`,\n            source: m.name,\n            target: \"_end\",\n            type: \"smoothstep\",\n          });\n        }\n      });\n    }\n  }\n\n  // Add end node\n  nodes.push({\n    id: \"_end\",\n    type: \"end\",\n    position: { x: 0, y: 0 },\n    data: { label: \"End\", step: null, module: null },\n  });\n\n  return {\n    nodes,\n    edges,\n    metadata: {\n      name: (workflowAny?.name as string) || \"\",\n      description: (workflowAny?.description as string) || \"\",\n      kind,\n    },\n    raw: workflow,\n  };\n}\n\nexport function serializeWorkflowToYaml(workflow: WorkflowYaml): string {\n  return yaml.dump(workflow, {\n    indent: 2,\n    lineWidth: -1,\n    noRefs: true,\n    quotingType: '\"',\n  });\n}\n\nexport function updateStepInWorkflow(\n  workflow: ModuleWorkflowYaml,\n  stepName: string,\n  updates: Partial<WorkflowStep>\n): ModuleWorkflowYaml {\n  return {\n    ...workflow,\n    steps: workflow.steps.map((step) =>\n      step.name === stepName ? { ...step, ...updates } : step\n    ),\n  };\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3894, "column": 0}, "map": {"version":3,"sources":["file:///Users/bytedance/Desktop/external/osmedeus-dashboard/components/shared/error-state.tsx"],"sourcesContent":["import * as React from \"react\";\nimport { cn } from \"@/lib/utils\";\nimport { Button } from \"@/components/ui/button\";\nimport { AlertCircleIcon, RefreshCwIcon } from \"lucide-react\";\n\ninterface ErrorStateProps {\n  title?: string;\n  message?: string;\n  onRetry?: () => void;\n  className?: string;\n}\n\nexport function ErrorState({\n  title = \"Something went wrong\",\n  message = \"We couldn't load the data. Please try again.\",\n  onRetry,\n  className,\n}: ErrorStateProps) {\n  return (\n    <div\n      className={cn(\n        \"flex flex-col items-center justify-center py-12 text-center\",\n        className\n      )}\n    >\n      <div className=\"mb-4 rounded-full bg-destructive/10 p-4\">\n        <AlertCircleIcon className=\"size-8 text-destructive\" />\n      </div>\n      <h3 className=\"mb-1 text-lg font-semibold\">{title}</h3>\n      <p className=\"mb-4 max-w-sm text-sm text-muted-foreground\">{message}</p>\n      {onRetry && (\n        <Button onClick={onRetry} variant=\"outline\">\n          <RefreshCwIcon className=\"mr-2 size-4\" />\n          Try again\n        </Button>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AAAA;;;;;AASO,SAAS,WAAW,EACzB,QAAQ,sBAAsB,EAC9B,UAAU,8CAA8C,EACxD,OAAO,EACP,SAAS,EACO;IAChB,qBACE,6LAAC;QACC,WAAW,IAAA,qHAAE,EACX,+DACA;;0BAGF,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC,8OAAe;oBAAC,WAAU;;;;;;;;;;;0BAE7B,6LAAC;gBAAG,WAAU;0BAA8B;;;;;;0BAC5C,6LAAC;gBAAE,WAAU;0BAA+C;;;;;;YAC3D,yBACC,6LAAC,wIAAM;gBAAC,SAAS;gBAAS,SAAQ;;kCAChC,6LAAC,wOAAa;wBAAC,WAAU;;;;;;oBAAgB;;;;;;;;;;;;;AAMnD;KA1BgB"}},
    {"offset": {"line": 3976, "column": 0}, "map": {"version":3,"sources":["file:///Users/bytedance/Desktop/external/osmedeus-dashboard/lib/mock/workflow-yamls.ts"],"sourcesContent":["export const MOCK_WORKFLOW_YAMLS: Record<string, string> = {\n  \"test-complex-docker-workflow\": `name: test-complex-docker-workflow\nkind: module\ndescription: Complex workflow demonstrating bash, function steps with docker step_runner\n\nparams:\n  - name: target\n    required: true\n  - name: output_dir\n    default: /tmp/osm-complex-test\n  - name: threads\n    default: \"5\"\n\nsteps:\n  # Step 1: Setup - Create directories using function\n  - name: setup-workspace\n    type: function\n    log: \"Setting up workspace for {{target}}\"\n    function: createDir(\"{{output_dir}}\")\n    exports:\n      workspace_created: \"output\"\n\n  # Step 2: Create input file with bash\n  - name: create-target-list\n    type: bash\n    log: \"Creating target list for {{target}}\"\n    commands:\n      - mkdir -p {{output_dir}}/targets\n      - |\n        cat > {{output_dir}}/targets/hosts.txt << 'EOF'\n        sub1.{{target}}\n        sub2.{{target}}\n        api.{{target}}\n        www.{{target}}\n        admin.{{target}}\n        EOF\n    exports:\n      target_file: \"{{output_dir}}/targets/hosts.txt\"\n\n  # Step 3: Docker-based DNS resolution simulation\n  - name: dns-resolve\n    type: remote-bash\n    log: \"Resolving DNS for targets in Docker\"\n    timeout: 60\n    step_runner: docker\n    step_runner_config:\n      image: alpine:latest\n      env:\n        TARGET_DOMAIN: \"{{target}}\"\n      volumes:\n        - \"{{output_dir}}:/workspace\"\n      workdir: /workspace\n    command: |\n      echo \"Resolving DNS for $TARGET_DOMAIN\"\n      cat /workspace/targets/hosts.txt | while read host; do\n        echo \"$host -> 127.0.0.1\" >> /workspace/dns-resolved.txt\n      done\n      echo \"DNS resolution complete\"\n    exports:\n      dns_output: \"{{output_dir}}/dns-resolved.txt\"\n\n  # Step 4: Parallel docker commands - simulating port scanning\n  - name: parallel-port-scan\n    type: remote-bash\n    log: \"Running parallel port scans in Docker\"\n    timeout: 120\n    step_runner: docker\n    step_runner_config:\n      image: alpine:latest\n      volumes:\n        - \"{{output_dir}}:/workspace\"\n    parallel_commands:\n      - 'echo \"Scanning ports 1-1000 on {{target}}\" && sleep 1 && echo \"Port 80 open\" > /workspace/ports-1.txt'\n      - 'echo \"Scanning ports 1001-2000 on {{target}}\" && sleep 1 && echo \"Port 443 open\" > /workspace/ports-2.txt'\n      - 'echo \"Scanning ports 2001-3000 on {{target}}\" && sleep 1 && echo \"Port 8080 open\" > /workspace/ports-3.txt'\n      - 'echo \"Scanning ports 3001-4000 on {{target}}\" && sleep 1 && echo \"Port 3306 open\" > /workspace/ports-4.txt'\n\n  # Step 5: Merge port scan results\n  - name: merge-port-results\n    type: bash\n    log: \"Merging port scan results\"\n    command: cat {{output_dir}}/ports-*.txt > {{output_dir}}/all-ports.txt\n    exports:\n      ports_file: \"{{output_dir}}/all-ports.txt\"\n\n  # Step 6: Function to check file existence\n  - name: verify-ports-file\n    type: function\n    log: \"Verifying ports file exists\"\n    function: fileExists(\"{{ports_file}}\")\n    exports:\n      ports_verified: \"output\"\n\n  # Step 7: Docker-based HTTP probing with parallel steps\n  - name: http-probe-parallel\n    type: parallel-steps\n    log: \"Running parallel HTTP probes\"\n    parallel_steps:\n      - name: probe-http\n        type: remote-bash\n        step_runner: docker\n        step_runner_config:\n          image: alpine:latest\n          volumes:\n            - \"{{output_dir}}:/workspace\"\n        command: |\n          echo \"Probing HTTP on port 80\"\n          echo \"http://{{target}}:80 [200]\" > /workspace/http-80.txt\n      - name: probe-https\n        type: remote-bash\n        step_runner: docker\n        step_runner_config:\n          image: alpine:latest\n          volumes:\n            - \"{{output_dir}}:/workspace\"\n        command: |\n          echo \"Probing HTTPS on port 443\"\n          echo \"https://{{target}}:443 [200]\" > /workspace/https-443.txt\n      - name: probe-alt\n        type: remote-bash\n        step_runner: docker\n        step_runner_config:\n          image: alpine:latest\n          volumes:\n            - \"{{output_dir}}:/workspace\"\n        command: |\n          echo \"Probing alternate port 8080\"\n          echo \"http://{{target}}:8080 [404]\" > /workspace/http-8080.txt\n\n  # Step 8: Foreach loop with docker - process each subdomain\n  - name: process-subdomains\n    type: foreach\n    log: \"Processing each subdomain\"\n    input: \"{{output_dir}}/targets/hosts.txt\"\n    variable: subdomain\n    threads: 3\n    step:\n      name: scan-subdomain\n      type: remote-bash\n      step_runner: docker\n      step_runner_config:\n        image: alpine:latest\n        volumes:\n          - \"{{output_dir}}:/workspace\"\n      command: |\n        echo \"Scanning [[subdomain]]...\"\n        echo \"[[subdomain]]: status=200, title=Example\" >> /workspace/subdomain-results.txt\n\n  # Step 9: Read results with function\n  - name: read-subdomain-results\n    type: function\n    log: \"Reading subdomain scan results\"\n    function: readFile(\"{{output_dir}}/subdomain-results.txt\")\n    exports:\n      scan_results: \"output\"\n\n  # Step 10: Decision based routing\n  - name: check-results\n    type: bash\n    log: \"Checking scan results\"\n    command: wc -l < {{output_dir}}/subdomain-results.txt\n    exports:\n      result_count: \"output\"\n    decision:\n      - condition: result_count == \"0\"\n        next: \"_end\"\n      - condition: result_count != \"0\"\n        next: \"generate-report\"\n\n  # Step 11: Generate final report in docker\n  - name: generate-report\n    type: remote-bash\n    log: \"Generating final report\"\n    timeout: 30\n    step_runner: docker\n    step_runner_config:\n      image: alpine:latest\n      volumes:\n        - \"{{output_dir}}:/workspace\"\n    commands:\n      - echo \"=== Scan Report for {{target}} ===\" > /workspace/report.txt\n      - echo \"\" >> /workspace/report.txt\n      - echo \"--- DNS Results ---\" >> /workspace/report.txt\n      - cat /workspace/dns-resolved.txt >> /workspace/report.txt 2>/dev/null || echo \"No DNS results\" >> /workspace/report.txt\n      - echo \"\" >> /workspace/report.txt\n      - echo \"--- Open Ports ---\" >> /workspace/report.txt\n      - cat /workspace/all-ports.txt >> /workspace/report.txt 2>/dev/null || echo \"No ports found\" >> /workspace/report.txt\n      - echo \"\" >> /workspace/report.txt\n      - echo \"--- Subdomain Results ---\" >> /workspace/report.txt\n      - cat /workspace/subdomain-results.txt >> /workspace/report.txt 2>/dev/null || echo \"No subdomain results\" >> /workspace/report.txt\n      - echo \"\" >> /workspace/report.txt\n      - echo \"Report generated at $(date)\" >> /workspace/report.txt\n    exports:\n      report_file: \"{{output_dir}}/report.txt\"\n\n  # Step 12: Parallel functions to get file stats\n  - name: get-file-stats\n    type: function\n    log: \"Getting file statistics\"\n    parallel_functions:\n      - fileLength(\"{{output_dir}}/report.txt\")\n      - fileExists(\"{{output_dir}}/all-ports.txt\")\n      - trim(\"  {{target}}  \")\n    exports:\n      file_stats: \"output\"\n\n  # Step 13: Cleanup (optional - controlled by pre_condition)\n  - name: cleanup-temp-files\n    type: bash\n    log: \"Cleaning up temporary files\"\n    pre_condition: \"false\"\n    command: rm -rf {{output_dir}}/ports-*.txt\n    on_error:\n      - action: log\n        message: \"Cleanup failed but continuing\"\n      - action: continue\n`,\n  \"test-decision\": `name: test-decision\nkind: module\ndescription: Test conditional step routing with decision\n\nparams:\n  - name: target\n    required: true\n\nsteps:\n  - name: check-condition\n    type: bash\n    command: echo \"{{target}}\"\n    exports:\n      target_value: \"output\"\n    decision:\n      - condition: target_value == \"skip\"\n        next: \"_end\"\n      - condition: target_value == \"jump\"\n        next: \"final-step\"\n\n  - name: middle-step\n    type: bash\n    command: echo \"middle executed\"\n    exports:\n      middle_output: \"output\"\n\n  - name: final-step\n    type: bash\n    command: echo \"final executed\"\n    exports:\n      final_output: \"output\"\n`,\n  \"test-docker-flow\": `name: test-docker-flow\nkind: flow\ndescription: Flow orchestrating multiple Docker-based security scanning modules\n\nparams:\n  - name: target\n    required: true\n  - name: Output\n    default: /tmp/osm-docker-flow\n  - name: mode\n    default: \"full\"\n  - name: threads\n    default: \"10\"\n  - name: skip_vuln_scan\n    default: \"false\"\n\nmodules:\n  # Module 1: Initial reconnaissance\n  - name: recon-module\n    path: modules/test-docker-recon\n    params:\n      target: \"{{target}}\"\n      output_dir: \"{{Output}}/recon\"\n      threads: \"{{threads}}\"\n    on_success:\n      - action: log\n        message: \"Reconnaissance completed for {{target}}\"\n      - action: export\n        key: recon_complete\n        value: \"true\"\n    on_error:\n      - action: log\n        message: \"Reconnaissance failed for {{target}}\"\n      - action: abort\n\n  # Module 2: Subdomain enumeration (depends on recon)\n  - name: subdomain-module\n    path: modules/test-docker-subdomain\n    depends_on:\n      - recon-module\n    params:\n      target: \"{{target}}\"\n      output_dir: \"{{Output}}/subdomains\"\n      wordlist: \"/usr/share/wordlists/subdomains.txt\"\n    condition: \"mode == 'full' || mode == 'subdomain'\"\n    on_success:\n      - action: export\n        key: subdomains_file\n        value: \"{{Output}}/subdomains/all.txt\"\n\n  # Module 3: Port scanning (parallel with subdomain)\n  - name: portscan-module\n    path: modules/test-docker-portscan\n    depends_on:\n      - recon-module\n    params:\n      target: \"{{target}}\"\n      output_dir: \"{{Output}}/ports\"\n      port_range: \"1-10000\"\n      rate: \"1000\"\n    condition: \"mode == 'full' || mode == 'portscan'\"\n\n  # Module 4: HTTP probing (depends on subdomain results)\n  - name: httpx-module\n    path: modules/test-docker-httpx\n    depends_on:\n      - subdomain-module\n    params:\n      input: \"{{subdomains_file}}\"\n      output_dir: \"{{Output}}/http\"\n      threads: \"{{threads}}\"\n    on_success:\n      - action: export\n        key: alive_hosts\n        value: \"{{Output}}/http/alive.txt\"\n      - action: export\n        key: httpx_json\n        value: \"{{Output}}/http/httpx.json\"\n    decision:\n      - condition: \"fileLength('{{Output}}/http/alive.txt') == 0\"\n        next: \"report-module\"\n\n  # Module 5: Technology detection (depends on HTTP probe)\n  - name: tech-detect-module\n    path: modules/test-docker-techdetect\n    depends_on:\n      - httpx-module\n    params:\n      input: \"{{alive_hosts}}\"\n      output_dir: \"{{Output}}/tech\"\n\n  # Module 6: Screenshot capture (parallel with tech detection)\n  - name: screenshot-module\n    path: modules/test-docker-screenshot\n    depends_on:\n      - httpx-module\n    params:\n      input: \"{{alive_hosts}}\"\n      output_dir: \"{{Output}}/screenshots\"\n      threads: \"5\"\n\n  # Module 7: Vulnerability scanning (conditional)\n  - name: vulnscan-module\n    path: modules/test-docker-scanning\n    depends_on:\n      - httpx-module\n      - tech-detect-module\n    params:\n      target: \"{{target}}\"\n      Output: \"{{Output}}/vulns\"\n      severity: \"critical,high,medium\"\n      threads: \"{{threads}}\"\n    condition: \"skip_vuln_scan != 'true'\"\n    on_error:\n      - action: log\n        message: \"Vulnerability scan encountered errors but continuing\"\n      - action: continue\n\n  # Module 8: Directory bruteforcing (optional - depends on mode)\n  - name: dirbrute-module\n    path: modules/test-docker-dirbrute\n    depends_on:\n      - httpx-module\n    params:\n      input: \"{{alive_hosts}}\"\n      output_dir: \"{{Output}}/dirs\"\n      wordlist: \"/usr/share/wordlists/common.txt\"\n      threads: \"20\"\n    condition: \"mode == 'full'\"\n\n  # Module 9: JavaScript analysis (depends on dir results)\n  - name: js-analysis-module\n    path: modules/test-docker-jsanalysis\n    depends_on:\n      - dirbrute-module\n    params:\n      input: \"{{Output}}/dirs/js-files.txt\"\n      output_dir: \"{{Output}}/js\"\n    condition: \"mode == 'full'\"\n\n  # Module 10: Final report generation\n  - name: report-module\n    path: modules/test-docker-report\n    depends_on:\n      - screenshot-module\n      - vulnscan-module\n      - tech-detect-module\n    params:\n      target: \"{{target}}\"\n      input_dir: \"{{Output}}\"\n      output_dir: \"{{Output}}/reports\"\n      format: \"html,json,markdown\"\n    on_success:\n      - action: log\n        message: \"Flow completed successfully for {{target}}\"\n      - action: notify\n        message: \"Security assessment complete: {{target}}\"\n`,\n  \"test-loop\": `name: test-loop\nkind: module\ndescription: Test foreach loop with threading\n\nparams:\n  - name: target\n    required: true\n\nsteps:\n  - name: create-input\n    type: bash\n    commands:\n      - mkdir -p {{Output}}\n      - printf 'one\\\\ntwo\\\\nthree\\\\nfour\\\\nfive\\\\n' > {{Output}}/items.txt\n\n  - name: process-items\n    type: foreach\n    input: \"{{Output}}/items.txt\"\n    variable: item\n    threads: 2\n    step:\n      name: process-item\n      type: bash\n      command: echo \"Processing [[item]] for {{target}}\"\n`,\n  \"comprehensive-flow-example\": `# =============================================================================\n# Flow Workflow: Comprehensive Example\n# =============================================================================\n# This file demonstrates ALL fields available in a flow-kind workflow.\n# Flows orchestrate multiple modules with dependencies, conditions, and routing.\n# =============================================================================\n\n# -----------------------------------------------------------------------------\n# WORKFLOW-LEVEL FIELDS\n# Same as module workflows (kind, name, description, tags, params, etc.)\n# -----------------------------------------------------------------------------\n\n# kind: Workflow type - \"flow\" orchestrates multiple modules\nkind: flow\n\n# name: Unique identifier for this workflow (required)\nname: comprehensive-flow-example\n\n# description: Human-readable description\ndescription: Demonstrates all flow-specific fields including modules, dependencies, conditions, and decisions\n\n# tags: Comma-separated tags for filtering\ntags: flow, comprehensive, example\n\n# -----------------------------------------------------------------------------\n# PARAMS SECTION\n# Parameters available to all modules in this flow\n# -----------------------------------------------------------------------------\nparams:\n  - name: threads\n    default: \"10\"\n\n  - name: timeout\n    default: \"3600\"\n\n  - name: scan_depth\n    default: \"normal\"\n\n  - name: output_format\n    default: \"json\"\n\n# -----------------------------------------------------------------------------\n# DEPENDENCIES SECTION\n# Flow-level dependencies checked before any module executes\n# -----------------------------------------------------------------------------\ndependencies:\n  commands:\n    - nmap\n    - nuclei\n    - httpx\n\n  files:\n    - /tmp\n\n  variables:\n    - name: Target\n      type: domain\n      required: true\n\n# -----------------------------------------------------------------------------\n# REPORTS SECTION\n# Reports aggregated from all modules in this flow\n# -----------------------------------------------------------------------------\nreports:\n  - name: flow-summary\n    path: \"{{Output}}/flow-summary.json\"\n    type: json\n    description: Aggregated results from all modules\n\n  - name: vulnerabilities\n    path: \"{{Output}}/vulnerabilities.txt\"\n    type: text\n    description: All discovered vulnerabilities\n\n# -----------------------------------------------------------------------------\n# PREFERENCES SECTION\n# Flow-level preferences apply to all module executions\n# -----------------------------------------------------------------------------\npreferences:\n  skip_workspace: false\n  disable_notifications: false\n  heuristics_check: 'basic'\n\n# -----------------------------------------------------------------------------\n# MODULES SECTION (Flow-specific)\n# Ordered list of module references to execute\n# =============================================================================\nmodules:\n  # ===========================================================================\n  # Module Reference: Basic Configuration\n  # ===========================================================================\n  - # name: Display name for this module execution (required)\n    name: reconnaissance\n\n    # path: Path to the module YAML file (required)\n    # Can be relative to workflows directory or absolute\n    path: modules/recon.yaml\n\n    # params: Parameters to pass to this module\n    # Overrides module defaults and flow-level params\n    params:\n      threads: \"20\"  # Override flow-level threads\n      output_dir: \"{{Output}}/recon\"\n\n  # ===========================================================================\n  # Module Reference: With Dependencies (depends_on)\n  # ===========================================================================\n  - name: port-scanning\n    path: modules/portscan.yaml\n\n    # depends_on: List of module names that must complete before this module runs\n    # Creates a DAG (Directed Acyclic Graph) for execution order\n    depends_on:\n      - reconnaissance\n\n    params:\n      target_list: \"{{Output}}/recon/subdomains.txt\"\n      threads: \"{{threads}}\"\n\n  # ===========================================================================\n  # Module Reference: With Condition\n  # ===========================================================================\n  - name: web-scanning\n    path: modules/webscan.yaml\n\n    depends_on:\n      - port-scanning\n\n    # condition: JavaScript expression - module only runs if evaluates to true\n    # Can reference exported variables from previous modules\n    condition: 'fileLength(\"{{Output}}/portscan/http-services.txt\") > 0'\n\n    params:\n      input: \"{{Output}}/portscan/http-services.txt\"\n\n  # ===========================================================================\n  # Module Reference: With on_success Handler\n  # ===========================================================================\n  - name: vulnerability-scanning\n    path: modules/vuln-scan.yaml\n\n    depends_on:\n      - web-scanning\n\n    condition: 'fileExists(\"{{Output}}/webscan/endpoints.txt\")'\n\n    params:\n      endpoints: \"{{Output}}/webscan/endpoints.txt\"\n      timeout: \"{{timeout}}\"\n\n    # on_success: Actions to execute when this module completes successfully\n    on_success:\n      # action: log - Log a message\n      - action: log\n        message: \"Vulnerability scanning completed for {{Target}}\"\n\n      # action: export - Export a variable for subsequent modules\n      - action: export\n        name: vuln_scan_complete\n        value: \"true\"\n\n      # action: notify - Send a notification\n      - action: notify\n        notify: \"Vulnerability scan finished for {{Target}}\"\n\n      # action: run - Execute a follow-up step\n      - action: run\n        type: bash\n        command: 'echo \"Vuln scan done\" >> {{Output}}/flow-log.txt'\n\n      # action: run with functions\n      - action: run\n        type: function\n        functions:\n          - 'log_info(\"Module completed successfully\")'\n\n  # ===========================================================================\n  # Module Reference: With on_error Handler\n  # ===========================================================================\n  - name: exploit-verification\n    path: modules/exploit-verify.yaml\n\n    depends_on:\n      - vulnerability-scanning\n\n    condition: '{{vuln_scan_complete}} == \"true\"'\n\n    params:\n      vulns_file: \"{{Output}}/vuln-scan/vulnerabilities.json\"\n\n    # on_error: Actions to execute when this module fails\n    on_error:\n      # action: log - Log error message\n      - action: log\n        message: \"Exploit verification failed for {{Target}}\"\n        # condition: Only execute if this condition is true\n        condition: 'true'\n\n      # action: continue - Allow flow to continue despite error\n      - action: continue\n        message: \"Continuing flow despite exploit verification failure\"\n\n      # action: abort - Stop the entire flow\n      # (Usually with a condition so it doesn't always abort)\n      - action: abort\n        message: \"Critical failure - aborting flow\"\n        condition: 'false'  # Only abort under specific conditions\n\n      # action: notify - Alert on failure\n      - action: notify\n        notify: \"Module failed: exploit-verification for {{Target}}\"\n\n      # action: export - Export error state\n      - action: export\n        name: exploit_verify_failed\n        value: \"true\"\n\n  # ===========================================================================\n  # Module Reference: With Decision Routing\n  # ===========================================================================\n  - name: deep-scan\n    path: modules/deep-scan.yaml\n\n    depends_on:\n      - vulnerability-scanning\n\n    # decision: Conditional routing based on results\n    # Determines which module to execute next based on conditions\n    decision:\n      # condition: JavaScript expression to evaluate\n      # next: Module name to jump to, or \"_end\" to finish flow\n      - condition: 'fileLength(\"{{Output}}/vuln-scan/critical.txt\") > 0'\n        next: notification-critical\n\n      - condition: 'fileLength(\"{{Output}}/vuln-scan/high.txt\") > 0'\n        next: notification-high\n\n      # Default case - continue to next module in list\n      - condition: 'true'\n        next: cleanup\n\n    params:\n      scan_depth: \"{{scan_depth}}\"\n\n  # ===========================================================================\n  # Module Reference: Notification branches (targets of decision routing)\n  # ===========================================================================\n  - name: notification-critical\n    path: modules/notify.yaml\n\n    # Note: This module can be jumped to via decision routing\n    # It won't run in normal sequential flow unless explicitly in depends_on\n\n    params:\n      severity: critical\n      message: \"Critical vulnerabilities found for {{Target}}\"\n      channel: security-alerts\n\n    on_success:\n      - action: export\n        name: notification_sent\n        value: \"critical\"\n\n  - name: notification-high\n    path: modules/notify.yaml\n\n    params:\n      severity: high\n      message: \"High severity vulnerabilities found for {{Target}}\"\n      channel: security-team\n\n    on_success:\n      - action: export\n        name: notification_sent\n        value: \"high\"\n\n  # ===========================================================================\n  # Module Reference: Parallel Module Execution\n  # Modules with same depends_on and no inter-dependencies run in parallel\n  # ===========================================================================\n  - name: ssl-analysis\n    path: modules/ssl-check.yaml\n\n    depends_on:\n      - port-scanning  # Same dependency as web-scanning\n\n    params:\n      input: \"{{Output}}/portscan/ssl-services.txt\"\n\n  - name: dns-analysis\n    path: modules/dns-check.yaml\n\n    depends_on:\n      - reconnaissance  # Can run in parallel with port-scanning\n\n    params:\n      domains: \"{{Output}}/recon/subdomains.txt\"\n\n  # ===========================================================================\n  # Module Reference: Cleanup/Final Module\n  # ===========================================================================\n  - name: cleanup\n    path: modules/cleanup.yaml\n\n    # depends_on multiple modules - waits for all to complete\n    depends_on:\n      - vulnerability-scanning\n      - exploit-verification\n      - ssl-analysis\n      - dns-analysis\n\n    # condition with multiple checks\n    condition: 'true'  # Always run cleanup\n\n    params:\n      output_dir: \"{{Output}}\"\n      format: \"{{output_format}}\"\n\n    on_success:\n      - action: log\n        message: \"Flow completed successfully for {{Target}}\"\n\n      - action: notify\n        notify: \"Security scan flow completed for {{Target}}\"\n\n      - action: export\n        name: flow_status\n        value: \"completed\"\n\n    on_error:\n      - action: log\n        message: \"Cleanup failed but flow results are preserved\"\n\n      - action: continue\n        message: \"Flow complete despite cleanup issues\"\n`,\n  \"triggers-example\": `# =============================================================================\n# Flow Workflow: All Trigger Types Example\n# =============================================================================\n# This file demonstrates ALL trigger types available in osmedeus workflows.\n# Triggers define when/how a workflow should automatically execute.\n# Trigger types: cron, event, watch, manual\n# =============================================================================\n\nkind: flow\nname: triggers-example\ndescription: Demonstrates all trigger types with comprehensive field documentation\ntags: triggers, automation, scheduled\n\n# -----------------------------------------------------------------------------\n# TRIGGERS SECTION\n# Define automatic execution triggers for this workflow\n# Multiple triggers can be defined; any triggered condition will start execution\n# =============================================================================\ntrigger:\n  # ===========================================================================\n  # TRIGGER TYPE: cron\n  # Schedule-based execution using cron expressions\n  # ===========================================================================\n  - # name: Identifier for this trigger (for logging and management)\n    name: daily-scan\n\n    # on: Trigger type - cron, event, watch, or manual\n    on: cron\n\n    # schedule: Cron expression defining when to run\n    # Format: minute hour day-of-month month day-of-week\n    # Examples:\n    #   \"0 0 * * *\"     - Every day at midnight\n    #   \"0 */6 * * *\"   - Every 6 hours\n    #   \"0 9 * * 1-5\"   - 9 AM on weekdays\n    #   \"0 0 1 * *\"     - First day of every month at midnight\n    schedule: \"0 2 * * *\"  # Every day at 2 AM\n\n    # input: Defines where the target input comes from for scheduled runs\n    input:\n      # type: Input source type - file, event_data, function, or param\n      type: file\n\n      # path: For \"file\" type - path to file containing targets (one per line)\n      path: \"/data/targets/active-targets.txt\"\n\n    # enabled: Whether this trigger is active\n    # true = trigger is active and will fire\n    # false = trigger is defined but disabled\n    enabled: true\n\n  # ---------------------------------------------------------------------------\n  # Cron trigger with function-based input\n  # ---------------------------------------------------------------------------\n  - name: weekly-full-scan\n    on: cron\n    schedule: \"0 0 * * 0\"  # Every Sunday at midnight\n\n    input:\n      # type: function - Generate input dynamically using a function\n      type: function\n\n      # function: JavaScript function to generate/retrieve targets\n      # Can use built-in functions like db queries, API calls, etc.\n      function: 'get_targets_from_db(\"scope:production\")'\n\n    enabled: true\n\n  # ===========================================================================\n  # TRIGGER TYPE: event\n  # Event-driven execution based on system events\n  # Events follow topic format: <component>.<event_type>\n  # ===========================================================================\n  - name: webhook-trigger\n    on: event\n\n    # event: Event configuration for event triggers\n    event:\n      # topic: Event topic to subscribe to\n      # Common topics:\n      #   webhook.received    - External webhook received\n      #   assets.new          - New asset discovered\n      #   assets.changed      - Asset data changed\n      #   db.change           - Database record changed\n      #   watch.files         - File system change detected\n      topic: webhook.received\n\n      # filters: JavaScript expressions to filter events\n      # Event data available as 'event' object with fields:\n      #   event.name      - Event name\n      #   event.source    - Event source\n      #   event.data      - JSON payload (string)\n      #   event.data_type - Type of data\n      # All filters must evaluate to true for trigger to fire\n      filters:\n        - 'event.source == \"github\"'\n        - 'event.name == \"push\"'\n\n    # input: How to extract target from event data\n    input:\n      # type: event_data - Extract from event payload\n      type: event_data\n\n      # field: JSON path to extract from event.data\n      # Uses dot notation for nested fields\n      field: \"repository.html_url\"\n\n    enabled: true\n\n  # ---------------------------------------------------------------------------\n  # Event trigger for new asset discovery\n  # ---------------------------------------------------------------------------\n  - name: new-asset-scan\n    on: event\n\n    event:\n      topic: assets.new\n\n      filters:\n        # Filter for specific asset types\n        - 'event.data_type == \"subdomain\"'\n        # Filter by source tool\n        - 'event.source == \"subfinder\" || event.source == \"amass\"'\n\n    input:\n      type: event_data\n      field: \"hostname\"\n\n    enabled: true\n\n  # ---------------------------------------------------------------------------\n  # Event trigger with function-based input extraction\n  # ---------------------------------------------------------------------------\n  - name: vuln-alert-trigger\n    on: event\n\n    event:\n      topic: webhook.received\n\n      filters:\n        - 'event.name == \"vulnerability_alert\"'\n        - 'JSON.parse(event.data).severity == \"critical\"'\n\n    input:\n      # type: function - Use function to parse/transform event data\n      type: function\n\n      # function: Transform event data to target format\n      function: 'jq(\"{{event.data}}\", \".affected_host\")'\n\n    enabled: true\n\n  # ===========================================================================\n  # TRIGGER TYPE: watch\n  # File system watch - triggers when files change\n  # ===========================================================================\n  - name: targets-file-watch\n    on: watch\n\n    # path: File or directory path to watch for changes\n    # Supports glob patterns in some implementations\n    path: \"/data/targets/new-targets.txt\"\n\n    # input: How to get targets when file changes\n    input:\n      type: file\n      path: \"/data/targets/new-targets.txt\"\n\n    enabled: true\n\n  # ---------------------------------------------------------------------------\n  # Watch trigger on directory\n  # ---------------------------------------------------------------------------\n  - name: input-directory-watch\n    on: watch\n\n    path: \"/data/incoming/\"\n\n    input:\n      # type: function - Process newly added files\n      type: function\n      function: 'get_new_files(\"/data/incoming/\", \"*.txt\")'\n\n    enabled: true\n\n  # ===========================================================================\n  # TRIGGER TYPE: manual\n  # Explicit manual trigger control\n  # Used to enable/disable CLI execution for this workflow\n  # ===========================================================================\n  - name: manual-execution\n    on: manual\n\n    # For manual triggers, enabled controls whether CLI can run this workflow\n    # enabled: true  - Allow: osmedeus run -f triggers-example -t target\n    # enabled: false - Block CLI execution (only scheduled/event triggers work)\n    enabled: true\n\n    # input: Default input for manual execution\n    # This is optional; CLI -t flag overrides this\n    input:\n      # type: param - Use a parameter as input\n      type: param\n\n      # name: Parameter name to use as target\n      name: Target\n\n  # ---------------------------------------------------------------------------\n  # Disabled manual trigger example\n  # This workflow can ONLY be triggered via cron/events, not CLI\n  # ---------------------------------------------------------------------------\n  # Uncomment to see the effect:\n  # - name: block-manual\n  #   on: manual\n  #   enabled: false\n\n# -----------------------------------------------------------------------------\n# PARAMS SECTION\n# -----------------------------------------------------------------------------\nparams:\n  - name: scan_type\n    default: \"standard\"\n\n  - name: threads\n    default: \"10\"\n\n# -----------------------------------------------------------------------------\n# MODULES SECTION\n# The actual workflow steps to execute when any trigger fires\n# -----------------------------------------------------------------------------\nmodules:\n  - name: initial-recon\n    path: modules/recon.yaml\n    params:\n      threads: \"{{threads}}\"\n\n  - name: scanning\n    path: modules/scan.yaml\n    depends_on:\n      - initial-recon\n    params:\n      scan_type: \"{{scan_type}}\"\n\n  - name: reporting\n    path: modules/report.yaml\n    depends_on:\n      - scanning\n\n    on_success:\n      - action: notify\n        notify: \"Triggered scan completed for {{Target}}\"\n        # condition: Only notify for certain triggers\n        condition: 'true'\n\n      - action: export\n        name: completed_at\n        value: \"{{currentDate()}}\"\n`,\n  \"docker-runner-example\": `# =============================================================================\n# Module Workflow: Docker Runner Configuration Example\n# =============================================================================\n# This file demonstrates all Docker runner configuration fields at both\n# the workflow level (for all steps) and step level (per-step override).\n# =============================================================================\n\nkind: module\nname: docker-runner-example\ndescription: Demonstrates Docker runner configuration with all available fields\ntags: docker, runner, container\n\n# -----------------------------------------------------------------------------\n# RUNNER CONFIGURATION (Workflow-Level)\n# Applies to all steps unless overridden at step level\n# -----------------------------------------------------------------------------\n\n# runner: Execution environment for this workflow\n# Options: host (default - local machine), docker, ssh\nrunner: docker\n\n# runner_config: Configuration for the selected runner type\nrunner_config:\n  # -------------------------------------------------------------------------\n  # DOCKER-SPECIFIC CONFIGURATION\n  # -------------------------------------------------------------------------\n\n  # image: Docker image to use (required for docker runner)\n  # Format: registry/image:tag or just image:tag\n  image: ubuntu:22.04\n\n  # env: Environment variables to set inside the container\n  # Map of VAR_NAME: value\n  env:\n    MY_VAR: my-value\n    API_KEY: \"{{api_key}}\"  # Can use template variables\n    THREADS: \"{{threads}}\"\n\n  # volumes: Volume mounts in docker format\n  # Format: host_path:container_path[:options]\n  # Options: ro (read-only), rw (read-write)\n  volumes:\n    - \"/tmp/osmedeus:/data\"\n    - \"{{Output}}:/output\"\n    - \"/etc/hosts:/etc/hosts:ro\"\n\n  # network: Docker network mode\n  # Options: bridge (default), host, none, container:<name>, or network name\n  network: host\n\n  # persistent: Container lifecycle mode\n  # true = reuse the same container across steps (faster, state preserved)\n  # false = ephemeral, create new container per step (isolated, clean state)\n  persistent: true\n\n  # -------------------------------------------------------------------------\n  # COMMON CONFIGURATION (applies to docker and ssh)\n  # -------------------------------------------------------------------------\n\n  # workdir: Working directory inside the container/remote\n  # Commands will execute in this directory\n  workdir: /app\n\nparams:\n  - name: api_key\n    default: \"demo-key\"\n\n  - name: threads\n    default: \"5\"\n\nsteps:\n  # ===========================================================================\n  # Step using workflow-level runner (docker with ubuntu:22.04)\n  # ===========================================================================\n  - name: use-workflow-runner\n    type: bash\n    log: \"Running in workflow-level Docker container\"\n    command: 'echo \"Running inside ubuntu:22.04 container\"'\n\n  # ===========================================================================\n  # Step with per-step Docker runner override\n  # Uses different image than workflow-level config\n  # ===========================================================================\n  - name: step-with-runner-override\n    type: bash\n    log: \"Running in step-specific Docker container\"\n\n    # step_runner: Override runner type for this step only\n    # Options: host, docker, ssh\n    step_runner: docker\n\n    # step_runner_config: Override runner configuration for this step\n    # Same structure as runner_config but applies only to this step\n    step_runner_config:\n      # Use a different image for this specific step\n      image: python:3.11-slim\n\n      env:\n        PYTHONPATH: /app\n\n      volumes:\n        - \"{{Output}}:/output:rw\"\n\n      network: bridge\n\n      persistent: false\n\n      workdir: /app\n\n    command: 'python3 -c \"print(\\\\\"Running in Python container\\\\\")\"'\n\n  # ===========================================================================\n  # Remote-bash step type with Docker (explicit remote-bash type)\n  # remote-bash is specifically for executing commands in remote environments\n  # ===========================================================================\n  - name: remote-bash-docker\n    # type: remote-bash is specifically for remote execution (docker/ssh)\n    type: remote-bash\n    log: \"Remote bash execution in Docker\"\n\n    # step_runner: Required for remote-bash type - specifies execution environment\n    # Must be \"docker\" or \"ssh\"\n    step_runner: docker\n\n    step_runner_config:\n      image: alpine:latest\n      workdir: /tmp\n\n    # command/commands/parallel_commands: Same as bash step\n    command: 'echo \"Hello from Alpine container\" > /tmp/output.txt'\n\n    # step_remote_file: File path on remote (inside container) to copy after execution\n    # This file will be copied from the container to the host\n    step_remote_file: /tmp/output.txt\n\n    # host_output_file: Local path where the remote file will be copied\n    # Template variables are supported\n    host_output_file: \"{{Output}}/docker-output.txt\"\n\n  # ===========================================================================\n  # Parallel commands in Docker container\n  # ===========================================================================\n  - name: docker-parallel-commands\n    type: bash\n    log: \"Running parallel commands in Docker\"\n    step_runner: docker\n    step_runner_config:\n      image: ubuntu:22.04\n      persistent: true\n\n    parallel_commands:\n      - 'sleep 2 && echo \"Parallel job A completed\"'\n      - 'sleep 1 && echo \"Parallel job B completed\"'\n      - 'sleep 3 && echo \"Parallel job C completed\"'\n\n  # ===========================================================================\n  # Foreach loop executing in Docker\n  # ===========================================================================\n  - name: docker-foreach\n    type: foreach\n    log: \"Processing items in Docker containers\"\n    input: \"{{Output}}/targets.txt\"\n    variable: target\n    threads: 3\n\n    step:\n      name: process-in-docker\n      type: bash\n      step_runner: docker\n      step_runner_config:\n        image: curlimages/curl:latest\n        network: host\n      command: 'curl -s -o /dev/null -w \"%{http_code}\" \"[[target]]\"'\n      exports:\n        http_status: \"{{stdout}}\"\n\n  # ===========================================================================\n  # Step running on host (override workflow's docker runner)\n  # ===========================================================================\n  - name: run-on-host\n    type: bash\n    log: \"Running on host machine (overriding workflow runner)\"\n\n    # Override to run locally instead of in container\n    step_runner: host\n\n    command: 'echo \"This runs directly on the host machine\"'\n\n  # ===========================================================================\n  # Docker step with all structured arguments\n  # ===========================================================================\n  - name: docker-with-args\n    type: bash\n    log: \"Docker step with structured arguments\"\n    step_runner: docker\n    step_runner_config:\n      image: nuclei:latest\n      volumes:\n        - \"{{Output}}:/output\"\n        - \"/root/nuclei-templates:/templates:ro\"\n      workdir: /output\n\n    command: nuclei\n    speed_args: '-rate-limit 100 -c {{threads}}'\n    config_args: '-t /templates/cves/'\n    input_args: '-u {{Target}}'\n    output_args: '-o /output/nuclei-results.txt'\n\n    step_remote_file: /output/nuclei-results.txt\n    host_output_file: \"{{Output}}/nuclei-results.txt\"\n\n    exports:\n      nuclei_output: \"{{Output}}/nuclei-results.txt\"\n`,\n  \"ssh-runner-example\": `# =============================================================================\n# Module Workflow: SSH Runner Configuration Example\n# =============================================================================\n# This file demonstrates all SSH runner configuration fields at both\n# the workflow level (for all steps) and step level (per-step override).\n# =============================================================================\n\nkind: module\nname: ssh-runner-example\ndescription: Demonstrates SSH runner configuration with all available fields\ntags: ssh, runner, remote\n\n# -----------------------------------------------------------------------------\n# RUNNER CONFIGURATION (Workflow-Level)\n# Applies to all steps unless overridden at step level\n# -----------------------------------------------------------------------------\n\n# runner: Execution environment for this workflow\n# Options: host (default - local machine), docker, ssh\nrunner: ssh\n\n# runner_config: Configuration for the selected runner type\nrunner_config:\n  # -------------------------------------------------------------------------\n  # SSH-SPECIFIC CONFIGURATION\n  # -------------------------------------------------------------------------\n\n  # host: SSH hostname or IP address (required for ssh runner)\n  # Can use template variables for dynamic targeting\n  host: \"{{ssh_host}}\"\n\n  # port: SSH port number\n  # Default: 22\n  port: 22\n\n  # user: SSH username for authentication\n  user: \"{{ssh_user}}\"\n\n  # key_file: Path to SSH private key file for key-based authentication\n  # Preferred over password authentication for security\n  key_file: \"{{ssh_key_path}}\"\n\n  # password: SSH password for password-based authentication\n  # WARNING: Not recommended - use key_file instead when possible\n  # Can use template variables or environment references\n  # password: \"{{ssh_password}}\"\n\n  # -------------------------------------------------------------------------\n  # COMMON CONFIGURATION (applies to docker and ssh)\n  # -------------------------------------------------------------------------\n\n  # workdir: Working directory on the remote machine\n  # Commands will execute in this directory\n  workdir: /home/scanner/workspace\n\nparams:\n  - name: ssh_host\n    default: \"192.168.1.100\"\n    required: true\n\n  - name: ssh_user\n    default: \"scanner\"\n    required: true\n\n  - name: ssh_key_path\n    default: \"~/.ssh/id_rsa\"\n\n  - name: threads\n    default: \"10\"\n\nsteps:\n  # ===========================================================================\n  # Step using workflow-level SSH runner\n  # ===========================================================================\n  - name: setup-remote-workspace\n    type: bash\n    log: \"Setting up workspace on remote SSH server\"\n    command: 'mkdir -p /home/scanner/workspace/results && echo \"Workspace ready\"'\n\n  # ===========================================================================\n  # Remote-bash step type with SSH (explicit remote-bash type)\n  # remote-bash is specifically designed for remote execution scenarios\n  # ===========================================================================\n  - name: remote-bash-ssh\n    # type: remote-bash is explicitly for remote execution (docker/ssh)\n    type: remote-bash\n    log: \"Remote bash execution via SSH\"\n\n    # step_runner: Required for remote-bash type - must be \"docker\" or \"ssh\"\n    step_runner: ssh\n\n    # step_runner_config: SSH configuration (inherits from workflow if not set)\n    # Omitting this uses workflow-level runner_config\n    step_runner_config:\n      host: \"{{ssh_host}}\"\n      port: 22\n      user: \"{{ssh_user}}\"\n      key_file: \"{{ssh_key_path}}\"\n      workdir: /tmp\n\n    # command: Command to execute on remote server\n    command: 'hostname && whoami && pwd > /tmp/remote-info.txt'\n\n    # step_remote_file: File on remote server to copy back to local host\n    # This is useful for retrieving results from remote execution\n    step_remote_file: /tmp/remote-info.txt\n\n    # host_output_file: Local path where remote file will be copied\n    host_output_file: \"{{Output}}/remote-info.txt\"\n\n    exports:\n      remote_file: \"{{Output}}/remote-info.txt\"\n\n  # ===========================================================================\n  # Step overriding SSH connection to different server\n  # ===========================================================================\n  - name: connect-to-secondary-server\n    type: bash\n    log: \"Connecting to secondary server\"\n\n    # Override workflow runner with different SSH target\n    step_runner: ssh\n\n    step_runner_config:\n      host: \"192.168.1.101\"  # Different server\n      port: 2222             # Non-standard port\n      user: admin\n      key_file: \"~/.ssh/secondary_key\"\n      workdir: /opt/scanner\n\n    command: 'echo \"Connected to secondary server\" && uptime'\n\n  # ===========================================================================\n  # Multiple sequential commands via SSH\n  # ===========================================================================\n  - name: ssh-multiple-commands\n    type: bash\n    log: \"Running multiple commands on remote\"\n\n    # commands: List of commands executed sequentially on remote\n    commands:\n      - 'echo \"Step 1: Checking system\"'\n      - 'df -h'\n      - 'echo \"Step 2: Checking memory\"'\n      - 'free -m'\n      - 'echo \"Step 3: Checking processes\"'\n      - 'ps aux | head -10'\n\n    std_file: \"{{Output}}/system-check.txt\"\n\n  # ===========================================================================\n  # Parallel commands on SSH (run concurrently on remote)\n  # ===========================================================================\n  - name: ssh-parallel-commands\n    type: bash\n    log: \"Running parallel commands on remote SSH server\"\n\n    parallel_commands:\n      - 'nmap -sS -p 80 {{Target}} > /tmp/port80.txt'\n      - 'nmap -sS -p 443 {{Target}} > /tmp/port443.txt'\n      - 'nmap -sS -p 22 {{Target}} > /tmp/port22.txt'\n\n  # ===========================================================================\n  # Run tool with structured arguments via SSH\n  # ===========================================================================\n  - name: ssh-nuclei-scan\n    type: bash\n    log: \"Running nuclei scan via SSH\"\n    timeout: 3600\n\n    command: nuclei\n    speed_args: '-rate-limit 50 -c {{threads}}'\n    config_args: '-t ~/nuclei-templates/cves/'\n    input_args: '-u {{Target}}'\n    output_args: '-o /home/scanner/workspace/nuclei-results.json -json'\n\n    step_remote_file: /home/scanner/workspace/nuclei-results.json\n    host_output_file: \"{{Output}}/nuclei-results.json\"\n\n    exports:\n      scan_results: \"{{Output}}/nuclei-results.json\"\n\n  # ===========================================================================\n  # Foreach loop with SSH execution\n  # Processes multiple targets on remote server\n  # ===========================================================================\n  - name: ssh-foreach-targets\n    type: foreach\n    log: \"Processing targets via SSH\"\n\n    # input: File containing targets (one per line)\n    input: \"{{Output}}/targets.txt\"\n\n    # variable: Loop variable accessed as [[variable]] in inner step\n    variable: current_target\n\n    # threads: Number of concurrent SSH executions\n    threads: 5\n\n    step:\n      name: probe-target\n      type: bash\n      # Inner step inherits workflow-level SSH runner\n      command: 'curl -s -o /dev/null -w \"%{http_code}\" \"[[current_target]]\" 2>/dev/null || echo \"failed\"'\n      exports:\n        probe_result: \"{{stdout}}\"\n\n  # ===========================================================================\n  # Step running on local host (override workflow's SSH runner)\n  # Useful for local processing of results retrieved from remote\n  # ===========================================================================\n  - name: process-results-locally\n    type: bash\n    log: \"Processing results on local host\"\n\n    # Override to run locally instead of via SSH\n    step_runner: host\n\n    command: 'cat \"{{Output}}/nuclei-results.json\" | jq -r \".info.severity\" | sort | uniq -c'\n\n    exports:\n      severity_summary: \"{{stdout}}\"\n\n  # ===========================================================================\n  # Function step (always runs locally, regardless of workflow runner)\n  # Note: Function steps execute on the host running osmedeus, not remote\n  # ===========================================================================\n  - name: log-completion\n    type: function\n    log: \"Logging scan completion\"\n    function: 'log_info(\"SSH scan completed for {{Target}}\")'\n\n  # ===========================================================================\n  # Cleanup step on remote server\n  # ===========================================================================\n  - name: cleanup-remote\n    type: bash\n    log: \"Cleaning up remote workspace\"\n    command: 'rm -rf /home/scanner/workspace/temp/* 2>/dev/null; echo \"Cleanup complete\"'\n\n    on_success:\n      - action: log\n        message: \"Remote cleanup completed successfully\"\n\n    on_error:\n      - action: continue\n        message: \"Cleanup failed but continuing workflow\"\n`,\n  \"all-step-types-example\": `# =============================================================================\n# Module Workflow: All Step Types Example\n# =============================================================================\n# This file demonstrates ALL fields available in a module-kind workflow,\n# showcasing every step type with comprehensive comments.\n# =============================================================================\n\n# -----------------------------------------------------------------------------\n# WORKFLOW-LEVEL FIELDS\n# -----------------------------------------------------------------------------\n\n# kind: Workflow type - either \"module\" (single unit with steps) or \"flow\" (orchestrates modules)\nkind: module\n\n# name: Unique identifier for this workflow (required)\nname: all-step-types-example\n\n# description: Human-readable description of what this workflow does\ndescription: Demonstrates all step types and their fields with detailed comments\n\n# tags: Comma-separated tags for filtering and categorization (parsed as []string)\ntags: example, comprehensive, demo\n\n# -----------------------------------------------------------------------------\n# PARAMS SECTION\n# Define workflow parameters that can be passed via CLI or referenced in templates\n# -----------------------------------------------------------------------------\nparams:\n  # name: Parameter identifier used in templates as {{param_name}}\n  # default: Default value if not provided via CLI\n  # required: If true, workflow fails without this value\n  # generator: Function to generate value, e.g., uuid(), currentDate(), getEnvVar(\"KEY\")\n  - name: message\n    default: \"Hello World\"\n    required: false\n\n  - name: output_dir\n    default: \"{{Output}}/results\"  # Can reference built-in variables\n    required: false\n\n  - name: threads\n    default: \"10\"\n    required: false\n\n  - name: run_id\n    generator: uuid()  # Generates a unique ID automatically\n\n# -----------------------------------------------------------------------------\n# DEPENDENCIES SECTION\n# Validate requirements before workflow execution\n# -----------------------------------------------------------------------------\ndependencies:\n  # commands: List of binaries/commands that must exist in PATH\n  commands:\n    - echo\n    - curl\n\n  # files: List of files/directories that must exist\n  files:\n    - /tmp\n\n  # variables: Define variable requirements with type validation\n  # Types: domain, path, number, file, string\n  variables:\n    - name: Target\n      type: string\n      required: true\n\n  # functions_conditions: JavaScript expressions that must evaluate to true\n  functions_conditions:\n    - '1 + 1 == 2'\n\n# -----------------------------------------------------------------------------\n# REPORTS SECTION\n# Define output files produced by this workflow\n# -----------------------------------------------------------------------------\nreports:\n  # name: Display name for the report\n  # path: File path (can use templates like {{Output}})\n  # type: Format type - text, csv, json, markdown, etc.\n  # description: Human-readable description\n  - name: main-output\n    path: \"{{Output}}/main-results.txt\"\n    type: text\n    description: Main output file from the workflow\n\n  - name: json-results\n    path: \"{{Output}}/results.json\"\n    type: json\n    description: Structured JSON output\n\n# -----------------------------------------------------------------------------\n# PREFERENCES SECTION (Optional)\n# Set CLI-like flags directly in the workflow. CLI flags always take precedence.\n# -----------------------------------------------------------------------------\npreferences:\n  # skip_workspace: Equivalent to --disable-workspace-creation\n  skip_workspace: false\n\n  # disable_notifications: Equivalent to --disable-notification\n  disable_notifications: true\n\n  # disable_logging: Equivalent to --disable-logging\n  disable_logging: false\n\n  # heuristics_check: Equivalent to --heuristics-check (none, basic, advanced)\n  heuristics_check: 'basic'\n\n  # ci_output_format: Equivalent to --ci-output-format\n  ci_output_format: false\n\n  # silent: Equivalent to --silent\n  silent: false\n\n  # repeat: Equivalent to --repeat\n  repeat: false\n\n  # repeat_wait_time: Equivalent to --repeat-wait-time (e.g., 30s, 1h, 2h30m)\n  repeat_wait_time: '60s'\n\n  # clean_up_workspace: Equivalent to --clean-up-workspace\n  clean_up_workspace: false\n\n# -----------------------------------------------------------------------------\n# STEPS SECTION\n# The ordered list of execution steps for this module\n# -----------------------------------------------------------------------------\nsteps:\n  # ===========================================================================\n  # STEP TYPE: bash\n  # Execute shell commands on the host (or configured runner)\n  # ===========================================================================\n  - name: bash-single-command\n    # type: Step type - bash, function, parallel-steps, foreach, remote-bash, http, llm\n    type: bash\n\n    # pre_condition: JavaScript expression - step only runs if this evaluates to true\n    pre_condition: 'true'\n\n    # log: Custom log message displayed when step starts (supports templates)\n    log: \"Executing single bash command for {{Target}}\"\n\n    # timeout: Maximum execution time in seconds (0 = no timeout)\n    timeout: 60\n\n    # command: Single command to execute\n    command: 'echo \"Processing target: {{Target}} with message: {{message}}\"'\n\n    # std_file: File path to save stdout/stderr output\n    std_file: \"{{Output}}/step1-output.txt\"\n\n    # exports: Variables to export for subsequent steps\n    # Key = variable name, Value = extraction pattern or literal value\n    exports:\n      step1_result: \"completed\"\n\n  # ---------------------------------------------------------------------------\n  # Bash step with multiple sequential commands\n  # ---------------------------------------------------------------------------\n  - name: bash-multiple-commands\n    type: bash\n    log: \"Running multiple sequential commands\"\n\n    # commands: List of commands executed sequentially\n    commands:\n      - 'echo \"First command\"'\n      - 'echo \"Second command\"'\n      - 'echo \"Third command\"'\n\n  # ---------------------------------------------------------------------------\n  # Bash step with parallel commands\n  # ---------------------------------------------------------------------------\n  - name: bash-parallel-commands\n    type: bash\n    log: \"Running commands in parallel\"\n\n    # parallel_commands: List of commands executed concurrently\n    parallel_commands:\n      - 'echo \"Parallel A\" && sleep 1'\n      - 'echo \"Parallel B\" && sleep 1'\n      - 'echo \"Parallel C\" && sleep 1'\n\n  # ---------------------------------------------------------------------------\n  # Bash step with structured arguments\n  # Arguments are joined in order: command + speed + config + input + output\n  # ---------------------------------------------------------------------------\n  - name: bash-structured-args\n    type: bash\n    log: \"Using structured argument fields\"\n\n    command: 'echo'\n\n    # speed_args: Performance-related arguments (e.g., thread count, rate limits)\n    speed_args: '-n'\n\n    # config_args: Configuration arguments (e.g., config file paths)\n    config_args: ''\n\n    # input_args: Input-related arguments (e.g., input file, target)\n    input_args: '\"Structured arguments test\"'\n\n    # output_args: Output-related arguments (e.g., output file, format)\n    output_args: ''\n\n  # ===========================================================================\n  # STEP TYPE: function\n  # Execute built-in utility functions via Otto JavaScript runtime\n  # ===========================================================================\n  - name: function-single\n    type: function\n    log: \"Executing single function\"\n\n    # function: Single function call (JavaScript expression)\n    function: 'log_info(\"Processing {{Target}} in function step\")'\n\n  # ---------------------------------------------------------------------------\n  # Function step with multiple sequential functions\n  # ---------------------------------------------------------------------------\n  - name: function-multiple\n    type: function\n    log: \"Executing multiple functions sequentially\"\n\n    # functions: List of functions executed sequentially\n    functions:\n      - 'log_info(\"Function 1\")'\n      - 'log_info(\"Function 2\")'\n      - 'log_info(\"Function 3\")'\n\n  # ---------------------------------------------------------------------------\n  # Function step with parallel functions\n  # ---------------------------------------------------------------------------\n  - name: function-parallel\n    type: function\n    log: \"Executing functions in parallel\"\n\n    # parallel_functions: List of functions executed concurrently\n    parallel_functions:\n      - 'log_info(\"Parallel Function A\")'\n      - 'log_info(\"Parallel Function B\")'\n      - 'log_info(\"Parallel Function C\")'\n\n  # ===========================================================================\n  # STEP TYPE: parallel-steps\n  # Execute multiple complete steps in parallel\n  # ===========================================================================\n  - name: parallel-step-container\n    type: parallel-steps\n    log: \"Running multiple steps in parallel\"\n\n    # parallel_steps: List of Step objects executed concurrently\n    parallel_steps:\n      - name: parallel-inner-1\n        type: bash\n        command: 'echo \"Inner parallel step 1\"'\n\n      - name: parallel-inner-2\n        type: function\n        function: 'log_info(\"Inner parallel step 2\")'\n\n      - name: parallel-inner-3\n        type: bash\n        command: 'echo \"Inner parallel step 3\"'\n\n  # ===========================================================================\n  # STEP TYPE: foreach\n  # Iterate over input lines, executing inner step for each\n  # ===========================================================================\n  - name: foreach-example\n    type: foreach\n    log: \"Iterating over items\"\n\n    # input: File path or direct content to iterate over (one item per line)\n    input: \"{{Output}}/items.txt\"\n\n    # variable: Name for the loop variable, accessed as [[variable]] in inner step\n    variable: item\n\n    # threads: Number of concurrent iterations (default: 1 = sequential)\n    threads: 5\n\n    # step: The inner step to execute for each item (single Step object)\n    step:\n      name: process-item\n      type: bash\n      command: 'echo \"Processing [[item]]\"'\n      exports:\n        processed_item: \"[[item]]\"\n\n  # ===========================================================================\n  # STEP TYPE: http\n  # Make HTTP requests to external APIs\n  # ===========================================================================\n  - name: http-request\n    type: http\n    log: \"Making HTTP request\"\n    timeout: 30\n\n    # url: Target URL for the request (required for http type)\n    url: \"https://httpbin.org/post\"\n\n    # method: HTTP method - GET, POST, PUT, DELETE, PATCH, etc.\n    method: POST\n\n    # headers: Map of HTTP headers to send\n    headers:\n      Content-Type: application/json\n      Authorization: \"Bearer {{api_token}}\"\n      X-Custom-Header: custom-value\n\n    # request_body: Request body content (typically JSON for POST/PUT)\n    request_body: |\n      {\n        \"target\": \"{{Target}}\",\n        \"message\": \"{{message}}\"\n      }\n\n    exports:\n      http_response: \"{{response.body}}\"\n\n  # ===========================================================================\n  # STEP TYPE: llm\n  # Make LLM API calls for AI-powered processing\n  # ===========================================================================\n  - name: llm-chat-completion\n    type: llm\n    log: \"Calling LLM for analysis\"\n    timeout: 120\n\n    # messages: Conversation messages for chat completion\n    # role: system, user, assistant, or tool\n    # content: Message text (can be string or multimodal array)\n    messages:\n      - role: system\n        content: \"You are a security analysis assistant.\"\n\n      - role: user\n        # content can be a simple string or complex multimodal content\n        content: \"Analyze this target: {{Target}}\"\n\n    # tools: Function tools available to the LLM\n    tools:\n      - type: function  # Currently only \"function\" type supported\n        function:\n          name: analyze_target\n          description: Analyzes a target for security vulnerabilities\n          # parameters: JSON Schema defining function parameters\n          parameters:\n            type: object\n            properties:\n              target:\n                type: string\n                description: The target to analyze\n              depth:\n                type: string\n                enum: [shallow, deep]\n            required:\n              - target\n\n    # tool_choice: How the model should choose tools\n    # Can be: \"auto\", \"none\", \"required\", or {\"type\": \"function\", \"function\": {\"name\": \"fn_name\"}}\n    tool_choice: auto\n\n    # llm_config: Step-level LLM configuration overrides\n    llm_config:\n      # provider: Specific provider to use (overrides rotation)\n      provider: openai\n\n      # model: Model override for this step\n      model: gpt-4\n\n      # Generation parameters\n      max_tokens: 1000\n      temperature: 0.7\n      top_p: 1.0\n\n      # Request settings\n      timeout: \"60s\"\n      max_retries: 3\n      stream: false\n\n      # response_format: Control output format\n      # type: \"text\", \"json_object\", or \"json_schema\"\n      response_format:\n        type: json_object\n\n    # extra_llm_parameters: Additional provider-specific parameters\n    extra_llm_parameters:\n      seed: 42\n      presence_penalty: 0.0\n\n    exports:\n      llm_analysis: \"{{response.content}}\"\n\n  # ---------------------------------------------------------------------------\n  # LLM step for embeddings\n  # ---------------------------------------------------------------------------\n  - name: llm-embedding\n    type: llm\n    log: \"Generating text embeddings\"\n\n    # is_embedding: Flag to indicate this is an embedding request\n    is_embedding: true\n\n    # embedding_input: List of texts to generate embeddings for\n    embedding_input:\n      - \"Security vulnerability in {{Target}}\"\n      - \"Network reconnaissance results\"\n      - \"Port scan findings\"\n\n    llm_config:\n      model: text-embedding-3-small\n\n    exports:\n      embeddings: \"{{response.embeddings}}\"\n\n  # ===========================================================================\n  # COMMON STEP FIELDS: on_success, on_error, decision\n  # These fields are available on ALL step types\n  # ===========================================================================\n  - name: step-with-handlers\n    type: bash\n    log: \"Step demonstrating success/error handlers and decision routing\"\n    command: 'echo \"Running step with all handler types\"'\n\n    # on_success: Actions to execute when step succeeds\n    on_success:\n      # action: Handler type - log, abort, continue, export, run, notify\n      - action: log\n        message: \"Step completed successfully for {{Target}}\"\n\n      - action: export\n        # name: Variable name to export\n        name: success_flag\n        # value: Value to export (can be string, number, or template)\n        value: \"true\"\n\n      - action: notify\n        # notify: Notification message\n        notify: \"Step succeeded for {{Target}}\"\n\n      - action: run\n        # type: Step type to run (bash or function)\n        type: bash\n        command: 'echo \"Running follow-up command\"'\n\n      - action: run\n        type: function\n        functions:\n          - 'log_info(\"Running follow-up function\")'\n\n    # on_error: Actions to execute when step fails\n    on_error:\n      - action: log\n        message: \"Step failed for {{Target}}\"\n        # condition: Only execute this action if condition evaluates to true\n        condition: 'true'\n\n      - action: notify\n        notify: \"Error in workflow for {{Target}}\"\n\n      # abort: Stops workflow execution immediately\n      - action: abort\n        message: \"Aborting due to critical failure\"\n        condition: 'false'  # Only abort under specific conditions\n\n      # continue: Allows workflow to continue despite error\n      - action: continue\n        message: \"Continuing despite error\"\n\n    # decision: Conditional routing to other steps or workflow end\n    decision:\n      # condition: JavaScript expression to evaluate\n      # next: Step name to jump to, or \"_end\" to finish workflow\n      - condition: '{{success_flag}} == \"true\"'\n        next: final-step\n\n      - condition: '{{success_flag}} != \"true\"'\n        next: _end  # Special value to end workflow\n\n  # ---------------------------------------------------------------------------\n  # Final step\n  # ---------------------------------------------------------------------------\n  - name: final-step\n    type: function\n    log: \"Final step - workflow complete\"\n    function: 'log_info(\"All step types demonstrated for {{Target}}\")'\n`,\n  \"mock-all-step-types-example\": `# =============================================================================\n# Module Workflow: All Step Types Example\n# =============================================================================\n# This file demonstrates ALL fields available in a module-kind workflow,\n# showcasing every step type with comprehensive comments.\n# =============================================================================\n\n# -----------------------------------------------------------------------------\n# WORKFLOW-LEVEL FIELDS\n# -----------------------------------------------------------------------------\n\n# kind: Workflow type - either \"module\" (single unit with steps) or \"flow\" (orchestrates modules)\nkind: module\n\n# name: Unique identifier for this workflow (required)\nname: mock-all-step-types-example\n\n# description: Human-readable description of what this workflow does\ndescription: Mock Demonstrates all step types and their fields with detailed comments\n\n# tags: Comma-separated tags for filtering and categorization (parsed as []string)\ntags: example, comprehensive, demo\n\n# -----------------------------------------------------------------------------\n# PARAMS SECTION\n# Define workflow parameters that can be passed via CLI or referenced in templates\n# -----------------------------------------------------------------------------\nparams:\n  - name: message\n    default: \"Hello World\"\n    required: false\n\n  - name: output_dir\n    default: \"{{Output}}/results\"\n    required: false\n\n  - name: threads\n    default: \"10\"\n    required: false\n\n  - name: run_id\n    generator: uuid()\n\n# -----------------------------------------------------------------------------\n# DEPENDENCIES SECTION\n# Validate requirements before workflow execution\n# -----------------------------------------------------------------------------\ndependencies:\n  commands:\n    - echo\n    - curl\n\n  files:\n    - /tmp\n\n  variables:\n    - name: Target\n      type: string\n      required: true\n\n  functions_conditions:\n    - '1 + 1 == 2'\n\n# -----------------------------------------------------------------------------\n# REPORTS SECTION\n# Define output files produced by this workflow\n# -----------------------------------------------------------------------------\nreports:\n  - name: main-output\n    path: \"{{Output}}/main-results.txt\"\n    type: text\n    description: Main output file from the workflow\n\n  - name: json-results\n    path: \"{{Output}}/results.json\"\n    type: json\n    description: Structured JSON output\n\n# -----------------------------------------------------------------------------\n# PREFERENCES SECTION (Optional)\n# Set CLI-like flags directly in the workflow. CLI flags always take precedence.\n# -----------------------------------------------------------------------------\npreferences:\n  skip_workspace: false\n  disable_notifications: true\n  disable_logging: false\n  heuristics_check: 'basic'\n  ci_output_format: false\n  silent: false\n  repeat: false\n  repeat_wait_time: '60s'\n  clean_up_workspace: false\n\n# -----------------------------------------------------------------------------\n# STEPS SECTION\n# The ordered list of execution steps for this module\n# -----------------------------------------------------------------------------\nsteps:\n  - name: bash-single-command\n    type: bash\n    pre_condition: 'true'\n    log: \"Executing single bash command for {{Target}}\"\n    timeout: 60\n    command: 'echo \"Processing target: {{Target}} with message: {{message}}\"'\n    std_file: \"{{Output}}/step1-output.txt\"\n    exports:\n      step1_result: \"completed\"\n\n  - name: bash-multiple-commands\n    type: bash\n    log: \"Running multiple sequential commands\"\n    commands:\n      - 'echo \"First command\"'\n      - 'echo \"Second command\"'\n      - 'echo \"Third command\"'\n\n  - name: bash-parallel-commands\n    type: bash\n    log: \"Running commands in parallel\"\n    parallel_commands:\n      - 'echo \"Parallel A\" && sleep 1'\n      - 'echo \"Parallel B\" && sleep 1'\n      - 'echo \"Parallel C\" && sleep 1'\n\n  - name: bash-structured-args\n    type: bash\n    log: \"Using structured argument fields\"\n    command: 'echo'\n    speed_args: '-n'\n    config_args: ''\n    input_args: '\"Structured arguments test\"'\n    output_args: ''\n\n  - name: function-single\n    type: function\n    log: \"Executing single function\"\n    function: 'log_info(\"Processing {{Target}} in function step\")'\n\n  - name: function-multiple\n    type: function\n    log: \"Executing multiple functions sequentially\"\n    functions:\n      - 'log_info(\"Function 1\")'\n      - 'log_info(\"Function 2\")'\n      - 'log_info(\"Function 3\")'\n\n  - name: function-parallel\n    type: function\n    log: \"Executing functions in parallel\"\n    parallel_functions:\n      - 'log_info(\"Parallel Function A\")'\n      - 'log_info(\"Parallel Function B\")'\n      - 'log_info(\"Parallel Function C\")'\n\n  - name: parallel-step-container\n    type: parallel-steps\n    log: \"Running multiple steps in parallel\"\n    parallel_steps:\n      - name: parallel-inner-1\n        type: bash\n        command: 'echo \"Inner parallel step 1\"'\n      - name: parallel-inner-2\n        type: function\n        function: 'log_info(\"Inner parallel step 2\")'\n      - name: parallel-inner-3\n        type: bash\n        command: 'echo \"Inner parallel step 3\"'\n\n  - name: foreach-example\n    type: foreach\n    log: \"Iterating over items\"\n    input: \"{{Output}}/items.txt\"\n    variable: item\n    threads: 5\n    step:\n      name: process-item\n      type: bash\n      command: 'echo \"Processing [[item]]\"'\n      exports:\n        processed_item: \"[[item]]\"\n\n  - name: http-request\n    type: http\n    log: \"Making HTTP request\"\n    timeout: 30\n    url: \"https://httpbin.org/post\"\n    method: POST\n    headers:\n      Content-Type: application/json\n      Authorization: \"Bearer {{api_token}}\"\n      X-Custom-Header: custom-value\n    request_body: |\n      {\n        \"target\": \"{{Target}}\",\n        \"message\": \"{{message}}\"\n      }\n    exports:\n      http_response: \"{{response.body}}\"\n\n  - name: llm-chat-completion\n    type: llm\n    log: \"Calling LLM for analysis\"\n    timeout: 120\n    messages:\n      - role: system\n        content: \"You are a security analysis assistant.\"\n      - role: user\n        content: \"Analyze this target: {{Target}}\"\n    tools:\n      - type: function\n        function:\n          name: analyze_target\n          description: Analyzes a target for security vulnerabilities\n          parameters:\n            type: object\n            properties:\n              target:\n                type: string\n                description: The target to analyze\n              depth:\n                type: string\n                enum: [shallow, deep]\n            required:\n              - target\n    tool_choice: auto\n    llm_config:\n      provider: openai\n      model: gpt-4\n      max_tokens: 1000\n      temperature: 0.7\n      top_p: 1.0\n      timeout: \"60s\"\n      max_retries: 3\n      stream: false\n      response_format:\n        type: json_object\n    extra_llm_parameters:\n      seed: 42\n      presence_penalty: 0.0\n    exports:\n      llm_analysis: \"{{response.content}}\"\n\n  - name: llm-embedding\n    type: llm\n    log: \"Generating text embeddings\"\n    is_embedding: true\n    embedding_input:\n      - \"Security vulnerability in {{Target}}\"\n      - \"Network reconnaissance results\"\n      - \"Port scan findings\"\n    llm_config:\n      model: text-embedding-3-small\n    exports:\n      embeddings: \"{{response.embeddings}}\"\n\n  - name: step-with-handlers\n    type: bash\n    log: \"Step demonstrating success/error handlers and decision routing\"\n    command: 'echo \"Running step with all handler types\"'\n    on_success:\n      - action: log\n        message: \"Step completed successfully for {{Target}}\"\n      - action: export\n        name: success_flag\n        value: \"true\"\n      - action: notify\n        notify: \"Step succeeded for {{Target}}\"\n      - action: run\n        type: bash\n        command: 'echo \"Running follow-up command\"'\n      - action: run\n        type: function\n        functions:\n          - 'log_info(\"Running follow-up function\")'\n    on_error:\n      - action: log\n        message: \"Step failed for {{Target}}\"\n        condition: 'true'\n      - action: notify\n        notify: \"Error in workflow for {{Target}}\"\n      - action: abort\n        message: \"Aborting due to critical failure\"\n        condition: 'false'\n      - action: continue\n        message: \"Continuing despite error\"\n    decision:\n      - condition: '{{success_flag}} == \"true\"'\n        next: final-step\n      - condition: '{{success_flag}} != \"true\"'\n        next: _end\n\n  - name: final-step\n    type: function\n    log: \"Final step - workflow complete\"\n    function: 'log_info(\"All step types demonstrated for {{Target}}\")'\n`,\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6259, "column": 0}, "map": {"version":3,"sources":["file:///Users/bytedance/Desktop/external/osmedeus-dashboard/lib/api/workflows.ts"],"sourcesContent":["import { http } from \"./http\";\nimport { API_PREFIX } from \"@/lib/api/prefix\";\nimport { isDemoMode, setDemoMode } from \"./demo-mode\";\nimport type { Workflow } from \"@/lib/types/workflow\";\nimport { MOCK_WORKFLOW_YAMLS } from \"@/lib/mock/workflow-yamls\";\nimport yaml from \"js-yaml\";\n\nfunction getCustomMockYamls(): Record<string, string> {\n  if (typeof window === \"undefined\") return {};\n  try {\n    const raw = window.localStorage.getItem(\"osmedeus_custom_workflows\");\n    if (!raw) return {};\n    const obj = JSON.parse(raw);\n    if (!obj || typeof obj !== \"object\") return {};\n    const out: Record<string, string> = {};\n    Object.entries(obj as Record<string, unknown>).forEach(([k, v]) => {\n      if (typeof v !== \"string\") return;\n      if (!v.trim()) return;\n      out[String(k)] = v;\n    });\n    return out;\n  } catch {\n    return {};\n  }\n}\n\nfunction getAllMockYamls(): Record<string, string> {\n  const custom = getCustomMockYamls();\n  return { ...MOCK_WORKFLOW_YAMLS, ...custom };\n}\n\ntype MockYamlEntry = { id: string; content: string; source: \"builtin\" | \"custom\" };\n\nfunction getMockYamlEntries(): MockYamlEntry[] {\n  const out: MockYamlEntry[] = [];\n  Object.entries(MOCK_WORKFLOW_YAMLS).forEach(([id, content]) => {\n    if (typeof content !== \"string\" || !content.trim()) return;\n    out.push({ id, content, source: \"builtin\" });\n  });\n  const custom = getCustomMockYamls();\n  Object.entries(custom).forEach(([id, content]) => {\n    if (typeof content !== \"string\" || !content.trim()) return;\n    out.push({ id, content, source: \"custom\" });\n  });\n  return out;\n}\n\nfunction resolveMockYamlContent(idOrName: string): string | null {\n  const all = getAllMockYamls();\n  const direct = all[idOrName];\n  if (typeof direct === \"string\" && direct.trim()) return direct;\n\n  const entries = getMockYamlEntries().slice().reverse();\n  for (const { id: fallbackId, content } of entries) {\n    let doc: any = {};\n    try {\n      doc = yaml.load(content) || {};\n    } catch {\n      doc = {};\n    }\n    const name = typeof doc?.name === \"string\" ? doc.name.trim() : \"\";\n    if (name && name === idOrName) return content;\n    if (fallbackId === idOrName) return content;\n  }\n\n  return null;\n}\n\nfunction getUniqueMockWorkflows(): Workflow[] {\n  const entries = getMockYamlEntries();\n  const byName = new Map<string, { wf: Workflow; source: \"builtin\" | \"custom\" }>();\n  const order: string[] = [];\n\n  entries.forEach(({ id, content, source }) => {\n    const wf = toWorkflowFromYaml(id, content);\n    const key = (wf.name || \"\").trim() || id;\n    const existing = byName.get(key);\n    if (!existing) {\n      byName.set(key, { wf, source });\n      order.push(key);\n      return;\n    }\n    if (existing.source === \"builtin\" && source === \"custom\") {\n      byName.set(key, { wf, source });\n    }\n  });\n\n  return order.map((k) => byName.get(k)!.wf);\n}\n\nfunction normalizeTags(raw: unknown): string[] {\n  if (Array.isArray(raw)) {\n    return raw\n      .filter((t): t is string => typeof t === \"string\")\n      .map((t) => t.trim())\n      .filter(Boolean);\n  }\n\n  if (typeof raw === \"string\") {\n    return raw\n      .split(\",\")\n      .map((t) => t.trim())\n      .filter(Boolean);\n  }\n\n  return [];\n}\n\nfunction addMockDataTag(tags: string[]): string[] {\n  const set = new Set(tags);\n  set.add(\"mock-data\");\n  return Array.from(set);\n}\n\nfunction getHttpErrorCode(e: unknown): number {\n  const msg = e instanceof Error ? e.message : \"\";\n  const code = parseInt((msg.split(\":\")[0] || \"0\") as string, 10);\n  return Number.isFinite(code) ? code : 0;\n}\n\nfunction enableDemoMode(): void {\n  if (typeof window !== \"undefined\") {\n    setDemoMode(true);\n  }\n}\n\nfunction toWorkflowFromYaml(id: string, content: string): Workflow {\n  let doc: any = {};\n  try {\n    doc = yaml.load(content) || {};\n  } catch {\n    doc = {};\n  }\n  const steps = Array.isArray(doc?.steps) ? doc.steps : [];\n  const modules = Array.isArray(doc?.modules) ? doc.modules : [];\n  const kind: \"module\" | \"flow\" = doc?.kind === \"flow\" ? \"flow\" : \"module\";\n  const name = typeof doc?.name === \"string\" ? (doc.name as string) : id;\n  const description = typeof doc?.description === \"string\" ? (doc.description as string) : \"\";\n  const tags = addMockDataTag(normalizeTags(doc?.tags));\n  const params = Array.isArray(doc?.params) ? doc.params : [];\n  return {\n    name,\n    kind,\n    description,\n    tags,\n    file_path: \"\",\n    params,\n    required_params: params.filter((p: any) => p?.required).map((p: any) => p?.name ?? \"\"),\n    step_count: steps.length,\n    module_count: modules.length,\n    checksum: \"\",\n    indexed_at: new Date().toISOString(),\n  };\n}\n\nfunction getMockWorkflowTags(): string[] {\n  const tagSet = new Set<string>();\n  Object.values(getAllMockYamls()).forEach((content) => {\n    try {\n      const doc: any = yaml.load(content) || {};\n      normalizeTags(doc?.tags).forEach((t) => tagSet.add(t));\n    } catch {}\n  });\n  tagSet.add(\"mock-data\");\n  return Array.from(tagSet.values()).sort();\n}\n\n/**\n * Fetch all workflows\n */\nexport async function fetchWorkflows(): Promise<Workflow[]> {\n  if (isDemoMode()) {\n    return getUniqueMockWorkflows();\n  }\n  const res = await http.get(`${API_PREFIX}/workflows`);\n  const data = (res.data?.data || []) as Array<any>;\n  return data.map((w) => ({\n    name: w.name ?? \"\",\n    kind: w.kind === \"flow\" ? \"flow\" : \"module\",\n    description: w.description ?? \"\",\n    tags: Array.isArray(w.tags) ? w.tags : [],\n    file_path: w.file_path ?? \"\",\n    params: Array.isArray(w.params) ? w.params : [],\n    required_params: Array.isArray(w.required_params) ? w.required_params : [],\n    step_count: w.step_count ?? 0,\n    module_count: w.module_count ?? 0,\n    checksum: w.checksum ?? \"\",\n    indexed_at: w.indexed_at ?? \"\",\n  }));\n}\n\nexport interface FetchWorkflowsParams {\n  source?: \"db\" | \"filesystem\";\n  tags?: string[];\n  kind?: \"module\" | \"flow\";\n  search?: string;\n  offset?: number;\n  limit?: number;\n}\n\nexport interface WorkflowListResult {\n  items: Workflow[];\n  pagination: {\n    total: number;\n    offset: number;\n    limit: number;\n  };\n}\n\nexport async function fetchMockWorkflowsList(params: FetchWorkflowsParams = {}): Promise<WorkflowListResult> {\n  const all = getUniqueMockWorkflows();\n\n  const filtered = all.filter((wf) => {\n    if (params.kind && wf.kind !== params.kind) return false;\n    if (params.tags && params.tags.length > 0) {\n      const tagSet = new Set((wf.tags || []).map((t) => String(t)));\n      if (!params.tags.some((t) => tagSet.has(t))) return false;\n    }\n    if (params.search && params.search.trim()) {\n      const q = params.search.trim().toLowerCase();\n      const hay = `${wf.name ?? \"\"} ${wf.description ?? \"\"} ${(wf.tags || []).join(\" \")}`.toLowerCase();\n      if (!hay.includes(q)) return false;\n    }\n    return true;\n  });\n\n  const offset = typeof params.offset === \"number\" ? params.offset : 0;\n  const limit = typeof params.limit === \"number\" ? params.limit : filtered.length;\n  const paged = filtered.slice(Math.max(0, offset), Math.max(0, offset) + Math.max(0, limit));\n\n  return {\n    items: paged,\n    pagination: {\n      total: filtered.length,\n      offset,\n      limit,\n    },\n  };\n}\n\nexport async function fetchWorkflowsList(params: FetchWorkflowsParams = {}): Promise<WorkflowListResult> {\n  if (isDemoMode()) {\n    const items = await fetchWorkflows();\n\n    const filtered = items.filter((wf) => {\n      if (params.kind && wf.kind !== params.kind) return false;\n      if (params.tags && params.tags.length > 0) {\n        const tagSet = new Set((wf.tags || []).map((t) => String(t)));\n        if (!params.tags.some((t) => tagSet.has(t))) return false;\n      }\n      if (params.search && params.search.trim()) {\n        const q = params.search.trim().toLowerCase();\n        const hay = `${wf.name ?? \"\"} ${wf.description ?? \"\"} ${(wf.tags || []).join(\" \")}`.toLowerCase();\n        if (!hay.includes(q)) return false;\n      }\n      return true;\n    });\n\n    const offset = typeof params.offset === \"number\" ? params.offset : 0;\n    const limit = typeof params.limit === \"number\" ? params.limit : filtered.length;\n    const paged = filtered.slice(Math.max(0, offset), Math.max(0, offset) + Math.max(0, limit));\n    return {\n      items: paged,\n      pagination: { total: filtered.length, offset, limit },\n    };\n  }\n  const query: Record<string, string | number | boolean> = {};\n  if (params.source) query.source = params.source;\n  if (params.tags && params.tags.length > 0) query.tags = params.tags.join(\",\");\n  if (params.kind) query.kind = params.kind;\n  if (params.search) query.search = params.search;\n  if (typeof params.offset === \"number\") query.offset = params.offset;\n  if (typeof params.limit === \"number\") query.limit = params.limit;\n  try {\n    const res = await http.get(`${API_PREFIX}/workflows`, { params: query });\n    const data = (res.data?.data || []) as Array<any>;\n    const pagination = res.data?.pagination || { total: data.length, offset: 0, limit: data.length };\n    const items: Workflow[] = data.map((w) => ({\n      name: w.name ?? \"\",\n      kind: w.kind === \"flow\" ? \"flow\" : \"module\",\n      description: w.description ?? \"\",\n      tags: Array.isArray(w.tags) ? w.tags.map((t: any) => String(t)) : [],\n      file_path: w.file_path ?? \"\",\n      params: Array.isArray(w.params) ? w.params : [],\n      required_params: Array.isArray(w.required_params) ? w.required_params : [],\n      step_count: w.step_count ?? 0,\n      module_count: w.module_count ?? 0,\n      checksum: w.checksum ?? \"\",\n      indexed_at: w.indexed_at ?? \"\",\n    }));\n    return {\n      items,\n      pagination: {\n        total: Number(pagination.total) || items.length,\n        offset: Number(pagination.offset) || 0,\n        limit: Number(pagination.limit) || items.length,\n      },\n    };\n  } catch (e) {\n    const code = getHttpErrorCode(e);\n    if (code === 0) {\n      enableDemoMode();\n      return fetchMockWorkflowsList({\n        kind: params.kind,\n        tags: params.tags,\n        search: params.search,\n        offset: params.offset,\n        limit: params.limit,\n      });\n    }\n    throw e;\n  }\n}\n\n/**\n * Fetch a single workflow by ID\n */\nexport async function fetchWorkflow(id: string): Promise<Workflow | null> {\n  if (isDemoMode()) {\n    const content = resolveMockYamlContent(id);\n    if (!content) return null;\n    return toWorkflowFromYaml(id, content);\n  }\n  try {\n    const res = await http.get(`${API_PREFIX}/workflows/${encodeURIComponent(id)}`, {\n      params: { json: true },\n    });\n    const w = res.data;\n    return {\n      name: w.name ?? \"\",\n      kind: w.kind === \"flow\" ? \"flow\" : \"module\",\n      description: w.description ?? \"\",\n      tags: Array.isArray(w.tags) ? w.tags : [],\n      file_path: w.file_path ?? \"\",\n      params: Array.isArray(w.params) ? w.params : [],\n      required_params: Array.isArray(w.required_params) ? w.required_params : [],\n      step_count: Array.isArray(w.steps) ? w.steps.length : w.step_count ?? 0,\n      module_count: w.module_count ?? 0,\n      checksum: w.checksum ?? \"\",\n      indexed_at: w.indexed_at ?? \"\",\n    };\n  } catch (e: any) {\n    const code = getHttpErrorCode(e);\n    if (code === 404) throw new Error(\"WORKFLOW_NOT_FOUND\");\n    if (code === 401) throw new Error(\"UNAUTHORIZED\");\n    if (code === 0) {\n      enableDemoMode();\n      const content = resolveMockYamlContent(id);\n      return content ? toWorkflowFromYaml(id, content) : null;\n    }\n    throw new Error(\"REQUEST_FAILED\");\n  }\n}\n\n/**\n * Fetch workflow YAML content\n */\nexport async function fetchWorkflowYaml(id: string): Promise<string | null> {\n  if (isDemoMode()) {\n    return resolveMockYamlContent(id);\n  }\n  try {\n    const res = await http.get(`${API_PREFIX}/workflows/${encodeURIComponent(id)}`, {\n      responseType: \"text\",\n    });\n    return typeof res.data === \"string\" ? res.data : (res.data?.yaml ?? null);\n  } catch (e: any) {\n    const code = getHttpErrorCode(e);\n    if (code === 404) throw new Error(\"WORKFLOW_NOT_FOUND\");\n    if (code === 401) throw new Error(\"UNAUTHORIZED\");\n    if (code === 0) {\n      enableDemoMode();\n      return resolveMockYamlContent(id);\n    }\n    throw new Error(\"REQUEST_FAILED\");\n  }\n}\n\nexport async function fetchWorkflowTags(): Promise<string[]> {\n  if (isDemoMode()) {\n    return getMockWorkflowTags();\n  }\n  try {\n    const res = await http.get(`${API_PREFIX}/workflows/tags`);\n    const tags = res.data?.tags || [];\n    return Array.isArray(tags) ? tags.map((t: any) => String(t)) : [];\n  } catch (e) {\n    const code = getHttpErrorCode(e);\n    if (code === 0) {\n      enableDemoMode();\n      return getMockWorkflowTags();\n    }\n    throw e;\n  }\n}\n\nexport async function refreshWorkflowIndex(force = false): Promise<{\n  message: string;\n  added: number;\n  updated: number;\n  removed: number;\n  errors: unknown[];\n}> {\n  const res = await http.post(`${API_PREFIX}/workflows/refresh`, undefined, {\n    params: force ? { force: true } : {},\n  });\n  return {\n    message: res.data?.message || \"\",\n    added: Number(res.data?.added || 0),\n    updated: Number(res.data?.updated || 0),\n    removed: Number(res.data?.removed || 0),\n    errors: Array.isArray(res.data?.errors) ? res.data.errors : [],\n  };\n}\n\n/**\n * Save workflow YAML content\n */\nexport async function saveWorkflowYaml(\n  id: string,\n  yamlText: string\n): Promise<boolean> {\n  if (!id || !yamlText.trim()) return false;\n\n  if (isDemoMode()) {\n    if (typeof window === \"undefined\") return false;\n    try {\n      const raw = window.localStorage.getItem(\"osmedeus_custom_workflows\");\n      const obj = raw ? JSON.parse(raw) : {};\n      const next = obj && typeof obj === \"object\" ? (obj as Record<string, unknown>) : {};\n      next[id] = yamlText;\n      window.localStorage.setItem(\"osmedeus_custom_workflows\", JSON.stringify(next));\n      return true;\n    } catch {\n      return false;\n    }\n  }\n\n  try {\n    if (typeof window === \"undefined\") return false;\n    let name = id;\n    let kind = \"module\";\n    try {\n      const doc: any = yaml.load(yamlText) || {};\n      if (typeof doc?.name === \"string\" && doc.name.trim()) name = doc.name.trim();\n      if (doc?.kind === \"flow\") kind = \"flow\";\n    } catch {\n    }\n\n    const form = new FormData();\n    const fileName = `${name || id}.yaml`;\n    const blob = new Blob([yamlText], { type: \"text/yaml\" });\n    form.append(\"file\", blob, fileName);\n\n    await http.post(`${API_PREFIX}/workflow-upload`, form, {\n      headers: { \"Content-Type\": \"multipart/form-data\" },\n      params: { kind },\n    });\n    return true;\n  } catch (e: any) {\n    const code = getHttpErrorCode(e);\n    if (code === 0) {\n      setDemoMode(true);\n      return saveWorkflowYaml(id, yamlText);\n    }\n    return false;\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6716, "column": 0}, "map": {"version":3,"sources":["file:///Users/bytedance/Desktop/external/osmedeus-dashboard/components/workflow-editor/workflow-editor-client.tsx"],"sourcesContent":["\"use client\";\n\nimport * as React from \"react\";\nimport Link from \"next/link\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { WorkflowCanvas } from \"@/components/workflow-editor/workflow-canvas\";\nimport { WorkflowSidebar } from \"@/components/workflow-editor/workflow-sidebar\";\nimport {\n  parseWorkflowYaml,\n  serializeWorkflowToYaml,\n  updateStepInWorkflow,\n  type ParsedWorkflow,\n} from \"@/components/workflow-editor/utils/yaml-parser\";\nimport { ErrorState } from \"@/components/shared/error-state\";\nimport { fetchWorkflow, fetchWorkflowYaml, saveWorkflowYaml } from \"@/lib/api/workflows\";\nimport { getHttpBaseURL } from \"@/lib/api/http\";\nimport { usePathname } from \"next/navigation\";\nimport type { Workflow, WorkflowStep, WorkflowYaml, WorkflowFlowModule, ModuleWorkflowYaml, FlowWorkflowYaml } from \"@/lib/types/workflow\";\nimport { toast } from \"sonner\";\nimport { ArrowLeftIcon, LoaderIcon, ArrowUpDownIcon, ArrowLeftRightIcon, ClipboardIcon, AlignJustifyIcon, MapIcon, SaveIcon, EyeIcon } from \"lucide-react\";\n\ninterface WorkflowEditorClientProps {\n  workflowId: string;\n}\n\nexport default function WorkflowEditorClient({ workflowId }: WorkflowEditorClientProps) {\n  const pathname = usePathname();\n  const splitRef = React.useRef<HTMLDivElement | null>(null);\n  const canvasApiRef = React.useRef<{ focusNode: (nodeId: string) => void } | null>(null);\n  const pendingFocusIdRef = React.useRef<string | null>(null);\n  const effectiveId = React.useMemo(() => {\n    if (workflowId && workflowId.length > 0) return workflowId;\n    const seg = pathname?.split(\"/\").filter(Boolean).pop() || \"\";\n    return decodeURIComponent(seg);\n  }, [workflowId, pathname]);\n  const [workflow, setWorkflow] = React.useState<Workflow | null>(null);\n  const [parsedWorkflow, setParsedWorkflow] = React.useState<ParsedWorkflow | null>(null);\n  const [workflowData, setWorkflowData] = React.useState<WorkflowYaml | null>(null);\n  const [yamlPreview, setYamlPreview] = React.useState(\"\");\n  const [isLoading, setIsLoading] = React.useState(true);\n  const [isSaving, setIsSaving] = React.useState(false);\n  const [error, setError] = React.useState<string | null>(null);\n  const [selectedStepName, setSelectedStepName] = React.useState<string | null>(null);\n  const [orientation, setOrientation] = React.useState<\"TB\" | \"LR\">(\"TB\");\n  const baseURL = getHttpBaseURL();\n  const [sidebarWidth, setSidebarWidth] = React.useState<number>(320);\n  const [wrapCanvasText, setWrapCanvasText] = React.useState<boolean>(true);\n  const [showCanvasDetails, setShowCanvasDetails] = React.useState<boolean>(true);\n  const [hideMiniMap, setHideMiniMap] = React.useState<boolean>(true);\n\n  const toolbarButtonClassName =\n    \"border-sky-400 text-sky-700 hover:bg-sky-500/10 dark:border-sky-300 dark:text-sky-200 dark:hover:bg-sky-300/15\";\n\n  React.useEffect(() => {\n    if (typeof window === \"undefined\") return;\n    const raw = window.localStorage.getItem(\"osmedeus_workflow_sidebar_width\");\n    const n = raw ? Number(raw) : NaN;\n    if (Number.isFinite(n) && n > 0) setSidebarWidth(n);\n  }, []);\n\n  React.useEffect(() => {\n    if (typeof window === \"undefined\") return;\n    const raw = window.localStorage.getItem(\"osmedeus_workflow_canvas_wrap\");\n    if (raw === null) return;\n    setWrapCanvasText(raw === \"1\");\n  }, []);\n\n  React.useEffect(() => {\n    if (typeof window === \"undefined\") return;\n    const raw = window.localStorage.getItem(\"osmedeus_workflow_canvas_details\");\n    if (raw === null) return;\n    setShowCanvasDetails(raw === \"1\");\n  }, []);\n\n  React.useEffect(() => {\n    if (typeof window === \"undefined\") return;\n    const raw = window.localStorage.getItem(\"osmedeus_workflow_canvas_hide_minimap\");\n    if (raw === null) return;\n    setHideMiniMap(raw === \"1\");\n  }, []);\n\n  React.useEffect(() => {\n    if (typeof window === \"undefined\") return;\n    window.localStorage.setItem(\"osmedeus_workflow_sidebar_width\", String(sidebarWidth));\n  }, [sidebarWidth]);\n\n  React.useEffect(() => {\n    if (typeof window === \"undefined\") return;\n    window.localStorage.setItem(\"osmedeus_workflow_canvas_wrap\", wrapCanvasText ? \"1\" : \"0\");\n  }, [wrapCanvasText]);\n\n  React.useEffect(() => {\n    if (typeof window === \"undefined\") return;\n    window.localStorage.setItem(\"osmedeus_workflow_canvas_details\", showCanvasDetails ? \"1\" : \"0\");\n  }, [showCanvasDetails]);\n\n  React.useEffect(() => {\n    if (typeof window === \"undefined\") return;\n    window.localStorage.setItem(\"osmedeus_workflow_canvas_hide_minimap\", hideMiniMap ? \"1\" : \"0\");\n  }, [hideMiniMap]);\n\n  const loadWorkflow = React.useCallback(async () => {\n    try {\n      setIsLoading(true);\n      setError(null);\n\n      const [wf, yaml] = await Promise.all([\n        fetchWorkflow(effectiveId),\n        fetchWorkflowYaml(effectiveId),\n      ]);\n\n      if (!wf || !yaml) {\n        setError(`Workflow not found: ${effectiveId}`);\n        return;\n      }\n\n      setWorkflow(wf);\n      const parsed = parseWorkflowYaml(yaml);\n      setParsedWorkflow(parsed);\n      setWorkflowData(parsed.raw);\n      setYamlPreview(yaml);\n    } catch (err) {\n      const msg = err instanceof Error ? err.message : \"\";\n      if (msg === \"WORKFLOW_NOT_FOUND\") {\n        setError(`Workflow not found: ${effectiveId}`);\n      } else if (msg === \"NETWORK_ERROR\") {\n        setError(`Cannot reach API at ${baseURL}`);\n      } else if (msg === \"UNAUTHORIZED\") {\n        setError(\"Session expired. Please log in.\");\n      } else {\n        setError(\"Failed to load workflow\");\n      }\n    } finally {\n      setIsLoading(false);\n    }\n  }, [effectiveId]);\n\n  React.useEffect(() => {\n    loadWorkflow();\n  }, [loadWorkflow]);\n\n  const selectedStep = React.useMemo(() => {\n    if (!selectedStepName || !workflowData) return null;\n    if (workflowData.kind !== \"module\") return null;\n    return (workflowData as ModuleWorkflowYaml).steps.find((s) => s.name === selectedStepName) ?? null;\n  }, [selectedStepName, workflowData]);\n\n  const selectedModule = React.useMemo(() => {\n    if (!selectedStepName || !workflowData) return null;\n    if (workflowData.kind !== \"flow\") return null;\n    const modules = (workflowData as FlowWorkflowYaml).modules;\n    if (!Array.isArray(modules)) return null;\n    return (modules as WorkflowFlowModule[]).find((m) => m.name === selectedStepName) ?? null;\n  }, [selectedStepName, workflowData]);\n\n  const allSteps = React.useMemo(() => {\n    if (!workflowData || workflowData.kind !== \"module\") return [] as WorkflowStep[];\n    return (workflowData as ModuleWorkflowYaml).steps ?? [];\n  }, [workflowData]);\n\n  const allModules = React.useMemo(() => {\n    if (!workflowData || workflowData.kind !== \"flow\") return [] as WorkflowFlowModule[];\n    return ((workflowData as FlowWorkflowYaml).modules ?? []) as WorkflowFlowModule[];\n  }, [workflowData]);\n\n  const handleNavigateToNode = React.useCallback((nodeId: string) => {\n    pendingFocusIdRef.current = nodeId;\n    setSelectedStepName(nodeId);\n    requestAnimationFrame(() => {\n      canvasApiRef.current?.focusNode(nodeId);\n    });\n  }, []);\n\n  React.useEffect(() => {\n    const id = pendingFocusIdRef.current;\n    if (!id) return;\n    if (id !== selectedStepName) return;\n    pendingFocusIdRef.current = null;\n    requestAnimationFrame(() => {\n      requestAnimationFrame(() => {\n        canvasApiRef.current?.focusNode(id);\n      });\n    });\n  }, [selectedStepName]);\n\n  const handleNodeSelect = React.useCallback((nodeId: string | null) => {\n    if (!nodeId || nodeId === \"_start\" || nodeId === \"_end\") {\n      setSelectedStepName(null);\n    } else {\n      setSelectedStepName(nodeId);\n    }\n  }, []);\n\n  const handleStepUpdate = React.useCallback(\n    (stepName: string, updates: Partial<WorkflowStep>) => {\n      if (!workflowData) return;\n      if (workflowData.kind !== \"module\") return;\n\n      const updatedWorkflow = updateStepInWorkflow(workflowData as ModuleWorkflowYaml, stepName, updates);\n      setWorkflowData(updatedWorkflow);\n\n      const newYaml = serializeWorkflowToYaml(updatedWorkflow);\n      setYamlPreview(newYaml);\n\n      const parsed = parseWorkflowYaml(newYaml);\n      setParsedWorkflow(parsed);\n    },\n    [workflowData]\n  );\n\n  if (error) {\n    return (\n      <div className=\"flex h-[calc(100vh-10rem)] items-center justify-center\">\n        <div className=\"space-y-4 text-center\">\n          <ErrorState title=\"Workflow Error\" message={error} onRetry={loadWorkflow} />\n          <div className=\"flex items-center justify-center gap-2\">\n            <Button variant=\"outline\" asChild>\n              <Link href=\"/workflows\">Back to Workflows</Link>\n            </Button>\n            <Button variant=\"outline\" asChild>\n              <Link href=\"/settings\">Settings</Link>\n            </Button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"flex h-[calc(100vh-7rem)] flex-col\">\n      <div className=\"flex items-center justify-between border-b px-4 py-3\">\n        <div className=\"flex items-center gap-4\">\n          <Button variant=\"outline\" size=\"icon\" asChild>\n            <Link href=\"/workflows\">\n              <ArrowLeftIcon className=\"size-4\" />\n              <span className=\"sr-only\">Back to workflows</span>\n            </Link>\n          </Button>\n          <div>\n            {isLoading ? (\n              <div className=\"space-y-1\">\n                <Skeleton className=\"h-6 w-40\" />\n                <Skeleton className=\"h-4 w-24\" />\n              </div>\n            ) : workflow ? (\n              <>\n                <div className=\"flex items-center gap-2\">\n                  <h1 className=\"text-lg font-semibold\">{workflow.name}</h1>\n                  <Badge variant=\"secondary\" className=\"capitalize\">\n                    {workflow.kind}\n                  </Badge>\n                </div>\n                <p className=\"text-sm text-muted-foreground\">\n                  {workflow.description}\n                </p>\n              </>\n            ) : null}\n          </div>\n        </div>\n\n        <div className=\"flex items-center gap-2\">\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={() => setOrientation((prev) => (prev === \"TB\" ? \"LR\" : \"TB\"))}\n            className={toolbarButtonClassName}\n          >\n            {orientation === \"TB\" ? (\n              <ArrowUpDownIcon className=\"mr-2 size-4\" />\n            ) : (\n              <ArrowLeftRightIcon className=\"mr-2 size-4\" />\n            )}\n            {orientation === \"TB\" ? \"Vertical\" : \"Horizontal\"}\n          </Button>\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={() => setWrapCanvasText((v) => !v)}\n            className={toolbarButtonClassName}\n          >\n            <AlignJustifyIcon className=\"mr-2 size-4\" />\n            {wrapCanvasText ? \"Wrap lines on\" : \"Wrap lines off\"}\n          </Button>\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={() => setShowCanvasDetails((v) => !v)}\n            className={toolbarButtonClassName}\n          >\n            <EyeIcon className=\"mr-2 size-4\" />\n            {showCanvasDetails ? \"Details on\" : \"Details off\"}\n          </Button>\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={() => setHideMiniMap((v) => !v)}\n            className={toolbarButtonClassName}\n          >\n            <MapIcon className=\"mr-2 size-4\" />\n            {hideMiniMap ? \"Minimap off\" : \"Minimap on\"}\n          </Button>\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            disabled={!yamlPreview}\n            onClick={async () => {\n              try {\n                await navigator.clipboard.writeText(yamlPreview);\n                toast.success(\"Copied to clipboard\");\n              } catch {\n                toast.error(\"Failed to copy\");\n              }\n            }}\n          >\n            <ClipboardIcon className=\"mr-2 size-4\" />\n            Copy YAML\n          </Button>\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            disabled={!yamlPreview || isSaving || isLoading}\n            onClick={async () => {\n              if (!yamlPreview) return;\n              setIsSaving(true);\n              try {\n                const ok = await saveWorkflowYaml(effectiveId, yamlPreview);\n                if (ok) {\n                  toast.success(\"Saved\");\n                } else {\n                  toast.error(\"Save failed\");\n                }\n              } catch {\n                toast.error(\"Save failed\");\n              } finally {\n                setIsSaving(false);\n              }\n            }}\n          >\n            <SaveIcon className=\"mr-2 size-4\" />\n            {isSaving ? \"Saving...\" : \"Save\"}\n          </Button>\n        </div>\n      </div>\n\n      <div ref={splitRef} className=\"flex flex-1 overflow-hidden\">\n        <div className=\"flex-1\">\n          {isLoading ? (\n            <div className=\"flex h-full items-center justify-center\">\n              <div className=\"flex flex-col items-center gap-4\">\n                <LoaderIcon className=\"size-8 animate-spin text-muted-foreground\" />\n                <p className=\"text-sm text-muted-foreground\">Loading workflow...</p>\n              </div>\n            </div>\n          ) : parsedWorkflow ? (\n            <WorkflowCanvas\n              initialNodes={parsedWorkflow.nodes}\n              initialEdges={parsedWorkflow.edges}\n              onNodeSelect={handleNodeSelect}\n              orientation={orientation}\n              wrapLongText={wrapCanvasText}\n              showDetails={showCanvasDetails}\n              hideMiniMap={hideMiniMap}\n              selectedNodeId={selectedStepName}\n              onCanvasReady={(api) => {\n                canvasApiRef.current = api;\n                if (pendingFocusIdRef.current) {\n                  api.focusNode(pendingFocusIdRef.current);\n                }\n              }}\n            />\n          ) : null}\n        </div>\n\n        <div\n          role=\"separator\"\n          aria-orientation=\"vertical\"\n          tabIndex={0}\n          className=\"w-1 cursor-col-resize bg-border/60 hover:bg-border focus:outline-none focus-visible:ring-2 focus-visible:ring-ring\"\n          onPointerDown={(e) => {\n            const startX = e.clientX;\n            const startWidth = sidebarWidth;\n            (e.currentTarget as HTMLDivElement).setPointerCapture(e.pointerId);\n\n            const handleMove = (ev: PointerEvent) => {\n              const rect = splitRef.current?.getBoundingClientRect();\n              const containerWidth = rect?.width ?? 0;\n              const deltaX = ev.clientX - startX;\n              const maxWidth = Math.max(260, containerWidth - 200);\n              const next = Math.min(maxWidth, Math.max(260, startWidth - deltaX));\n              setSidebarWidth(next);\n            };\n\n            const handleUp = (ev: PointerEvent) => {\n              window.removeEventListener(\"pointermove\", handleMove);\n              window.removeEventListener(\"pointerup\", handleUp);\n            };\n\n            window.addEventListener(\"pointermove\", handleMove);\n            window.addEventListener(\"pointerup\", handleUp);\n          }}\n          onKeyDown={(e) => {\n            const step = e.shiftKey ? 40 : 20;\n            if (e.key === \"ArrowLeft\") setSidebarWidth((w) => Math.min(w + step, 900));\n            if (e.key === \"ArrowRight\") setSidebarWidth((w) => Math.max(260, w - step));\n          }}\n        />\n\n        <div className=\"shrink-0\" style={{ width: sidebarWidth }}>\n          <WorkflowSidebar\n            selectedStep={selectedStep}\n            selectedModule={selectedModule}\n            yamlPreview={yamlPreview}\n            wrapLongText={wrapCanvasText}\n            onStepUpdate={handleStepUpdate}\n            workflowKind={workflowData?.kind ?? null}\n            allSteps={allSteps}\n            allModules={allModules}\n            onNavigateToNode={handleNavigateToNode}\n          />\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}