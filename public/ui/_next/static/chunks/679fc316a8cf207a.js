(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,31447,e=>{"use strict";let s=(0,e.i(75254).default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);e.s(["ClockIcon",()=>s],31447)},65476,e=>{"use strict";let s=(0,e.i(75254).default)("refresh-ccw",[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]]);e.s(["RefreshCcwIcon",()=>s],65476)},30374,e=>{"use strict";var s=e.i(43476),t=e.i(26999),a=e.i(95926),n=e.i(47163);function l({...e}){return(0,s.jsx)(t.Root,{"data-slot":"dialog",...e})}function i({...e}){return(0,s.jsx)(t.Trigger,{"data-slot":"dialog-trigger",...e})}function r({...e}){return(0,s.jsx)(t.Portal,{"data-slot":"dialog-portal",...e})}function c({className:e,...a}){return(0,s.jsx)(t.Overlay,{"data-slot":"dialog-overlay",className:(0,n.cn)("fixed inset-0 z-50 bg-black/40 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...a})}function d({className:e,children:l,...i}){return(0,s.jsxs)(r,{children:[(0,s.jsx)(c,{}),(0,s.jsxs)(t.Content,{"data-slot":"dialog-content",className:(0,n.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background/95 backdrop-blur-md p-6 shadow-[0_0_40px_rgba(32,178,170,0.1)] duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 sm:max-w-lg sm:rounded-xl",e),...i,children:[l,(0,s.jsxs)(t.Close,{className:"absolute right-4 top-4 rounded-xs opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,s.jsx)(a.XIcon,{className:"size-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function o({className:e,...t}){return(0,s.jsx)("div",{"data-slot":"dialog-header",className:(0,n.cn)("flex flex-col gap-2 text-center sm:text-left",e),...t})}function x({className:e,...t}){return(0,s.jsx)("div",{"data-slot":"dialog-footer",className:(0,n.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",e),...t})}function m({className:e,...a}){return(0,s.jsx)(t.Title,{"data-slot":"dialog-title",className:(0,n.cn)("text-lg font-semibold leading-none",e),...a})}function h({className:e,...a}){return(0,s.jsx)(t.Description,{"data-slot":"dialog-description",className:(0,n.cn)("text-sm text-muted-foreground",e),...a})}e.s(["Dialog",()=>l,"DialogContent",()=>d,"DialogDescription",()=>h,"DialogFooter",()=>x,"DialogHeader",()=>o,"DialogTitle",()=>m,"DialogTrigger",()=>i])},2202,e=>{"use strict";let s=(0,e.i(75254).default)("server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);e.s(["ServerIcon",()=>s],2202)},77172,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(18566),n=e.i(11764),l=e.i(70065),i=e.i(62870),r=e.i(67881),c=e.i(94179),d=e.i(65476),o=e.i(46696),x=e.i(93022),m=e.i(18306),h=e.i(30374),u=e.i(47163),g=e.i(72292),p=e.i(2202),j=e.i(75254);let f=(0,j.default)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),N=(0,j.default)("code",[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]]);var v=e.i(31447),y=e.i(34831);function C({asset:e,open:t,onOpenChange:a}){var n;return e?(0,s.jsx)(h.Dialog,{open:t,onOpenChange:a,children:(0,s.jsxs)(h.DialogContent,{className:"max-w-2xl max-h-[85vh] overflow-y-auto",children:[(0,s.jsxs)(h.DialogHeader,{children:[(0,s.jsxs)(h.DialogTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(g.GlobeIcon,{className:"size-5"}),"Asset Details"]}),(0,s.jsx)(h.DialogDescription,{className:"font-mono text-xs break-all",children:e.url})]}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("section",{className:"space-y-3",children:[(0,s.jsxs)("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[(0,s.jsx)(g.GlobeIcon,{className:"size-4"}),"Overview"]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-muted-foreground",children:"Asset Value"}),(0,s.jsx)("p",{className:"font-mono",children:e.assetValue||"-"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-muted-foreground",children:"Workspace"}),(0,s.jsx)("p",{children:e.workspace||"-"})]}),(0,s.jsxs)("div",{className:"col-span-2",children:[(0,s.jsx)("p",{className:"text-muted-foreground",children:"URL"}),(0,s.jsxs)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"font-mono text-xs text-primary hover:underline flex items-center gap-1 break-all",children:[e.url,(0,s.jsx)(y.ExternalLinkIcon,{className:"size-3 shrink-0"})]})]})]})]}),(0,s.jsxs)("section",{className:"space-y-3",children:[(0,s.jsxs)("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[(0,s.jsx)(N,{className:"size-4"}),"HTTP Request"]}),(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-3 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-muted-foreground",children:"Method"}),(0,s.jsx)(c.Badge,{variant:"outline",children:e.method})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-muted-foreground",children:"Scheme"}),(0,s.jsx)("p",{children:e.scheme||"-"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-muted-foreground",children:"Path"}),(0,s.jsx)("p",{className:"font-mono text-xs",children:e.path||"/"})]})]})]}),(0,s.jsxs)("section",{className:"space-y-3",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold",children:"HTTP Response"}),(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-3 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-muted-foreground",children:"Status Code"}),(0,s.jsx)(c.Badge,{variant:(n=e.statusCode)>=200&&n<300?"success":n>=300&&n<400?"warning":n>=400&&n<500?"outline":n>=500?"destructive":"secondary",children:e.statusCode})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-muted-foreground",children:"Content Type"}),(0,s.jsx)("p",{className:"text-xs",children:e.contentType||"-"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-muted-foreground",children:"Content Length"}),(0,s.jsx)("p",{children:(0,u.formatBytes)(e.contentLength)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-muted-foreground",children:"Title"}),(0,s.jsx)("p",{className:"truncate",children:e.title||"-"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-muted-foreground",children:"Words"}),(0,s.jsx)("p",{children:e.words.toLocaleString()})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-muted-foreground",children:"Lines"}),(0,s.jsx)("p",{children:e.lines.toLocaleString()})]})]})]}),(0,s.jsxs)("section",{className:"space-y-3",children:[(0,s.jsxs)("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[(0,s.jsx)(p.ServerIcon,{className:"size-4"}),"Network"]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-muted-foreground",children:"Host IP"}),(0,s.jsx)("p",{className:"font-mono",children:e.hostIp||"-"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-muted-foreground",children:"TLS"}),(0,s.jsx)("p",{children:e.tls||"-"})]}),e.aRecords.length>0&&(0,s.jsxs)("div",{className:"col-span-2",children:[(0,s.jsx)("p",{className:"text-muted-foreground",children:"DNS A Records"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-1 mt-1",children:e.aRecords.map((e,t)=>(0,s.jsx)(c.Badge,{variant:"outline",className:"font-mono text-xs",children:e},t))})]})]})]}),(0,s.jsxs)("section",{className:"space-y-3",children:[(0,s.jsxs)("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[(0,s.jsx)(f,{className:"size-4"}),"Detection"]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-muted-foreground",children:"Asset Type"}),(0,s.jsx)(c.Badge,{variant:"secondary",children:e.assetType})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-muted-foreground",children:"Source"}),(0,s.jsx)("p",{children:e.source||"-"})]}),e.technologies.length>0&&(0,s.jsxs)("div",{className:"col-span-2",children:[(0,s.jsx)("p",{className:"text-muted-foreground",children:"Technologies"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-1 mt-1",children:e.technologies.map((e,t)=>(0,s.jsx)(c.Badge,{variant:"outline",children:e},t))})]})]})]}),(0,s.jsxs)("section",{className:"space-y-3",children:[(0,s.jsxs)("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[(0,s.jsx)(v.ClockIcon,{className:"size-4"}),"Meta"]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-muted-foreground",children:"Response Time"}),(0,s.jsx)("p",{children:e.responseTime||"-"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-muted-foreground",children:"Remarks"}),(0,s.jsx)("p",{children:e.remarks||"-"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-muted-foreground",children:"Created"}),(0,s.jsx)("p",{className:"text-xs",children:e.createdAt.toLocaleString()})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-muted-foreground",children:"Updated"}),(0,s.jsx)("p",{className:"text-xs",children:e.updatedAt.toLocaleString()})]})]})]})]})]})}):null}function b(){let e=((0,a.useSearchParams)().get("workspace")??"").trim(),[h,g]=t.useState([]),[p,j]=t.useState(()=>e||"all"),[f,N]=t.useState(null),[v,y]=t.useState(!1),[b,w]=t.useState({}),[k,S]=t.useState(1),[T,D]=t.useState(null),[L,z]=t.useState(!1),[I,R]=t.useState({field:null,direction:"asc"}),A=t.useRef(0),B=t.useRef(!1);t.useEffect(()=>{(async()=>{try{let e=await (0,n.fetchWorkspaces)();g(e)}catch(e){o.toast.error("Failed to load workspaces",{description:e instanceof Error?e.message:""})}})()},[]),t.useEffect(()=>{if(!h.length||!p||"all"===p||h.find(e=>String(e.id)===p))return;let e=h.find(e=>e.name===p)||h.find(e=>e.name.toLowerCase()===p.toLowerCase());e&&j(String(e.id))},[h,p]);let M=t.useCallback(async e=>{let s=Date.now();if(e||!(s-A.current<2e4))try{y(!0);let e="all"===p?void 0:h.find(e=>String(e.id)===p)?.name??p,s=await (0,n.fetchHttpAssets)(e,{page:k,pageSize:50,filters:b}),t=s.pagination?.totalPages??0;if(t>0&&k>t){S(t),B.current=!0;return}N(s),A.current=Date.now()}catch(e){o.toast.error("Failed to load assets",{description:e instanceof Error?e.message:""})}finally{y(!1)}},[p,k,b,h]);t.useEffect(()=>{(async()=>{await M(B.current),B.current=!1})()},[M]);let P=t.useCallback(e=>{w(e),S(1)},[]),F=t.useCallback(e=>{R(s=>({field:e,direction:s.field===e&&"asc"===s.direction?"desc":"asc"}))},[]),H=t.useMemo(()=>{let e=f?.data??[],s=(b.search??"").trim().toLowerCase();return e.filter(e=>{if(s&&![e.url,e.title??"",e.assetValue,e.hostIp??""].join(" ").toLowerCase().includes(s)||b.statusCodes?.length&&!b.statusCodes.includes(e.statusCode))return!1;if(b.technologies?.length){let s=new Set(e.technologies.map(e=>String(e).trim().toLowerCase()));if(!b.technologies.map(e=>e.trim().toLowerCase()).some(e=>s.has(e)))return!1}return!0})},[f?.data,b.search,b.statusCodes,b.technologies]),V=t.useMemo(()=>(0,u.sortAssets)(H,I.field,I.direction),[H,I]),E=t.useMemo(()=>!!(b.search||b.statusCodes?.length||b.technologies?.length||b.contentTypes?.length||b.tlsVersion||b.location),[b]);return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)(l.Card,{className:"overflow-hidden",children:[(0,s.jsx)(l.CardHeader,{className:"border-b bg-muted/30 py-4",children:(0,s.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(l.CardTitle,{className:"text-base",children:"Assets Inventory"}),(0,s.jsx)(l.CardDescription,{children:f?.pagination?.totalItems!==void 0?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"font-medium text-foreground",children:f.pagination.totalItems.toLocaleString()})," ","assets found","all"!==p&&(0,s.jsxs)(s.Fragment,{children:[" ","in"," ",(0,s.jsx)("span",{className:"font-medium text-foreground",children:h.find(e=>String(e.id)===p)?.name??p})]})]}):"Loading assets..."})]}),(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-3 sm:justify-end",children:[(0,s.jsxs)(i.Select,{value:p,onValueChange:e=>{j(e),S(1),B.current=!0},children:[(0,s.jsx)(i.SelectTrigger,{className:"w-56",children:(0,s.jsx)(i.SelectValue,{placeholder:"Select workspace"})}),(0,s.jsxs)(i.SelectContent,{children:[(0,s.jsx)(i.SelectItem,{value:"all",children:"All Workspaces"}),h.map(e=>(0,s.jsx)(i.SelectItem,{value:String(e.id),children:e.name},e.id))]})]}),(0,s.jsxs)(r.Button,{variant:"outline",size:"sm",onClick:()=>M(!0),disabled:v,children:[(0,s.jsx)(d.RefreshCcwIcon,{className:`size-4 mr-2 ${v?"animate-spin":""}`}),"Refresh"]}),V.length>0&&(0,s.jsxs)("div",{className:"hidden lg:flex items-center gap-2",children:[(0,s.jsxs)(c.Badge,{variant:"success",className:"gap-1",children:["2xx:"," ",V.filter(e=>e.statusCode>=200&&e.statusCode<300).length]}),(0,s.jsxs)(c.Badge,{variant:"warning",className:"gap-1",children:["3xx:"," ",V.filter(e=>e.statusCode>=300&&e.statusCode<400).length]}),(0,s.jsxs)(c.Badge,{variant:"outline",className:"gap-1",children:["4xx:"," ",V.filter(e=>e.statusCode>=400&&e.statusCode<500).length]}),(0,s.jsxs)(c.Badge,{variant:"destructive",className:"gap-1",children:["5xx:"," ",V.filter(e=>e.statusCode>=500).length]})]})]})]})}),(0,s.jsx)("div",{className:"border-b p-4 bg-muted/10",children:(0,s.jsx)(x.AssetFilters,{filters:b,onFiltersChange:P})}),(0,s.jsx)(l.CardContent,{className:"p-0",children:(0,s.jsx)(m.HttpAssetsTable,{assets:V,isLoading:v,pagination:f?.pagination,sortState:I,onSort:F,onPageChange:e=>{S(e)},onSelect:e=>{D(e),z(!0)},hasActiveFilters:E})})]}),(0,s.jsx)(C,{asset:T,open:L,onOpenChange:z})]})}e.s(["default",()=>b],77172)}]);