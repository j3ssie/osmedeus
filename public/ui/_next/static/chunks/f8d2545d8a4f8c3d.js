(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,70065,e=>{"use strict";var t=e.i(43476),a=e.i(47163);function r({className:e,...r}){return(0,t.jsx)("div",{"data-slot":"card",className:(0,a.cn)("bg-card/80 backdrop-blur-sm text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm transition-all duration-300 hover:shadow-[0_0_30px_rgba(32,178,170,0.12)] hover:-translate-y-0.5",e),...r})}function s({className:e,...r}){return(0,t.jsx)("div",{"data-slot":"card-header",className:(0,a.cn)("flex flex-col gap-1.5 px-6",e),...r})}function n({className:e,...r}){return(0,t.jsx)("div",{"data-slot":"card-title",className:(0,a.cn)("leading-none font-semibold",e),...r})}function i({className:e,...r}){return(0,t.jsx)("div",{"data-slot":"card-description",className:(0,a.cn)("text-muted-foreground text-sm",e),...r})}function o({className:e,...r}){return(0,t.jsx)("div",{"data-slot":"card-content",className:(0,a.cn)("px-6",e),...r})}function l({className:e,...r}){return(0,t.jsx)("div",{"data-slot":"card-footer",className:(0,a.cn)("flex items-center px-6",e),...r})}e.s(["Card",()=>r,"CardContent",()=>o,"CardDescription",()=>i,"CardFooter",()=>l,"CardHeader",()=>s,"CardTitle",()=>n])},97882,e=>{"use strict";let t=(0,e.i(75254).default)("loader",[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]]);e.s(["LoaderIcon",()=>t],97882)},97239,e=>{"use strict";let t=(0,e.i(75254).default)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);e.s(["AlertTriangleIcon",()=>t],97239)},28196,e=>{"use strict";let t=(0,e.i(75254).default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);e.s(["AlertCircleIcon",()=>t],28196)},72292,e=>{"use strict";let t=(0,e.i(75254).default)("globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);e.s(["GlobeIcon",()=>t],72292)},79319,e=>{"use strict";let t=(0,e.i(75254).default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);e.s(["RefreshCwIcon",()=>t],79319)},71586,e=>{"use strict";var t=e.i(43476),a=e.i(47163),r=e.i(67881),s=e.i(28196),n=e.i(79319);function i({title:e="Something went wrong",message:i="We couldn't load the data. Please try again.",onRetry:o,className:l}){return(0,t.jsxs)("div",{className:(0,a.cn)("flex flex-col items-center justify-center py-12 text-center",l),children:[(0,t.jsx)("div",{className:"mb-4 rounded-full bg-destructive/10 p-4",children:(0,t.jsx)(s.AlertCircleIcon,{className:"size-8 text-destructive"})}),(0,t.jsx)("h3",{className:"mb-1 text-lg font-semibold",children:e}),(0,t.jsx)("p",{className:"mb-4 max-w-sm text-sm text-muted-foreground",children:i}),o&&(0,t.jsxs)(r.Button,{onClick:o,variant:"outline",children:[(0,t.jsx)(n.RefreshCwIcon,{className:"mr-2 size-4"}),"Try again"]})]})}e.s(["ErrorState",()=>i])},24553,e=>{"use strict";var t=e.i(43476),a=e.i(47163),r=e.i(67881);let s=(0,e.i(75254).default)("inbox",[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]]);function n({icon:e=s,title:n,description:i,action:o,className:l}){return(0,t.jsxs)("div",{className:(0,a.cn)("flex flex-col items-center justify-center py-12 text-center",l),children:[(0,t.jsx)("div",{className:"mb-4 rounded-full bg-muted p-4",children:(0,t.jsx)(e,{className:"size-8 text-muted-foreground"})}),(0,t.jsx)("h3",{className:"mb-1 text-lg font-semibold",children:n}),i&&(0,t.jsx)("p",{className:"mb-4 max-w-sm text-sm text-muted-foreground",children:i}),o&&(0,t.jsx)(r.Button,{onClick:o.onClick,variant:"default",children:o.label})]})}e.s(["EmptyState",()=>n],24553)},61166,e=>{"use strict";let t=(0,e.i(75254).default)("link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);e.s(["LinkIcon",()=>t],61166)},85562,e=>{"use strict";let t=(0,e.i(75254).default)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);e.s(["ArrowRightIcon",()=>t],85562)},31447,e=>{"use strict";let t=(0,e.i(75254).default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);e.s(["ClockIcon",()=>t],31447)},67003,e=>{"use strict";var t=e.i(55161),a=e.i(62280),r=e.i(72536);let s=[{id:"scan-001",runId:"run-2025-01-15-subdomain-enum-example.com",runUuid:"run-2025-01-15-subdomain-enum-example.com",workflowName:"subdomain-enum",workflowKind:"flow",target:"example.com",status:"completed",startedAt:new Date(Date.now()-36e5),completedAt:new Date(Date.now()-18e5),totalSteps:10,completedSteps:10,triggerType:"manual",createdAt:new Date(Date.now()-36e5),updatedAt:new Date(Date.now()-18e5)},{id:"scan-002",runId:"run-2025-01-15-vulnerability-scan-api.example.com",runUuid:"run-2025-01-15-vulnerability-scan-api.example.com",workflowName:"vulnerability-scan",workflowKind:"flow",target:"api.example.com",status:"running",startedAt:new Date(Date.now()-9e5),totalSteps:15,completedSteps:10,triggerType:"manual",createdAt:new Date(Date.now()-9e5),updatedAt:new Date},{id:"scan-003",runId:"run-2025-01-15-full-recon-testsite.org",runUuid:"run-2025-01-15-full-recon-testsite.org",workflowName:"full-recon",workflowKind:"flow",target:"testsite.org",status:"pending",totalSteps:20,completedSteps:0,triggerType:"scheduled",createdAt:new Date(Date.now()-3e5),updatedAt:new Date(Date.now()-3e5)},{id:"scan-004",runId:"run-2025-01-15-subdomain-enum-acme.io",runUuid:"run-2025-01-15-subdomain-enum-acme.io",workflowName:"subdomain-enum",workflowKind:"flow",target:"acme.io",status:"failed",startedAt:new Date(Date.now()-72e5),completedAt:new Date(Date.now()-68e5),totalSteps:10,completedSteps:3,triggerType:"manual",errorMessage:"Connection timeout after 5 retries",createdAt:new Date(Date.now()-72e5),updatedAt:new Date(Date.now()-68e5)},{id:"scan-005",runId:"run-2025-01-14-http-probe-secure.bank.com",runUuid:"run-2025-01-14-http-probe-secure.bank.com",workflowName:"http-probe",workflowKind:"module",target:"secure.bank.com",status:"completed",startedAt:new Date(Date.now()-864e5),completedAt:new Date(Date.now()-828e5),totalSteps:5,completedSteps:5,triggerType:"scheduled",createdAt:new Date(Date.now()-864e5),updatedAt:new Date(Date.now()-828e5)},{id:"scan-006",runId:"run-2025-01-13-subdomain-enum-startup.dev",runUuid:"run-2025-01-13-subdomain-enum-startup.dev",workflowName:"subdomain-enum",workflowKind:"flow",target:"startup.dev",status:"cancelled",startedAt:new Date(Date.now()-1728e5),completedAt:new Date(Date.now()-171e6),totalSteps:10,completedSteps:5,triggerType:"manual",createdAt:new Date(Date.now()-1728e5),updatedAt:new Date(Date.now()-171e6)},{id:"scan-007",runId:"run-2025-01-12-full-recon-megacorp.com",runUuid:"run-2025-01-12-full-recon-megacorp.com",workflowName:"full-recon",workflowKind:"flow",target:"megacorp.com",status:"completed",startedAt:new Date(Date.now()-2592e5),completedAt:new Date(Date.now()-252e6),totalSteps:20,completedSteps:20,triggerType:"manual",createdAt:new Date(Date.now()-2592e5),updatedAt:new Date(Date.now()-252e6)},{id:"scan-008",runId:"run-2025-01-15-vulnerability-scan-shop.retail.com",runUuid:"run-2025-01-15-vulnerability-scan-shop.retail.com",workflowName:"vulnerability-scan",workflowKind:"flow",target:"shop.retail.com",status:"running",startedAt:new Date(Date.now()-6e5),totalSteps:15,completedSteps:5,triggerType:"manual",createdAt:new Date(Date.now()-6e5),updatedAt:new Date}];function n(e){let t=e.workflow_name??e.workflow??e.flow??e.module??"",a=e.workflow_kind??e.kind??(e.module?"module":"flow"),r=e.target??(Array.isArray(e.targets)&&e.targets.length>0?e.targets[0]:"")??e.target_file??"",s=e.run_uuid??e.runUuid??"";return{id:String(e.id??e.run_id??e.runId??s??""),runId:e.run_id??e.runId??e.id??"",runUuid:String(s||""),workflowName:t,workflowKind:"module"===a?"module":"flow",target:r,params:e.params,status:e.status??"pending",workspace:e.workspace,workspacePath:e.workspace_path,startedAt:e.started_at?new Date(e.started_at):void 0,completedAt:e.completed_at?new Date(e.completed_at):void 0,totalSteps:e.total_steps??0,completedSteps:e.completed_steps??0,triggerType:e.trigger_type??"manual",triggerName:e.trigger_name,runGroupId:e.run_group_id,errorMessage:e.error_message,createdAt:e.created_at?new Date(e.created_at):new Date,updatedAt:e.updated_at?new Date(e.updated_at):new Date}}async function i(e){let i=e.page??1,o=e.pageSize??20,l=(i-1)*o,d=e.filters??{};if((0,r.isDemoMode)()){let e=(d.status??"").trim().toLowerCase(),t=(d.workflowName??"").trim().toLowerCase(),a=(d.target??"").trim().toLowerCase(),r=(d.workspace??"").trim().toLowerCase(),n=[...s.filter(s=>(!e||"all"===e||String(s.status).toLowerCase()===e)&&(!t||!!s.workflowName.toLowerCase().includes(t))&&(!a||!!s.target.toLowerCase().includes(a))&&(!r||String(s.workspace??"").toLowerCase()===r))].sort((e,t)=>{let a=e.startedAt?.getTime()??e.createdAt?.getTime()??0;return(t.startedAt?.getTime()??t.createdAt?.getTime()??0)-a}),c=n.slice(l,l+o),u=n.length;return{data:c,pagination:{page:i,pageSize:o,totalItems:u,totalPages:Math.ceil(u/o)}}}let c={offset:l,limit:o};d.status&&"all"!==d.status&&(c.status=d.status),d.workflowName&&(c.workflow_name=d.workflowName),d.target&&(c.target=d.target),d.workspace&&(c.workspace=d.workspace);let u=await t.http.get(`${a.API_PREFIX}/runs`,{params:c}),m=(u.data?.data||[]).map(n),p=u.data?.pagination?.total??m.length,w=u.data?.pagination?.limit??o;return{data:m,pagination:{page:Math.floor((u.data?.pagination?.offset??l)/w)+1,pageSize:w,totalItems:p,totalPages:Math.ceil(p/w)}}}async function o(e=5){if((0,r.isDemoMode)())return[...s].sort((e,t)=>{let a=e.startedAt?.getTime()??e.createdAt?.getTime()??0;return(t.startedAt?.getTime()??t.createdAt?.getTime()??0)-a}).slice(0,e);let i=await t.http.get(`${a.API_PREFIX}/runs`,{params:{limit:e,offset:0}});return(i.data?.data||[]).map(n)}async function l(e){if((0,r.isDemoMode)()){let t=new Date,a={id:`scan-${Math.random().toString(16).slice(2,10)}`,runId:`run-demo-${Date.now()}`,runUuid:`run-demo-uuid-${Date.now()}`,workflowName:e.workflowId,workflowKind:e.workflowKind||"flow",target:e.target||(Array.isArray(e.targets)&&e.targets.length>0?e.targets[0]:"")||(e.target_file??""),status:e.schedule?"pending":"running",totalSteps:0,completedSteps:0,triggerType:e.schedule?"scheduled":"manual",createdAt:t,updatedAt:t,startedAt:e.schedule?void 0:t};return s=[a,...s],a}if(e.schedule){let r={name:`scheduled-${e.workflowId}-${Date.now()}`,workflow_name:e.workflowId,workflow_kind:"module"===e.workflowKind?"module":"flow",target:e.target||"",schedule:e.schedule,enabled:!0};return await t.http.post(`${a.API_PREFIX}/schedules`,r),{id:`scan-${Date.now()}`,runId:"",runUuid:"",workflowName:e.workflowId,workflowKind:e.workflowKind||"flow",target:e.target||"",status:"pending",totalSteps:0,completedSteps:0,triggerType:"scheduled",createdAt:new Date,updatedAt:new Date}}let i={};e.workflowId&&("module"===e.workflowKind?i.module=e.workflowId:i.flow=e.workflowId),"number"==typeof e.threads_hold&&(i.threads_hold=e.threads_hold),"string"==typeof e.heuristics_check&&e.heuristics_check.trim()&&(i.heuristics_check=e.heuristics_check.trim()),"boolean"==typeof e.repeat&&(i.repeat=e.repeat),"string"==typeof e.repeat_wait_time&&e.repeat_wait_time.trim()&&(i.repeat_wait_time=e.repeat_wait_time.trim()),e.empty_target&&(i.empty_target=!0),Array.isArray(e.targets)&&e.targets.length>0?(i.targets=e.targets,"number"==typeof e.concurrency&&(i.concurrency=e.concurrency)):e.target_file?(i.target_file=e.target_file,"number"==typeof e.concurrency&&(i.concurrency=e.concurrency)):!e.empty_target&&e.target&&(i.target=e.target),e.params&&Object.keys(e.params).length>0&&(i.params=e.params),e.priority&&(i.priority=e.priority),"number"==typeof e.timeout&&(i.timeout=e.timeout),e.runner_type&&"local"!==e.runner_type&&(i.runner_type=e.runner_type,"docker"===e.runner_type&&e.docker_image&&(i.docker_image=e.docker_image),"ssh"===e.runner_type&&e.ssh_host&&(i.ssh_host=e.ssh_host));let o=await t.http.post(`${a.API_PREFIX}/runs`,i),l=o.data?.data??o.data??{},d=e.target||(Array.isArray(e.targets)&&e.targets.length>0?e.targets[0]:"")||(e.target_file??"");return n({...l,id:l.id??l.run_id??l.runId??`scan-${Date.now()}`,run_id:l.run_id??l.runId??"",run_uuid:l.run_uuid??l.runUuid??"",workflow_name:l.workflow_name??l.workflow??e.workflowId,workflow_kind:l.workflow_kind??l.kind??e.workflowKind??"flow",target:l.target??d,status:l.status??"running",trigger_type:l.trigger_type??"manual",created_at:l.created_at??new Date().toISOString(),updated_at:l.updated_at??new Date().toISOString()})}async function d(e){if((0,r.isDemoMode)()){let t=s.findIndex(t=>t.runUuid===e||t.id===e||t.runId===e);if(-1===t)return!1;let a=new Date,r=[...s];return r[t]={...r[t],status:"cancelled",completedAt:r[t].completedAt??a,updatedAt:a},s=r,!0}try{return await t.http.delete(`${a.API_PREFIX}/runs/${encodeURIComponent(e)}`),!0}catch{return!1}}async function c(e){return d(e)}async function u(e){if((0,r.isDemoMode)()){let t=s.find(t=>t.runUuid===e||t.id===e||t.runId===e),a=new Date,r={id:`scan-${Math.random().toString(16).slice(2,10)}`,runId:`run-demo-${Date.now()}`,runUuid:`run-demo-uuid-${Date.now()}`,workflowName:t?.workflowName??"duplicate",workflowKind:t?.workflowKind??"flow",target:t?.target??"",params:t?.params,status:"pending",workspace:t?.workspace,workspacePath:t?.workspacePath,totalSteps:t?.totalSteps??0,completedSteps:0,triggerType:"manual",createdAt:a,updatedAt:a};return s=[r,...s],r}let i=await t.http.post(`${a.API_PREFIX}/runs/${encodeURIComponent(e)}/duplicate`);return n(i.data?.data??i.data??{})}async function m(e){if((0,r.isDemoMode)()){let t=s.findIndex(t=>t.runUuid===e||t.id===e||t.runId===e);if(-1===t)return null;let a=new Date,r=[...s];return r[t]={...r[t],status:"running",startedAt:r[t].startedAt??a,updatedAt:a},s=r,r[t]}try{let r=await t.http.post(`${a.API_PREFIX}/runs/${encodeURIComponent(e)}/start`),s=r.data?.data??r.data;return s?n(s):null}catch{return null}}e.s(["cancelScan",()=>d,"createScan",()=>l,"deleteScan",()=>c,"duplicateScanRun",()=>u,"fetchRecentScans",()=>o,"fetchScans",()=>i,"startScanRun",()=>m],67003)},20667,e=>{"use strict";var t=e.i(43476),a=e.i(47163),r=e.i(71428);function s({rows:e=5,columns:s=4,className:n}){return(0,t.jsxs)("div",{className:(0,a.cn)("w-full",n),children:[(0,t.jsx)("div",{className:"flex gap-4 border-b pb-3",children:Array.from({length:s}).map((e,a)=>(0,t.jsx)(r.Skeleton,{className:"h-4 flex-1"},a))}),Array.from({length:e}).map((e,a)=>(0,t.jsx)("div",{className:"flex gap-4 border-b py-4",children:Array.from({length:s}).map((e,a)=>(0,t.jsx)(r.Skeleton,{className:"h-4 flex-1"},a))},a))]})}function n({className:e}){return(0,t.jsx)("div",{className:(0,a.cn)("rounded-xl border bg-card p-6",e),children:(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(r.Skeleton,{className:"size-10 rounded-lg"}),(0,t.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,t.jsx)(r.Skeleton,{className:"h-4 w-1/3"}),(0,t.jsx)(r.Skeleton,{className:"h-6 w-1/2"})]})]})})}function i({className:e}){return(0,t.jsx)("div",{className:(0,a.cn)("rounded-xl border bg-card p-6",e),children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(r.Skeleton,{className:"h-3 w-20"}),(0,t.jsx)(r.Skeleton,{className:"h-8 w-16"})]}),(0,t.jsx)(r.Skeleton,{className:"size-10 rounded-lg"})]})})}e.s(["CardSkeleton",()=>n,"StatCardSkeleton",()=>i,"TableSkeleton",()=>s])},29590,e=>{"use strict";let t=(0,e.i(75254).default)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);e.s(["XCircleIcon",()=>t],29590)},7649,93053,e=>{"use strict";var t=e.i(75254);let a=(0,t.default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);e.s(["CheckCircleIcon",()=>a],7649);let r=(0,t.default)("ban",[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);e.s(["BanIcon",()=>r],93053)},16883,e=>{"use strict";var t=e.i(43476),a=e.i(71645),r=e.i(22016),s=e.i(47163),n=e.i(70065);function i({title:e,value:a,icon:r,description:i,trend:o,className:l}){return(0,t.jsx)(n.Card,{className:(0,s.cn)("p-6",l),children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:e}),(0,t.jsxs)("div",{className:"flex items-baseline gap-2",children:[(0,t.jsx)("p",{className:"text-2xl font-bold",children:a}),o&&(0,t.jsxs)("span",{className:(0,s.cn)("text-xs font-medium",o.isPositive?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"),children:[o.isPositive?"+":"-",Math.abs(o.value),"%"]})]}),i&&(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:i})]}),(0,t.jsx)("div",{className:"flex size-12 items-center justify-center rounded-lg bg-primary/10",children:(0,t.jsx)(r,{className:"size-6 text-primary"})})]})})}var o=e.i(94179),l=e.i(67881),d=e.i(71428),c=e.i(24553),u=e.i(71586),m=e.i(67003),p=e.i(85562),w=e.i(33449),f=e.i(7649),g=e.i(29590),h=e.i(97882),x=e.i(31447),k=e.i(93053);let y={completed:{label:"Completed",variant:"success",icon:f.CheckCircleIcon},running:{label:"Running",variant:"default",icon:h.LoaderIcon},pending:{label:"Pending",variant:"secondary",icon:x.ClockIcon},failed:{label:"Failed",variant:"destructive",icon:g.XCircleIcon},cancelled:{label:"Cancelled",variant:"outline",icon:k.BanIcon}};function j(){let[e,i]=a.useState([]),[f,g]=a.useState(!0),[h,x]=a.useState(null),k=a.useCallback(async()=>{try{g(!0),x(null);let e=await (0,m.fetchRecentScans)(5);i(e)}catch(e){x(e instanceof Error?e.message:"Failed to load scans")}finally{g(!1)}},[]);return a.useEffect(()=>{k()},[k]),(0,t.jsxs)(n.Card,{children:[(0,t.jsxs)(n.CardHeader,{className:"flex flex-row items-center justify-between",children:[(0,t.jsx)(n.CardTitle,{className:"text-lg",children:"Recent Scans"}),(0,t.jsx)(l.Button,{variant:"ghost",size:"sm",asChild:!0,children:(0,t.jsxs)(r.default,{href:"/scans",children:["View all",(0,t.jsx)(p.ArrowRightIcon,{className:"ml-1 size-4"})]})})]}),(0,t.jsx)(n.CardContent,{children:f?(0,t.jsx)("div",{className:"space-y-4",children:Array.from({length:5}).map((e,a)=>(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(d.Skeleton,{className:"size-10 rounded-lg"}),(0,t.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,t.jsx)(d.Skeleton,{className:"h-4 w-1/3"}),(0,t.jsx)(d.Skeleton,{className:"h-3 w-1/2"})]}),(0,t.jsx)(d.Skeleton,{className:"h-6 w-20"})]},a))}):h?(0,t.jsx)(u.ErrorState,{message:h,onRetry:k}):0===e.length?(0,t.jsx)(c.EmptyState,{icon:w.ScanSearchIcon,title:"No scans yet",description:"Start your first security scan to see results here.",action:{label:"New Scan",onClick:()=>window.location.href="/scans/new"}}):(0,t.jsx)("div",{className:"space-y-4",children:e.map(e=>{let a=y[e.status],n=a.icon;return(0,t.jsxs)(r.default,{href:"/scans",className:"flex items-center gap-4 rounded-lg p-2 -mx-2 transition-colors hover:bg-muted/50",children:[(0,t.jsx)("div",{className:"flex size-10 items-center justify-center rounded-lg bg-muted",children:(0,t.jsx)(n,{className:`size-5 ${"running"===e.status?"animate-spin":""} ${"completed"===e.status?"text-green-600 dark:text-green-400":"failed"===e.status?"text-destructive":"text-muted-foreground"}`})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"font-medium truncate",children:e.target}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground truncate",children:[e.workflowName," Â· ",e.startedAt?(0,s.timeAgo)(e.startedAt):"Pending"]})]}),(0,t.jsx)(o.Badge,{variant:a.variant,children:a.label})]},e.id)})})})]})}var v=e.i(20667),b=e.i(55161),N=e.i(62280),A=e.i(72536);let _={workflows:12,workspaces:24,subdomains:15847,httpAssets:8234,vulnerabilities:127};async function D(){if((0,A.isDemoMode)())return _;let e=(await b.http.get(`${N.API_PREFIX}/stats`)).data||{},t=e?.workflows?.total??0,a=e?.workspaces?.total??0,r=e?.assets?.total??0,s=e?.vulnerabilities?.total??0,n=e?.subdomains?.total??0;if(!n)try{let e=await b.http.get(`${N.API_PREFIX}/workspaces`,{params:{offset:0,limit:1e3}});n=(Array.isArray(e.data?.data)?e.data.data:[]).reduce((e,t)=>e+(t.total_subdomains??0),0)}catch{n=0}return{workflows:t,workspaces:a,subdomains:n,httpAssets:r,vulnerabilities:s}}var S=e.i(76179),I=e.i(46545),C=e.i(72292),M=e.i(61166),z=e.i(97239);function T(){let[e,n]=a.useState(null),[o,l]=a.useState(!0);return a.useEffect(()=>{(async()=>{try{let e=await D();n(e)}catch(e){console.error("Failed to load stats:",e)}finally{l(!1)}})()},[]),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("div",{className:"grid gap-4 grid-cols-[repeat(auto-fit,minmax(220px,1fr))]",children:o?Array.from({length:5}).map((e,a)=>(0,t.jsx)(v.StatCardSkeleton,{},a)):e?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i,{title:"Workflows",value:(0,s.formatNumber)(e.workflows),icon:S.WorkflowIcon,description:"Active workflow modules"}),(0,t.jsx)(i,{title:"Workspaces",value:(0,s.formatNumber)(e.workspaces),icon:I.FolderOpenIcon,description:"Target workspaces"}),(0,t.jsx)(i,{title:"Subdomains",value:(0,s.formatNumber)(e.subdomains),icon:C.GlobeIcon,description:"Discovered subdomains"}),(0,t.jsx)(i,{title:"HTTP Assets",value:(0,s.formatNumber)(e.httpAssets),icon:M.LinkIcon,description:"Live web endpoints"}),(0,t.jsx)(i,{title:"Vulnerabilities",value:(0,s.formatNumber)(e.vulnerabilities),icon:z.AlertTriangleIcon,description:"Security findings"})]}):null}),(0,t.jsxs)("div",{className:"grid gap-6 lg:grid-cols-2",children:[(0,t.jsx)(j,{}),(0,t.jsxs)("div",{className:"rounded-xl border bg-card p-6",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Quick Actions"}),(0,t.jsxs)("div",{className:"grid gap-3 sm:grid-cols-2",children:[(0,t.jsxs)(r.default,{href:"/scans/new",className:"flex items-center gap-3 rounded-lg border p-4 transition-colors hover:bg-muted/50",children:[(0,t.jsx)("div",{className:"flex size-10 items-center justify-center rounded-lg bg-primary/10",children:(0,t.jsx)("svg",{className:"size-5 text-primary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:"New Scan"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Start a new security scan"})]})]}),(0,t.jsxs)(r.default,{href:"/assets",className:"flex items-center gap-3 rounded-lg border p-4 transition-colors hover:bg-muted/50",children:[(0,t.jsx)("div",{className:"flex size-10 items-center justify-center rounded-lg bg-primary/10",children:(0,t.jsx)(I.FolderOpenIcon,{className:"size-5 text-primary"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:"View Assets"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Browse discovered assets"})]})]}),(0,t.jsxs)(r.default,{href:"/workflows-editor",className:"flex items-center gap-3 rounded-lg border p-4 transition-colors hover:bg-muted/50",children:[(0,t.jsx)("div",{className:"flex size-10 items-center justify-center rounded-lg bg-primary/10",children:(0,t.jsx)(S.WorkflowIcon,{className:"size-5 text-primary"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:"Edit Workflow"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Customize scan workflows"})]})]}),(0,t.jsxs)(r.default,{href:"/settings",className:"flex items-center gap-3 rounded-lg border p-4 transition-colors hover:bg-muted/50",children:[(0,t.jsx)("div",{className:"flex size-10 items-center justify-center rounded-lg bg-primary/10",children:(0,t.jsxs)("svg",{className:"size-5 text-primary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:[(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:"Settings"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Configure preferences"})]})]})]})]})]})]})}e.s(["default",()=>T],16883)}]);