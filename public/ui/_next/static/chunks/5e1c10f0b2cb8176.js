(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,65476,e=>{"use strict";let t=(0,e.i(75254).default)("refresh-ccw",[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]]);e.s(["RefreshCcwIcon",()=>t],65476)},11764,e=>{"use strict";var t=e.i(55161),s=e.i(62280),a=e.i(72536);let o=[{id:1,name:"example.com",data_source:"local",local_path:"/home/user/osmedeus-base/workspaces/example.com",state_execution_log:"/home/user/osmedeus-base/workspaces/example.com/log/execution.log",state_completed_file:"/home/user/osmedeus-base/workspaces/example.com/state/completed",state_workflow_file:"/home/user/osmedeus-base/workspaces/example.com/state/workflow.yaml",state_workflow_folder:"/home/user/osmedeus-base/workspaces/example.com/state",total_assets:150,total_subdomains:1247,total_urls:856,total_vulns:23,vuln_critical:2,vuln_high:5,vuln_medium:8,vuln_low:8,vuln_potential:3,risk_score:7.5,tags:["production","priority"],last_run:new Date(Date.now()-36e5).toISOString(),run_workflow:"subdomain-enum",created_at:"2024-01-15T08:00:00Z",updated_at:new Date(Date.now()-36e5).toISOString()},{id:2,name:"testsite.org",data_source:"cloud",local_path:"/home/user/osmedeus-base/workspaces/testsite.org",state_execution_log:"/home/user/osmedeus-base/workspaces/testsite.org/log/execution.log",state_completed_file:"/home/user/osmedeus-base/workspaces/testsite.org/state/completed",state_workflow_file:"/home/user/osmedeus-base/workspaces/testsite.org/state/workflow.yaml",state_workflow_folder:"/home/user/osmedeus-base/workspaces/testsite.org/state",total_assets:50,total_subdomains:342,total_urls:189,total_vulns:7,vuln_critical:0,vuln_high:1,vuln_medium:3,vuln_low:3,vuln_potential:2,risk_score:4.2,tags:["staging"],last_run:new Date(Date.now()-864e5).toISOString(),run_workflow:"port-scan",created_at:"2024-02-20T12:00:00Z",updated_at:new Date(Date.now()-864e5).toISOString()},{id:3,name:"acme.io",data_source:"imported",local_path:"/home/user/osmedeus-base/workspaces/acme.io",state_execution_log:"/home/user/osmedeus-base/workspaces/acme.io/log/execution.log",state_completed_file:"/home/user/osmedeus-base/workspaces/acme.io/state/completed",state_workflow_file:"/home/user/osmedeus-base/workspaces/acme.io/state/workflow.yaml",state_workflow_folder:"/home/user/osmedeus-base/workspaces/acme.io/state",total_assets:320,total_subdomains:2156,total_urls:1432,total_vulns:45,vuln_critical:5,vuln_high:12,vuln_medium:15,vuln_low:13,vuln_potential:8,risk_score:8.8,tags:["production","critical"],last_run:new Date(Date.now()-1728e5).toISOString(),run_workflow:"full-scan",created_at:"2024-03-10T10:00:00Z",updated_at:new Date(Date.now()-1728e5).toISOString()},{id:4,name:"secure.bank.com",data_source:"local",local_path:"/home/user/osmedeus-base/workspaces/secure.bank.com",state_execution_log:"/home/user/osmedeus-base/workspaces/secure.bank.com/log/execution.log",state_completed_file:"/home/user/osmedeus-base/workspaces/secure.bank.com/state/completed",state_workflow_file:"/home/user/osmedeus-base/workspaces/secure.bank.com/state/workflow.yaml",state_workflow_folder:"/home/user/osmedeus-base/workspaces/secure.bank.com/state",total_assets:80,total_subdomains:567,total_urls:312,total_vulns:12,vuln_critical:1,vuln_high:2,vuln_medium:5,vuln_low:4,vuln_potential:0,risk_score:5.5,tags:["finance","priority"],last_run:new Date(Date.now()-432e5).toISOString(),run_workflow:"vuln-scan",created_at:"2024-04-05T09:00:00Z",updated_at:new Date(Date.now()-432e5).toISOString()},{id:5,name:"startup.dev",data_source:"cloud",local_path:"/home/user/osmedeus-base/workspaces/startup.dev",state_execution_log:"/home/user/osmedeus-base/workspaces/startup.dev/log/execution.log",state_completed_file:"/home/user/osmedeus-base/workspaces/startup.dev/state/completed",state_workflow_file:"/home/user/osmedeus-base/workspaces/startup.dev/state/workflow.yaml",state_workflow_folder:"/home/user/osmedeus-base/workspaces/startup.dev/state",total_assets:20,total_subdomains:89,total_urls:45,total_vulns:3,vuln_critical:0,vuln_high:0,vuln_medium:1,vuln_low:2,vuln_potential:5,risk_score:2.1,tags:["development"],last_run:new Date(Date.now()-6048e5).toISOString(),run_workflow:"quick-scan",created_at:"2024-05-01T14:00:00Z",updated_at:new Date(Date.now()-6048e5).toISOString()},{id:6,name:"megacorp.com",data_source:"local",local_path:"/home/user/osmedeus-base/workspaces/megacorp.com",state_execution_log:"/home/user/osmedeus-base/workspaces/megacorp.com/log/execution.log",state_completed_file:"/home/user/osmedeus-base/workspaces/megacorp.com/state/completed",state_workflow_file:"/home/user/osmedeus-base/workspaces/megacorp.com/state/workflow.yaml",state_workflow_folder:"/home/user/osmedeus-base/workspaces/megacorp.com/state",total_assets:890,total_subdomains:8934,total_urls:4521,total_vulns:89,vuln_critical:8,vuln_high:22,vuln_medium:35,vuln_low:24,vuln_potential:15,risk_score:9.2,tags:["enterprise","production","critical"],last_run:new Date(Date.now()-2592e5).toISOString(),run_workflow:"full-scan",created_at:"2024-01-01T08:00:00Z",updated_at:new Date(Date.now()-2592e5).toISOString()},{id:7,name:"shop.retail.com",data_source:"imported",local_path:"/home/user/osmedeus-base/workspaces/shop.retail.com",state_execution_log:"/home/user/osmedeus-base/workspaces/shop.retail.com/log/execution.log",state_completed_file:"/home/user/osmedeus-base/workspaces/shop.retail.com/state/completed",state_workflow_file:"/home/user/osmedeus-base/workspaces/shop.retail.com/state/workflow.yaml",state_workflow_folder:"/home/user/osmedeus-base/workspaces/shop.retail.com/state",total_assets:45,total_subdomains:234,total_urls:167,total_vulns:5,vuln_critical:0,vuln_high:1,vuln_medium:2,vuln_low:2,vuln_potential:3,risk_score:3.5,tags:["retail","staging"],last_run:new Date(Date.now()-6e5).toISOString(),run_workflow:"subdomain-enum",created_at:"2024-06-15T11:00:00Z",updated_at:new Date(Date.now()-6e5).toISOString()}];function l(e,t){let s=["api","www","mail","admin","dashboard","app","cdn","static","dev","staging","test","beta","secure","auth","login","portal","shop","store","blog","docs","support","help","status","monitor"],a=["Welcome to Our API","Admin Dashboard","Login Portal","Documentation","Help Center","Status Page","Application Home","Secure Portal",void 0,"Blog","Store","Developer Portal"],o=[200,200,200,200,301,302,403,404,500,200,200,200],l=[];for(let r=0;r<t;r++){let t=s[r%s.length],n=o[r%o.length],i=`https://${t}.example.com${r>0?`/path-${r}`:""}`;l.push({id:`asset-${e}-${r.toString().padStart(4,"0")}`,workspace:e,assetValue:`${t}.example.com`,url:i,input:`${t}.example.com`,scheme:"https",method:"GET",path:r>0?`/path-${r}`:"/",statusCode:n,contentType:200===n?"text/html; charset=utf-8":"",contentLength:Math.floor(5e5*Math.random())+1e3,title:200===n?a[r%a.length]:void 0,words:Math.floor(5e3*Math.random())+100,lines:Math.floor(500*Math.random())+10,hostIp:`192.168.${Math.floor(255*Math.random())}.${Math.floor(255*Math.random())}`,aRecords:[`192.168.${Math.floor(255*Math.random())}.${Math.floor(255*Math.random())}`],tls:"TLS 1.3",assetType:"web",technologies:200===n?["nginx","React","Node.js"].slice(0,Math.floor(3*Math.random())+1):[],responseTime:`${Math.floor(500*Math.random())+50}ms`,source:"httpx",createdAt:new Date(Date.now()-Math.floor(7*Math.random()*864e5)),updatedAt:new Date(Date.now()-Math.floor(3*Math.random()*864e5))})}return l}let r={"ws-001":l("ws-001",856),"ws-002":l("ws-002",189),"ws-003":l("ws-003",1432),"ws-004":l("ws-004",312),"ws-005":l("ws-005",45),"ws-006":l("ws-006",4521),"ws-007":l("ws-007",167)};async function n(e={}){return(await i(e)).items}async function i(e={}){if((0,a.isDemoMode)()){let t=o.map(e=>c(e)),s=e.search?.trim().toLowerCase(),a=e.data_source?.trim().toLowerCase(),l=s?t.filter(e=>!!(e.name.toLowerCase().includes(s)||e.local_path.toLowerCase().includes(s)||e.data_source?.toLowerCase().includes(s))||e.tags.some(e=>e.toLowerCase().includes(s))):t,r=a&&"all"!==a?l.filter(e=>(e.data_source??"").toLowerCase()===a):l,n="number"==typeof e.offset?e.offset:0,i="number"==typeof e.limit?e.limit:r.length;return{items:r.slice(n,n+i),pagination:{total:r.length,offset:n,limit:i},mode:e.filesystem?"filesystem":"database"}}let l={};"number"==typeof e.offset&&(l.offset=e.offset),"number"==typeof e.limit&&(l.limit=e.limit),e.search&&(l.search=e.search),e.filesystem&&(l.filesystem=!0),e.data_source&&(l.data_source=e.data_source);let r=(await t.http.get(`${s.API_PREFIX}/workspaces`,{params:l})).data||{},n=Array.isArray(r.data)?r.data:Array.isArray(r.items)?r.items:[],d=r.pagination||r.meta?.pagination||{},u=d.total??d.totalItems,m=d.offset,h=d.limit,p=d.page,x=d.pageSize,f=void 0!==m?m:"number"==typeof p&&"number"==typeof x?Math.max(0,(p-1)*x):"number"==typeof e.offset?e.offset:0,w=void 0!==h?h:"number"==typeof x?x:"number"==typeof e.limit?e.limit:n.length,g=Number(u);return{items:n.map(c),pagination:{total:Number.isFinite(g)?g:n.length,offset:Number(f)||0,limit:Number(w)||n.length},mode:r.mode??r.meta?.mode??(e.filesystem?"filesystem":"database")}}function c(e){return{id:Number(e?.id??e?.workspace_id??0)||0,name:String(e?.name??e?.workspace??e?.target??""),data_source:"string"==typeof e?.data_source?e.data_source:"string"==typeof e?.dataSource?e.dataSource:void 0,local_path:String(e?.local_path??e?.workspace_path??e?.path??""),total_assets:Number(e?.total_assets??e?.assets_total??e?.assets?.total??0)||0,total_subdomains:Number(e?.total_subdomains??e?.subdomains_total??e?.subdomains?.total??0)||0,total_urls:Number(e?.total_urls??e?.urls_total??e?.http_assets_total??e?.http_assets?.total??0)||0,total_vulns:Number(e?.total_vulns??e?.vulns_total??e?.vulnerabilities?.total??0)||0,vuln_critical:Number(e?.vuln_critical??e?.vulnerabilities?.critical??0)||0,vuln_high:Number(e?.vuln_high??e?.vulnerabilities?.high??0)||0,vuln_medium:Number(e?.vuln_medium??e?.vulnerabilities?.medium??0)||0,vuln_low:Number(e?.vuln_low??e?.vulnerabilities?.low??0)||0,vuln_potential:Number(e?.vuln_potential??e?.vulnerabilities?.potential??e?.vulnerabilities?.info??0)||0,risk_score:Number(e?.risk_score??e?.risk?.score??e?.score??0)||0,tags:Array.isArray(e?.tags)?e.tags:Array.isArray(e?.labels)?e.labels:[],last_run:String(e?.last_run??e?.last_scan??e?.latest_run_at??e?.last_run_at??""),run_workflow:String(e?.run_workflow??e?.last_workflow??e?.workflow??""),state_execution_log:"string"==typeof e?.state_execution_log?e.state_execution_log:"string"==typeof e?.state?.execution_log?e.state.execution_log:void 0,state_completed_file:"string"==typeof e?.state_completed_file?e.state_completed_file:"string"==typeof e?.state?.completed_file?e.state.completed_file:void 0,state_workflow_file:"string"==typeof e?.state_workflow_file?e.state_workflow_file:"string"==typeof e?.state?.workflow_file?e.state.workflow_file:void 0,state_workflow_folder:"string"==typeof e?.state_workflow_folder?e.state_workflow_folder:"string"==typeof e?.state?.workflow_folder?e.state.workflow_folder:void 0,created_at:String(e?.created_at??e?.createdAt??""),updated_at:String(e?.updated_at??e?.updatedAt??"")}}async function d(e){if((0,a.isDemoMode)()){let t=o.find(t=>String(t.id)===e||t.name===e);return t?c(t):null}try{let a=await t.http.get(`${s.API_PREFIX}/workspaces`,{params:{offset:0,limit:1e3}}),o=(a.data?.data||[]).find(t=>String(t.id)===e||t.name===e);if(!o)return null;return c(o)}catch{return null}}async function u(e,l){let n=l.page??1,i=l.pageSize??20,c=(n-1)*i,d=l.filters??{};if((0,a.isDemoMode)()){let t=(e??"").trim(),s=t?o.find(e=>e.name===t)||o.find(e=>e.name.toLowerCase()===t.toLowerCase()):void 0,a=r[s?`ws-${String(s.id).padStart(3,"0")}`:t.startsWith("ws-")?t:"ws-001"]??[],l=(d.search??"").trim().toLowerCase(),u=new Set(d.statusCodes??[]),m=(d.technologies??[]).map(e=>e.trim().toLowerCase()).filter(Boolean),h=(d.contentTypes??[]).map(e=>e.trim().toLowerCase()).filter(Boolean),p=(d.tlsVersion??"").trim().toLowerCase(),x=(d.location??"").trim().toLowerCase(),f=a.filter(e=>{if(l&&![e.url,e.assetValue,e.title??"",e.hostIp??""].join(" ").toLowerCase().includes(l)||u.size>0&&!u.has(e.statusCode))return!1;if(m.length>0){let t=new Set(e.technologies.map(e=>String(e).trim().toLowerCase()));if(!m.some(e=>t.has(e)))return!1}if(h.length>0){let t=(e.contentType??"").toLowerCase();if(!h.some(e=>t.includes(e)))return!1}return(!p||String(e.tls??"").toLowerCase()===p)&&(!x||!![e.url,e.assetValue,e.hostIp??""].join(" ").toLowerCase().includes(x))&&("number"!=typeof d.minContentLength||!(e.contentLength<d.minContentLength))&&("number"!=typeof d.maxContentLength||!(e.contentLength>d.maxContentLength))}),w=f.slice(c,c+i),g=f.length;return{data:w,pagination:{page:n,pageSize:i,totalItems:g,totalPages:Math.ceil(g/i)}}}let u={offset:c,limit:i};e&&(u.workspace=e),d.search&&(u.search=d.search),d.statusCodes?.length&&(u.status_code=d.statusCodes.join(",")),"number"==typeof d.minContentLength&&(u.min_content_length=d.minContentLength),"number"==typeof d.maxContentLength&&(u.max_content_length=d.maxContentLength),d.location&&(u.location=d.location),d.technologies?.length&&(u.tech=d.technologies.join(",")),d.contentTypes?.length&&(u.content_type=d.contentTypes.join(",")),d.tlsVersion&&(u.tls=d.tlsVersion);let m=await t.http.get(`${s.API_PREFIX}/assets`,{params:u}),h=(m.data?.data||[]).map(e=>({id:String(e.id??e.url),workspace:e.workspace??"",assetValue:e.asset_value??"",url:e.url??"",input:e.input??"",scheme:e.scheme??"",method:e.method??"GET",path:e.path??"/",statusCode:e.status_code??0,contentType:e.content_type??"",contentLength:e.content_length??0,title:e.title,words:e.words??0,lines:e.lines??0,hostIp:e.host_ip,aRecords:e.a??[],tls:e.tls,assetType:e.asset_type??"web",technologies:e.tech??[],responseTime:e.time,remarks:e.remarks,source:e.source??"",createdAt:e.created_at?new Date(e.created_at):new Date,updatedAt:e.updated_at?new Date(e.updated_at):new Date})),p=m.data?.pagination?.total??h.length;return{data:h,pagination:{page:n,pageSize:i,totalItems:p,totalPages:Math.ceil(p/i)}}}e.s(["fetchHttpAssets",()=>u,"fetchWorkspace",()=>d,"fetchWorkspaces",()=>n,"fetchWorkspacesList",()=>i],11764)},24553,e=>{"use strict";var t=e.i(43476),s=e.i(47163),a=e.i(67881);let o=(0,e.i(75254).default)("inbox",[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]]);function l({icon:e=o,title:l,description:r,action:n,className:i}){return(0,t.jsxs)("div",{className:(0,s.cn)("flex flex-col items-center justify-center py-12 text-center",i),children:[(0,t.jsx)("div",{className:"mb-4 rounded-full bg-muted p-4",children:(0,t.jsx)(e,{className:"size-8 text-muted-foreground"})}),(0,t.jsx)("h3",{className:"mb-1 text-lg font-semibold",children:l}),r&&(0,t.jsx)("p",{className:"mb-4 max-w-sm text-sm text-muted-foreground",children:r}),n&&(0,t.jsx)(a.Button,{onClick:n.onClick,variant:"default",children:n.label})]})}e.s(["EmptyState",()=>l],24553)},56261,e=>{"use strict";let t=(0,e.i(75254).default)("search-x",[["path",{d:"m13.5 8.5-5 5",key:"1cs55j"}],["path",{d:"m8.5 8.5 5 5",key:"a8mexj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);e.s(["SearchXIcon",()=>t],56261)},88846,e=>{"use strict";let t=(0,e.i(75254).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);e.s(["SearchIcon",()=>t],88846)},78078,e=>{"use strict";let t=(0,e.i(75254).default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["EyeIcon",()=>t],78078)},36356,58857,e=>{"use strict";var t=e.i(75254);let s=(0,t.default)("arrow-up",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);e.s(["ArrowUpIcon",()=>s],36356);let a=(0,t.default)("arrow-down",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);e.s(["ArrowDownIcon",()=>a],58857)},70065,e=>{"use strict";var t=e.i(43476),s=e.i(47163);function a({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card",className:(0,s.cn)("bg-card/80 backdrop-blur-sm text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm transition-all duration-300 hover:shadow-[0_0_30px_rgba(32,178,170,0.12)] hover:-translate-y-0.5",e),...a})}function o({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card-header",className:(0,s.cn)("flex flex-col gap-1.5 px-6",e),...a})}function l({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card-title",className:(0,s.cn)("leading-none font-semibold",e),...a})}function r({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card-description",className:(0,s.cn)("text-muted-foreground text-sm",e),...a})}function n({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card-content",className:(0,s.cn)("px-6",e),...a})}function i({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card-footer",className:(0,s.cn)("flex items-center px-6",e),...a})}e.s(["Card",()=>a,"CardContent",()=>n,"CardDescription",()=>r,"CardFooter",()=>i,"CardHeader",()=>o,"CardTitle",()=>l])},70152,e=>{"use strict";function t(e,[t,s]){return Math.min(s,Math.max(t,e))}e.s(["clamp",()=>t])},24375,e=>{"use strict";let t=(0,e.i(75254).default)("arrow-up-down",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);e.s(["ArrowUpDownIcon",()=>t],24375)},47627,e=>{"use strict";var t=e.i(43476),s=e.i(47163);function a({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-auto",children:(0,t.jsx)("table",{"data-slot":"table",className:(0,s.cn)("w-full caption-bottom text-sm",e),...a})})}function o({className:e,...a}){return(0,t.jsx)("thead",{"data-slot":"table-header",className:(0,s.cn)("[&_tr]:border-b",e),...a})}function l({className:e,...a}){return(0,t.jsx)("tbody",{"data-slot":"table-body",className:(0,s.cn)("[&_tr:last-child]:border-0",e),...a})}function r({className:e,...a}){return(0,t.jsx)("tr",{"data-slot":"table-row",className:(0,s.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...a})}function n({className:e,...a}){return(0,t.jsx)("th",{"data-slot":"table-head",className:(0,s.cn)("h-10 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&_[role=checkbox]]:translate-y-[2px]",e),...a})}function i({className:e,...a}){return(0,t.jsx)("td",{"data-slot":"table-cell",className:(0,s.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0 [&_[role=checkbox]]:translate-y-[2px]",e),...a})}function c({className:e,...a}){return(0,t.jsx)("caption",{"data-slot":"table-caption",className:(0,s.cn)("mt-4 text-sm text-muted-foreground",e),...a})}e.s(["Table",()=>a,"TableBody",()=>l,"TableCaption",()=>c,"TableCell",()=>i,"TableHead",()=>n,"TableHeader",()=>o,"TableRow",()=>r])},29383,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(47627),o=e.i(36356),l=e.i(58857),r=e.i(24375),n=e.i(47163);function i({children:e,field:i,currentSort:c,onSort:d,className:u}){let m=c.field===i,h=s.useMemo(()=>u?u.includes("text-center")?"justify-center":u.includes("text-right")?"justify-end":"justify-start":"justify-start",[u]);return(0,t.jsx)(a.TableHead,{className:(0,n.cn)("cursor-pointer select-none hover:bg-muted/50 transition-colors",u),onClick:()=>d(i),children:(0,t.jsxs)("div",{className:(0,n.cn)("flex items-center gap-1",h),children:[e,m?"asc"===c.direction?(0,t.jsx)(o.ArrowUpIcon,{className:"size-3.5 text-foreground"}):(0,t.jsx)(l.ArrowDownIcon,{className:"size-3.5 text-foreground"}):(0,t.jsx)(r.ArrowUpDownIcon,{className:"size-3.5 text-muted-foreground/50"})]})})}e.s(["SortableTableHead",()=>i])},45805,e=>{"use strict";let t=(0,e.i(75254).default)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);e.s(["FilterIcon",()=>t],45805)},4262,e=>{"use strict";let t=(0,e.i(75254).default)("tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);e.s(["TagIcon",()=>t],4262)},50156,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(11764),o=e.i(22016),l=e.i(47627),r=e.i(94179),n=e.i(67881),i=e.i(71428),c=e.i(28231),d=e.i(24553),u=e.i(29383),m=e.i(47163),h=e.i(65971),p=e.i(46545),x=e.i(29978),f=e.i(33565),w=e.i(78078),g=e.i(56261);function _({count:e,severity:s}){return 0===e?null:(0,t.jsxs)(c.Tooltip,{children:[(0,t.jsx)(c.TooltipTrigger,{asChild:!0,children:(0,t.jsx)("span",{className:`inline-flex items-center justify-center min-w-[20px] h-5 px-1.5 rounded text-xs font-medium ${{critical:"bg-red-500 text-white",high:"bg-orange-500 text-white",medium:"bg-yellow-500 text-yellow-900",low:"bg-blue-500 text-white"}[s]}`,children:e})}),(0,t.jsxs)(c.TooltipContent,{side:"top",children:[e," ",s]})]})}function b({tags:e}){if(!e?.length)return(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"-"});let s=e.slice(0,2),a=e.length-s.length;return(0,t.jsxs)("div",{className:"flex items-center gap-1 flex-wrap",children:[s.map((e,s)=>{let a;return(0,t.jsx)(r.Badge,{variant:(a=["success","warning","info","purple","pink","cyan","orange","secondary"])[function(e){let t=0;for(let s=0;s<e.length;s++)t=31*t+e.charCodeAt(s)>>>0;return t}(e)%a.length],className:"text-xs",children:e},`${e}-${s}`)}),a>0?(0,t.jsxs)(c.Tooltip,{children:[(0,t.jsx)(c.TooltipTrigger,{asChild:!0,children:(0,t.jsxs)(r.Badge,{variant:"outline",className:"text-xs cursor-default",children:["+",a]})}),(0,t.jsx)(c.TooltipContent,{side:"top",children:(0,t.jsx)("div",{className:"text-xs max-w-[260px] break-words",children:e.join(", ")})})]}):null]})}function j({rows:e=10}){return(0,t.jsxs)(l.Table,{className:"table-fixed",children:[(0,t.jsx)(l.TableHeader,{children:(0,t.jsxs)(l.TableRow,{children:[(0,t.jsx)(l.TableHead,{className:"w-[200px]",children:(0,t.jsx)(i.Skeleton,{className:"h-4 w-12"})}),(0,t.jsx)(l.TableHead,{className:"w-[220px]",children:(0,t.jsx)(i.Skeleton,{className:"h-4 w-10"})}),(0,t.jsx)(l.TableHead,{className:"w-[80px]",children:(0,t.jsx)(i.Skeleton,{className:"h-4 w-10"})}),(0,t.jsx)(l.TableHead,{className:"w-[100px]",children:(0,t.jsx)(i.Skeleton,{className:"h-4 w-14"})}),(0,t.jsx)(l.TableHead,{className:"w-[80px]",children:(0,t.jsx)(i.Skeleton,{className:"h-4 w-10"})}),(0,t.jsx)(l.TableHead,{className:"w-[180px]",children:(0,t.jsx)(i.Skeleton,{className:"h-4 w-20"})}),(0,t.jsx)(l.TableHead,{className:"w-[100px]",children:(0,t.jsx)(i.Skeleton,{className:"h-4 w-10"})}),(0,t.jsx)(l.TableHead,{className:"w-[120px]",children:(0,t.jsx)(i.Skeleton,{className:"h-4 w-10"})})]})}),(0,t.jsx)(l.TableBody,{children:Array.from({length:e}).map((e,s)=>(0,t.jsxs)(l.TableRow,{children:[(0,t.jsx)(l.TableCell,{children:(0,t.jsx)(i.Skeleton,{className:"h-4 w-36"})}),(0,t.jsx)(l.TableCell,{children:(0,t.jsxs)("div",{className:"flex gap-1",children:[(0,t.jsx)(i.Skeleton,{className:"h-5 w-14 rounded"}),(0,t.jsx)(i.Skeleton,{className:"h-5 w-14 rounded"})]})}),(0,t.jsx)(l.TableCell,{children:(0,t.jsx)(i.Skeleton,{className:"h-4 w-10"})}),(0,t.jsx)(l.TableCell,{children:(0,t.jsx)(i.Skeleton,{className:"h-4 w-14"})}),(0,t.jsx)(l.TableCell,{children:(0,t.jsx)(i.Skeleton,{className:"h-4 w-10"})}),(0,t.jsx)(l.TableCell,{children:(0,t.jsxs)("div",{className:"flex gap-1",children:[(0,t.jsx)(i.Skeleton,{className:"h-5 w-6 rounded"}),(0,t.jsx)(i.Skeleton,{className:"h-5 w-6 rounded"}),(0,t.jsx)(i.Skeleton,{className:"h-5 w-6 rounded"})]})}),(0,t.jsx)(l.TableCell,{children:(0,t.jsx)(i.Skeleton,{className:"h-6 w-12 rounded-md"})}),(0,t.jsx)(l.TableCell,{children:(0,t.jsx)(i.Skeleton,{className:"h-4 w-20"})}),(0,t.jsx)(l.TableCell,{children:(0,t.jsxs)("div",{className:"flex justify-center gap-2",children:[(0,t.jsx)(i.Skeleton,{className:"h-8 w-8 rounded"}),(0,t.jsx)(i.Skeleton,{className:"h-8 w-8 rounded"})]})})]},s))})]})}function v({workspaces:e,isLoading:s,pagination:a,sortState:i,onSort:v,onPageChange:k,hasActiveFilters:y}){return s&&0===e.length?(0,t.jsx)("div",{className:"relative min-h-[400px]",children:(0,t.jsx)(j,{rows:10})}):0===e.length?(0,t.jsx)("div",{className:"relative min-h-[360px] flex items-center justify-center",children:(0,t.jsx)(d.EmptyState,{icon:y?g.SearchXIcon:p.FolderOpenIcon,title:y?"No matching workspaces":"No workspaces found",description:y?"No workspaces match your current search. Try adjusting your search criteria.":"Workspaces are created when you run scans. Start a new scan to create a workspace."})}):(0,t.jsx)(c.TooltipProvider,{children:(0,t.jsxs)("div",{className:"space-y-4 relative",children:[s&&(0,t.jsx)("div",{className:"absolute inset-0 bg-background/50 z-20 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground bg-background px-3 py-2 rounded-md shadow-sm border",children:[(0,t.jsx)("div",{className:"size-4 border-2 border-primary border-t-transparent rounded-full animate-spin"}),"Refreshing..."]})}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)(l.Table,{className:"table-fixed",children:[(0,t.jsx)(l.TableHeader,{className:"sticky top-0 bg-background z-10",children:(0,t.jsxs)(l.TableRow,{children:[(0,t.jsx)(u.SortableTableHead,{field:"name",currentSort:i,onSort:e=>v(e),className:"w-[200px]",children:"Name"}),(0,t.jsx)(l.TableHead,{className:"w-[220px]",children:"Tags"}),(0,t.jsx)(u.SortableTableHead,{field:"total_assets",currentSort:i,onSort:e=>v(e),className:"w-[80px]",children:"Assets"}),(0,t.jsx)(u.SortableTableHead,{field:"total_subdomains",currentSort:i,onSort:e=>v(e),className:"w-[100px]",children:"Subdomains"}),(0,t.jsx)(u.SortableTableHead,{field:"total_urls",currentSort:i,onSort:e=>v(e),className:"w-[80px]",children:"URLs"}),(0,t.jsx)(u.SortableTableHead,{field:"total_vulns",currentSort:i,onSort:e=>v(e),className:"w-[180px]",children:"Vulnerabilities"}),(0,t.jsx)(u.SortableTableHead,{field:"risk_score",currentSort:i,onSort:e=>v(e),className:"w-[100px]",children:"Risk"}),(0,t.jsx)(u.SortableTableHead,{field:"actions",currentSort:i,onSort:e=>v(e),className:"w-[120px] text-center",children:"Actions"})]})}),(0,t.jsx)(l.TableBody,{children:e.map(e=>{var s;let a=e.vuln_critical>0||e.vuln_high>0||e.vuln_medium>0||e.vuln_low>0;return(0,t.jsxs)(l.TableRow,{className:"cursor-pointer hover:bg-muted/50",children:[(0,t.jsx)(l.TableCell,{children:(0,t.jsx)(o.default,{href:`/inventory/workspaces/${e.name}`,className:"font-medium hover:underline text-primary",children:e.name})}),(0,t.jsx)(l.TableCell,{children:(0,t.jsx)(b,{tags:e.tags})}),(0,t.jsx)(l.TableCell,{className:"text-sm text-muted-foreground",children:(0,m.formatNumber)(e.total_assets)}),(0,t.jsx)(l.TableCell,{className:"text-sm text-muted-foreground",children:(0,m.formatNumber)(e.total_subdomains)}),(0,t.jsx)(l.TableCell,{className:"text-sm text-muted-foreground",children:(0,m.formatNumber)(e.total_urls)}),(0,t.jsx)(l.TableCell,{children:a?(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(_,{count:e.vuln_critical,severity:"critical"}),(0,t.jsx)(_,{count:e.vuln_high,severity:"high"}),(0,t.jsx)(_,{count:e.vuln_medium,severity:"medium"}),(0,t.jsx)(_,{count:e.vuln_low,severity:"low"}),(0,t.jsxs)("span",{className:"text-xs text-muted-foreground ml-1",children:["(",e.total_vulns,")"]})]}):(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"-"})}),(0,t.jsx)(l.TableCell,{children:(0,t.jsx)(r.Badge,{variant:"outline",className:`font-mono text-xs ${(s=e.risk_score)>=8?"bg-red-500/10 text-red-600 border-red-200 dark:border-red-800":s>=6?"bg-orange-500/10 text-orange-600 border-orange-200 dark:border-orange-800":s>=4?"bg-yellow-500/10 text-yellow-600 border-yellow-200 dark:border-yellow-800":"bg-green-500/10 text-green-600 border-green-200 dark:border-green-800"}`,children:e.risk_score.toFixed(1)})}),(0,t.jsx)(l.TableCell,{children:(0,t.jsxs)("div",{className:"flex justify-center gap-2",children:[(0,t.jsxs)(c.Tooltip,{children:[(0,t.jsx)(c.TooltipTrigger,{asChild:!0,children:(0,t.jsx)(n.Button,{variant:"outline",size:"icon",className:"size-8 rounded-md",asChild:!0,children:(0,t.jsx)(o.default,{href:{pathname:"/inventory/assets",query:{workspace:e.name}},children:(0,t.jsx)(w.EyeIcon,{className:"size-4"})})})}),(0,t.jsx)(c.TooltipContent,{side:"top",children:"View assets"})]}),(0,t.jsxs)(c.Tooltip,{children:[(0,t.jsx)(c.TooltipTrigger,{asChild:!0,children:(0,t.jsx)(n.Button,{variant:"outline",size:"icon",className:"size-8 rounded-md",asChild:!0,children:(0,t.jsx)(o.default,{href:{pathname:"/inventory/artifacts",query:{workspace:e.name}},children:(0,t.jsx)(h.ArchiveIcon,{className:"size-4"})})})}),(0,t.jsx)(c.TooltipContent,{side:"top",children:"View artifacts"})]})]})})]},`${e.id||e.name}`)})})]})}),a&&a.totalPages>1&&(0,t.jsxs)("div",{className:"flex items-center justify-between px-2 pt-2 border-t",children:[(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Showing"," ",(0,t.jsx)("span",{className:"font-medium text-foreground",children:(a.page-1)*a.pageSize+1})," ","to"," ",(0,t.jsx)("span",{className:"font-medium text-foreground",children:Math.min(a.page*a.pageSize,a.totalItems)})," ","of"," ",(0,t.jsx)("span",{className:"font-medium text-foreground",children:a.totalItems.toLocaleString()})," ","workspaces"]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)(n.Button,{variant:"outline",size:"sm",onClick:()=>k?.(a.page-1),disabled:a.page<=1,children:[(0,t.jsx)(x.ChevronLeftIcon,{className:"size-4 mr-1"}),"Previous"]}),(0,t.jsx)("div",{className:"flex items-center gap-1",children:Array.from({length:Math.min(5,a.totalPages)},(e,s)=>{let o;return o=a.totalPages<=5||a.page<=3?s+1:a.page>=a.totalPages-2?a.totalPages-4+s:a.page-2+s,(0,t.jsx)(n.Button,{variant:a.page===o?"default":"outline",size:"sm",className:"w-9",onClick:()=>k?.(o),children:o},o)})}),(0,t.jsxs)(n.Button,{variant:"outline",size:"sm",onClick:()=>k?.(a.page+1),disabled:a.page>=a.totalPages,children:["Next",(0,t.jsx)(f.ChevronRightIcon,{className:"size-4 ml-1"})]})]})]})]})})}var k=e.i(23750),y=e.i(62870),N=e.i(70065),S=e.i(36902),C=e.i(88846),T=e.i(65476),I=e.i(4262),D=e.i(45805);let M=(0,e.i(75254).default)("funnel-x",[["path",{d:"M12.531 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14v6a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341l.427-.473",key:"ol2ft2"}],["path",{d:"m16.5 3.5 5 5",key:"15e6fa"}],["path",{d:"m21.5 3.5-5 5",key:"m0lwru"}]]);var A=e.i(46696);function L(){let[e,o]=s.useState([]),[l,i]=s.useState(!0),[c,d]=s.useState(""),[u,h]=s.useState("all"),[x,f]=s.useState("all"),[w,g]=s.useState(!1),[_,b]=s.useState(!1),[j,L]=s.useState(1),[z]=s.useState(20),[H,P]=s.useState(0),[$,B]=s.useState(void 0),[R,O]=s.useState({field:"last_run",direction:"desc"}),V=s.useCallback(async e=>{try{i(!0);let e=(j-1)*z,t=await (0,a.fetchWorkspacesList)({offset:e,limit:z,search:c.trim()||void 0,filesystem:_,data_source:_||"all"===u?void 0:u});o(t.items),P(t.pagination.total),B(t.mode)}catch(e){A.toast.error("Failed to load workspaces",{description:e instanceof Error?e.message:""})}finally{i(!1)}},[j,z,c,u,_]);s.useEffect(()=>{V()},[V]);let F=s.useCallback(e=>{O(t=>({field:e,direction:t.field===e&&"asc"===t.direction?"desc":"asc"}))},[]),q=s.useMemo(()=>{let t=new Set;for(let s of e)for(let e of s.tags??[])t.add(e);return Array.from(t).sort((e,t)=>e.localeCompare(t))},[e]),E=s.useMemo(()=>e.filter(e=>(!w||0!==e.total_assets)&&("all"===x||!!(e.tags??[]).includes(x))),[e,w,x]),W=s.useMemo(()=>(0,m.sortWorkspaces)(E,R.field,R.direction),[E,R]),Z=!!(c.trim()||"all"!==u||"all"!==x||w),U=Math.ceil(H/z);return(0,t.jsx)("div",{className:"space-y-6",children:(0,t.jsxs)(N.Card,{className:"overflow-hidden",children:[(0,t.jsx)(N.CardHeader,{className:"border-b bg-muted/30 py-4",children:(0,t.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-start sm:justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(N.CardTitle,{className:"text-base",children:"Workspaces Inventory"}),(0,t.jsx)(N.CardDescription,{children:void 0!==H?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:"font-medium text-foreground",children:H.toLocaleString()})," ","workspaces found",$?(0,t.jsxs)(t.Fragment,{children:[" ",(0,t.jsx)(r.Badge,{variant:"outline",className:"ml-2 text-xs",children:$})]}):null]}):"Loading workspaces..."})]}),(0,t.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,t.jsxs)(n.Button,{variant:_?"default":"outline",size:"sm",onClick:()=>{b(!0),L(1)},disabled:l&&_,children:[(0,t.jsx)(p.FolderOpenIcon,{className:"size-4 mr-2"}),"Filesystem"]}),(0,t.jsxs)(n.Button,{variant:_?"outline":"default",size:"sm",onClick:()=>{b(!1),L(1)},disabled:l&&!_,children:[(0,t.jsx)(S.DatabaseIcon,{className:"size-4 mr-2"}),"Database"]}),(0,t.jsxs)(n.Button,{variant:"outline",size:"sm",onClick:()=>V(!0),disabled:l,children:[(0,t.jsx)(T.RefreshCcwIcon,{className:`size-4 mr-2 ${l?"animate-spin":""}`}),"Refresh"]})]})]}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-3 sm:justify-end",children:[(0,t.jsxs)("div",{className:"relative flex-1 min-w-[200px] max-w-sm",children:[(0,t.jsx)(C.SearchIcon,{className:"absolute left-3 top-1/2 size-4 -translate-y-1/2 text-muted-foreground"}),(0,t.jsx)(k.Input,{placeholder:"Search workspaces...",value:c,onChange:e=>{d(e.target.value),L(1)},className:"pl-9"})]}),(0,t.jsxs)(y.Select,{value:x,onValueChange:e=>{f(e),L(1)},children:[(0,t.jsx)(y.SelectTrigger,{className:"w-[170px]",children:(0,t.jsxs)("span",{className:"flex items-center gap-2",children:[(0,t.jsx)(I.TagIcon,{className:"size-4 text-muted-foreground"}),(0,t.jsx)(y.SelectValue,{placeholder:"Tag"})]})}),(0,t.jsxs)(y.SelectContent,{children:[(0,t.jsx)(y.SelectItem,{value:"all",children:"All Tags"}),q.map(e=>(0,t.jsx)(y.SelectItem,{value:e,children:e},e))]})]}),(0,t.jsxs)(n.Button,{variant:w?"default":"outline",size:"sm",onClick:()=>{g(e=>!e),L(1)},children:[w?(0,t.jsx)(M,{className:"size-4 mr-2"}):(0,t.jsx)(D.FilterIcon,{className:"size-4 mr-2"}),w?"Zero Assets: Hidden":"Hide Zero Assets"]}),(0,t.jsxs)(y.Select,{value:u,onValueChange:e=>{h(e),L(1)},children:[(0,t.jsx)(y.SelectTrigger,{className:"w-[170px]",children:(0,t.jsxs)("span",{className:"flex items-center gap-2",children:[(0,t.jsx)(S.DatabaseIcon,{className:"size-4 text-muted-foreground"}),(0,t.jsx)(y.SelectValue,{placeholder:"Data source"})]})}),(0,t.jsxs)(y.SelectContent,{children:[(0,t.jsx)(y.SelectItem,{value:"all",children:"All Sources"}),(0,t.jsx)(y.SelectItem,{value:"local",children:"Local"}),(0,t.jsx)(y.SelectItem,{value:"cloud",children:"Cloud"}),(0,t.jsx)(y.SelectItem,{value:"imported",children:"Imported"})]})]})]})]})}),(0,t.jsx)(N.CardContent,{className:"p-0",children:(0,t.jsx)(v,{workspaces:W,isLoading:l,pagination:{page:j,pageSize:z,totalItems:H,totalPages:U},sortState:R,onSort:F,onPageChange:L,hasActiveFilters:Z})})]})})}e.s(["default",()=>L],50156)}]);